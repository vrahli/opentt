\begin{code}

--open import bar
--module props1 (bar : Bar) where

open import Level using (Level ; 0‚Ñì ; Lift ; lift ; lower) renaming (suc to lsuc)
open import Agda.Builtin.Bool
open import Agda.Builtin.Equality
open import Agda.Builtin.Equality.Rewrite
open import Agda.Builtin.Sigma
open import Relation.Nullary
open import Relation.Unary using (Pred; Decidable)
open import Relation.Binary.PropositionalEquality using (sym ; subst)
open import Data.Product
open import Data.Product.Properties
open import Data.Sum
open import Data.Empty
open import Data.Maybe
open import Data.Unit using (‚ä§ ; tt)
open import Data.Nat using (‚Ñï ;  _<_ ; _‚â§_ ; _‚â•_ ; _‚â§?_ ; suc ; _+_ ; pred)
open import Data.Nat.Properties
open import Agda.Builtin.String
open import Agda.Builtin.String.Properties
open import Data.List
open import Data.List.Properties
open import Data.List.Relation.Unary.Any
open import Data.List.Membership.Propositional
open import Data.List.Membership.Propositional.Properties
open import Function.Bundles
open import Induction.WellFounded
open import Axiom.Extensionality.Propositional


open import util
open import calculus
open import world
open import choice


--module props1 (bar : Bar) where
module props1 (W : PossibleWorlds) (C : Choice W) (E : Extensionality 0‚Ñì 2‚Ñì) where


open import worldDef(W)
open import computation(W)(C)
open import bar(W)
open import theory(W)(C)(E)
open import props0(W)(C)(E)
open import ind2(W)(C)(E)
open import terms(W)(C)(E)

open import type_sys_props_nat(W)(C)(E)
open import type_sys_props_qnat(W)(C)(E)
open import type_sys_props_lt(W)(C)(E)
open import type_sys_props_qlt(W)(C)(E)
open import type_sys_props_free(W)(C)(E)
open import type_sys_props_pi(W)(C)(E)
open import type_sys_props_sum(W)(C)(E)
open import type_sys_props_set(W)(C)(E)
open import type_sys_props_eq(W)(C)(E)
open import type_sys_props_union(W)(C)(E)
open import type_sys_props_tsquash(W)(C)(E)
open import type_sys_props_ffdefs(W)(C)(E)

-- open import calculus
-- open import world
-- open import theory (bar)
-- open import props0 (bar)
-- open import ind2 (bar) -- this is the one where a function is not recognized as terminating, but does not break the bar abstraction
\end{code}




\begin{code}[hide]
UNIVinj : {a b : ‚Ñï} ‚Üí UNIV a ‚â° UNIV b ‚Üí a ‚â° b
UNIVinj refl =  refl


UNIVneqNAT : {a : ‚Ñï} ‚Üí ¬¨ UNIV a ‚â° NAT
UNIVneqNAT {a} ()

UNIVneqQNAT : {a : ‚Ñï} ‚Üí ¬¨ UNIV a ‚â° QNAT
UNIVneqQNAT {a} ()

UNIVneqLT : {a : ‚Ñï} {c d : Term} ‚Üí ¬¨ UNIV a ‚â° LT c d
UNIVneqLT {a} {c} {d} ()

UNIVneqQLT : {a : ‚Ñï} {c d : Term} ‚Üí ¬¨ UNIV a ‚â° QLT c d
UNIVneqQLT {a} {c} {d} ()

UNIVneqFREE : {a : ‚Ñï} ‚Üí ¬¨ UNIV a ‚â° FREE
UNIVneqFREE {a} ()

UNIVneqPI : {a : ‚Ñï} {c : Term} {d : Term} ‚Üí ¬¨ UNIV a ‚â° PI c d
UNIVneqPI {a} {c} {d} ()

UNIVneqSUM : {a : ‚Ñï} {c : Term} {d : Term} ‚Üí ¬¨ UNIV a ‚â° SUM c d
UNIVneqSUM {a} {c} {d} ()

UNIVneqSET : {a : ‚Ñï} {c : Term} {d : Term} ‚Üí ¬¨ UNIV a ‚â° SET c d
UNIVneqSET {a} {c} {d} ()

UNIVneqUNION : {a : ‚Ñï} {c : Term} {d : Term} ‚Üí ¬¨ UNIV a ‚â° UNION c d
UNIVneqUNION {a} {c} {d} ()

UNIVneqEQ : {a : ‚Ñï} {c d e : Term} ‚Üí ¬¨ UNIV a ‚â° EQ c d e
UNIVneqEQ {a} {c} {d} {e} ()

UNIVneqFFDEFS : {a : ‚Ñï} {c d : Term} ‚Üí ¬¨ UNIV a ‚â° FFDEFS c d
UNIVneqFFDEFS {a} {c} {d} ()

UNIVneqTSQUASH : {a : ‚Ñï} {c : Term} ‚Üí ¬¨ UNIV a ‚â° TSQUASH c
UNIVneqTSQUASH {a} {c} ()

UNIVneqLIFT : {a : ‚Ñï} {c : Term} ‚Üí ¬¨ UNIV a ‚â° LIFT c
UNIVneqLIFT {a} {c} ()

UNIVneqDUM : {a : ‚Ñï} {c : Term} ‚Üí ¬¨ UNIV a ‚â° DUM c
UNIVneqDUM {a} {c} ()

UNIVneqLOWER : {a : ‚Ñï} {c : Term} ‚Üí ¬¨ UNIV a ‚â° LOWER c
UNIVneqLOWER {a} {c} ()

UNIVneqSHRINK : {a : ‚Ñï} {c : Term} ‚Üí ¬¨ UNIV a ‚â° SHRINK c
UNIVneqSHRINK {a} {c} ()


is-TSP-univs : (u : univs) ‚Üí Set‚ÇÅ
is-TSP-univs u = (w : ùïé¬∑) (A B : CTerm) (p : eqTypes u w A B) ‚Üí TSP {u} {w} {A} {B} p


{--mon-univs : (u : univs) ‚Üí Set‚ÇÅ
mon-univs u = {!!} --mon (fst (snd u))--}


typeSysConds-BAR-ttrans : (u : univs) (w : ùïé¬∑) (A B C : CTerm)
                          (x : inbar w (Œª w' _ ‚Üí eqTypes u w' A B))
                          ‚Üí inbar' w x (Œª w1 e1 ‚Üí TSP)
                          ‚Üí eqTypes u w B C
                          ‚Üí eqTypes u w A C
typeSysConds-BAR-ttrans u w A B C x i eqt = EQTBAR (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar x aw i)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (x‚ÇÅ : eqTypes u w' A B) (at : atbar x w' e' x‚ÇÅ) ‚Üí TSP x‚ÇÅ ‚Üí eqTypes u w' A C)
    aw w1 e1 eqta at tsp = TSP.ttrans tsp C (eqTypes-mon u eqt w1 e1)




{--
eqInType-‚áõ-PI2 : (u : univs) (isu : is-universe u) (w : ùïé¬∑) (A B A1 A2 B1 B2 a b : CTerm)
                  (eqta : ‚àÄùïé w (Œª w' _ ‚Üí eqTypes u w' A1 A2))
                  (eqtb : ‚àÄùïé w (Œª w' e ‚Üí (a1 a2 : CTerm) ‚Üí eqInType u w' (eqta w' e) a1 a2
                                         ‚Üí eqTypes u w' (sub a1 B1) (sub a2 B2)))
                  ‚Üí (c‚ÇÅ : A ‚áõ PI A1 B1 at w) (c‚ÇÇ : B ‚áõ PI A2 B2 at w)
                  ‚Üí eqInTypeExt (EQTPI A1 B1 A2 B2 c‚ÇÅ c‚ÇÇ eqta eqtb)
                  ‚Üí (eqt : eqTypes u w A B)
                  ‚Üí eqInType u w eqt a b
                  ‚Üí inbar w (Œª w' e ‚Üí PIeq (eqInType u w' (eqta w' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w' (eqtb w' e a‚ÇÅ a‚ÇÇ eqa)) a b)
{-# TERMINATING #-}
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTNAT x x‚ÇÅ) ei = ‚ä•-elim (PIneqNAT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTQNAT x x‚ÇÅ) ei = ‚ä•-elim (PIneqQNAT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) ei = ‚ä•-elim (PIneqLT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) ei = ‚ä•-elim (PIneqQLT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTFREE x x‚ÇÅ) ei = ‚ä•-elim (PIneqFREE (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTPI A3 B3 A4 B4 x x‚ÇÅ eqta‚ÇÅ eqtb‚ÇÅ) ei
  = {!!} {--rewrite PIinj1 (‚áõ-val-det tt tt c‚ÇÅ x)
        | PIinj2 (‚áõ-val-det tt tt c‚ÇÅ x)
        | PIinj1 (‚áõ-val-det tt tt c‚ÇÇ x‚ÇÅ)
        | PIinj2 (‚áõ-val-det tt tt c‚ÇÇ x‚ÇÅ) =
  Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw ei
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí PIeq (eqInType u w' (eqta‚ÇÅ w' e')) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w' (eqtb‚ÇÅ w' e' a‚ÇÅ a‚ÇÇ eqa)) a b
                         ‚Üí PIeq (eqInType u w' (eqta w' e')) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w' (eqtb w' e' a‚ÇÅ a‚ÇÇ eqa)) a b)
    aw w1 e1 z a‚ÇÅ a‚ÇÇ eqa = snd (indb w1 e1 a‚ÇÅ a‚ÇÇ eqa (eqtb‚ÇÅ w1 e1 a‚ÇÅ a‚ÇÇ eqa') (APPLY a a‚ÇÅ) (APPLY b a‚ÇÇ)) eqb'
      where
        eqa' : eqInType u w1 (eqta‚ÇÅ w1 e1) a‚ÇÅ a‚ÇÇ
        eqa' = fst (inda w1 e1 (eqta‚ÇÅ w1 e1) a‚ÇÅ a‚ÇÇ) eqa

        eqb' : eqInType u w1 (eqtb‚ÇÅ w1 e1 a‚ÇÅ a‚ÇÇ eqa') (APPLY a a‚ÇÅ) (APPLY b a‚ÇÇ)
        eqb' = z a‚ÇÅ a‚ÇÇ eqa'--}

eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTSUM A3 B3 A4 B4 x x‚ÇÅ eqta‚ÇÅ eqtb‚ÇÅ) ei = ‚ä•-elim (PIneqSUM (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTSET A3 B3 A4 B4 x x‚ÇÅ eqta‚ÇÅ eqtb‚ÇÅ) ei = ‚ä•-elim (PIneqSET (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) ei = ‚ä•-elim (PIneqEQ (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTUNION A3 B3 A4 B4 x x‚ÇÅ eqtA eqtB) ei = ‚ä•-elim (PIneqUNION (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTSQUASH A3 A4 x x‚ÇÅ eqtA) ei = ‚ä•-elim (PIneqTSQUASH (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQFFDEFS A3 A4 x1 x2 x x‚ÇÅ eqtA eqx) ei = ‚ä•-elim (PIneqFFDEFS (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTUNIV x) ei =
  ‚ä•-elim (lift‚ä• (Bar.inBar-const inOpenBar-Bar (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar q z)))
  where
    z : inbar w (Œª w' _ ‚Üí A ‚áõ (UNIV (fst u)) at w' √ó B ‚áõ (UNIV (fst u)) at w')
    z = isu w A B x

    q : ‚àÄùïé w (Œª w' e' ‚Üí A ‚áõ UNIV (proj‚ÇÅ u) at w' √ó B ‚áõ UNIV (proj‚ÇÅ u) at w' ‚Üí Lift 1‚Ñì ‚ä•)
    q w1 e1 (d‚ÇÅ , d‚ÇÇ) = lift (‚ä•-elim (PIneqUNIV (‚áõ-val-det tt tt (‚áõ-mon e1 c‚ÇÅ) d‚ÇÅ)))

eqInType-‚áõ-PI2 u isu w A B A1 A2 B1 B2 a b eqta eqtb c‚ÇÅ c‚ÇÇ ext (EQTBAR x) ei =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar aw x ei)
  where
    aw0 : ‚àÄùïé w
      (Œª w' e' ‚Üí
         (z : eqTypes u w' A B) ‚Üí
         eqInType u w' z a b ‚Üí
         inbar w' (Œª w'' e ‚Üí PIeq (eqInType u w'' (eqta w'' (extTrans e e'))) (Œª a1 a2 eqa ‚Üí eqInType u w'' (eqtb w'' (extTrans e e') a1 a2 eqa)) a b))
    aw0 w1 e1 z ez =
      eqInType-‚áõ-PI2
        u isu w1 A B A1 A2 B1 B2 a b
        (‚àÄùïé-mon e1 eqta) (‚àÄùïé-mon e1 eqtb)
        (‚áõ-mon e1 c‚ÇÅ) (‚áõ-mon e1 c‚ÇÇ) {!!} z ez

    aw : ‚àÄùïé w
      (Œª w' e' ‚Üí
         (z : eqTypes u w' A B) ‚Üí
         eqInType u w' z a b ‚Üí
         inbar w' (Œª w'' e ‚Üí (x : w'' ‚âΩ w) ‚Üí PIeq (eqInType u w'' (eqta w'' x)) (Œª a1 a2 eqa ‚Üí eqInType u w'' (eqtb w'' x a1 a2 eqa)) a b))
    aw w1 e1 z ez = {!!} --Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (irr-fam-pi u w A1 B1 A2 B2 eqta eqtb inda indb a b w1 e1) (aw0 w1 e1 z ez)
--}




{--
eqInType-ext : {u : univs} (isu : is-universe u) {w : ùïé¬∑} {A B : CTerm}
               (eqt : eqTypes u w A B) ‚Üí eqInTypeExt eqt
eqInType-ext {u} isu {w} {A} {B} (EQTNAT x x‚ÇÅ) =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-NAT-rev u isu w A B a b x x‚ÇÅ eqt2 , eqInType-‚áõ-NAT u isu w A B a b x x‚ÇÅ eqt2
eqInType-ext {u} isu {w} {A} {B} (EQTQNAT x x‚ÇÅ) =
  {!!}
eqInType-ext {u} isu {w} {A} {B} (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = {!!}
eqInType-ext {u} isu {w} {A} {B} (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = {!!}
eqInType-ext {u} isu {w} {A} {B} (EQTFREE x x‚ÇÅ) = {!!}
eqInType-ext {u} isu {w} {A} {B} (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-PI-rev u isu w A B A1 A2 B1 B2 a b eqta eqtb exta extb inda indb x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-PI u isu w A B A1 A2 B1 B2 a b eqta eqtb exta extb inda indb x x‚ÇÅ eqt2
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí eqInTypeExt (eqta w1 e1))
    inda w1 e1 = eqInType-ext isu (eqta w1 e1)

    indb : ‚àÄùïé w (Œª w1 e1 ‚Üí (a1 a2 : CTerm) (ea : eqInType u w1 (eqta w1 e1) a1 a2) ‚Üí eqInTypeExt (eqtb w1 e1 a1 a2 ea))
    indb w1 e1 a‚ÇÅ a‚ÇÇ eqa = eqInType-ext isu (eqtb w1 e1 a‚ÇÅ a‚ÇÇ eqa)

eqInType-ext {u} isu {w} {A} {B} (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) = {!!}
eqInType-ext {u} isu {w} {A} {B} (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) = {!!}
eqInType-ext {u} isu {w} {A} {B} (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA eqt1 eqt3) = {!!}
eqInType-ext {u} isu {w} {A} {B} (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB) = {!!}
eqInType-ext {u} isu {w} {A} {B} (EQTSQUASH A1 A2 x x‚ÇÅ eqtA) = {!!}
eqInType-ext {u} isu {w} {A} {B} (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA eqx) = {!!}
eqInType-ext {u} isu {w} {A} {B} (EQTUNIV x) = {!!}
eqInType-ext {u} isu {w} {A} {B} (EQTBAR x) =
  Œª eqt' a b ‚Üí (Œª ei ‚Üí {!!}) , {!!}
  where
    ind : inbar' w x (Œª w' e' eqt' ‚Üí eqInTypeExt eqt')
    ind = Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar (Œª w1 e1 z ‚Üí eqInType-ext isu z) x

-- We could possibly prove it if the IH was for all lower types, not just the ones immediatly below
-- Using a relation like [<Type]
-- NOTE: this breaks the 'inbar' abstraction!
--}







{--atbar-‚âΩ : {u : univs} (umon : mon (proj‚ÇÅ (snd u)))
          {w w0 w1 : ùïé¬∑} (e0 : w0 ‚âΩ w) (e1 : w1 ‚âΩ w0) {A B : CTerm}
          (eqt : eqTypes u w0 A B)
          (i : inbar w (Œª w'' _ ‚Üí eqTypes u w'' A B))
          ‚Üí atbar i w0 e0 eqt
          ‚Üí atbar i w1 (extTrans e1 e0) (eqTypes-mon u umon eqt w1 e1)
atbar-‚âΩ {u} umon {w} {w0} {w1} e0 e1 {A} {B} .(snd (snd (i w2 e2)) w0 e3 e0) i (ATOPENBAR w2 e2 .w0 e3 .e0) =
  {!ATOPENBAR ? ? ? ? ?!}--}



{--
<Type-PIa-EQTBAR : {u : univs} (umon : mon (proj‚ÇÅ (snd u))) {w : ùïé¬∑} {A B A1 A2 B1 B2 : CTerm}
                   (c‚ÇÅ : A ‚áõ PI A1 B1 at w)
                   (c‚ÇÇ : B ‚áõ PI A2 B2 at w)
                   (i : inbar w (Œª w'' _ ‚Üí eqTypes u w'' A B))
                   (eqta : ‚àÄùïé w (Œª w'' _ ‚Üí eqTypes u w'' A1 A2))
                   (eqtb : ‚àÄùïé w (Œª w'' e ‚Üí (a1 a2 : CTerm) ‚Üí eqInType u w'' (eqta w'' e) a1 a2
                                           ‚Üí eqTypes u w'' (sub a1 B1) (sub a2 B2)))
                   (w0 : ùïé¬∑) (e0 : w0 ‚âΩ w) (eqt : eqTypes u w0 A B) (a : atbar i w0 e0 eqt)
                   (w1 : ùïé¬∑) (e1 : w1 ‚âΩ w0)
                   ‚Üí <Type u (eqta w1 (extTrans e1 e0)) (EQTBAR i)
<Type-PIa-EQTBAR {u} umon {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ i eqta eqtb w0 e0 eqt a w1 e1 =
  <TypeS
    {!!} {!!} {!!} {!!}
    (<TypeBAR w A B i w0 e0 eqt a)
{--    (<TypeBAR
      w A B i w1 (extTrans e1 e0) (eqTypes-mon u umon eqt w1 e1) -- w0 instead of w1?
      {!!}) --}
--}



{--
eqInTypExt-‚àÄùïé-mon-PIa : {u : univs} {w : ùïé¬∑} {A B A1 A2 B1 B2 : CTerm}
                          (c‚ÇÅ : A ‚áõ PI A1 B1 at w)
                          (c‚ÇÇ : B ‚áõ PI A2 B2 at w)
                          (eqta : ‚àÄùïé w (Œª w'' _ ‚Üí eqTypes u w'' A1 A2))
                          (w' : ùïé¬∑) (e' : w' ‚âΩ w)
                          (z : eqTypes u w' A B)
                          (ext : {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : eqTypes u w' A' B') ‚Üí <Type u eqt' z ‚Üí eqInTypeExt eqt')
                          (w1 : ùïé¬∑) (e1 : w1 ‚âΩ w')
                          ‚Üí eqInTypeExt (‚àÄùïé-mon e' eqta w1 e1)
-- By induction on z
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTNAT x x‚ÇÅ) ext w1 e1 = ‚ä•-elim (PIneqNAT (‚áõ-val-det tt tt (‚áõ-mon e' c‚ÇÅ) x))
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTQNAT x x‚ÇÅ) ext w1 e1 = {!!}
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) ext w1 e1 = {!!}
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) ext w1 e1 = {!!}
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTFREE x x‚ÇÅ) ext w1 e1 = {!!}
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTPI A3 B3 A4 B4 x x‚ÇÅ eqta‚ÇÅ eqtb‚ÇÅ exta‚ÇÅ extb‚ÇÅ) ext w1 e1
  rewrite PIinj1 (‚áõ-val-det tt tt (‚áõ-mon e' c‚ÇÅ) x)
        | PIinj2 (‚áõ-val-det tt tt (‚áõ-mon e' c‚ÇÅ) x)
        | PIinj1 (‚áõ-val-det tt tt (‚áõ-mon e' c‚ÇÇ) x‚ÇÅ)
        | PIinj2 (‚áõ-val-det tt tt (‚áõ-mon e' c‚ÇÇ) x‚ÇÅ) =
  eqTypes-eqInTypeExt (eqta‚ÇÅ w1 e1) (eqta w1 (extTrans e1 e')) (ext (eqta‚ÇÅ w1 e1) (<Type1 _ _ (<TypePIa w' A B A3 B3 A4 B4 x x‚ÇÅ eqta‚ÇÅ eqtb‚ÇÅ exta‚ÇÅ extb‚ÇÅ w1 e1)))
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTSUM A3 B3 A4 B4 x x‚ÇÅ eqta‚ÇÅ eqtb) ext w1 e1 = {!!}
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTSET A3 B3 A4 B4 x x‚ÇÅ eqta‚ÇÅ eqtb) ext w1 e1 = {!!}
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) ext w1 e1 = {!!}
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTUNION A3 B3 A4 B4 x x‚ÇÅ eqtA eqtB) ext w1 e1 = {!!}
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTSQUASH A3 A4 x x‚ÇÅ eqtA) ext w1 e1 = {!!}
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQFFDEFS A3 A4 x1 x2 x x‚ÇÅ eqtA eqx) ext w1 e1 = {!!}
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTUNIV x) ext w1 e1 = {!!}
eqInTypExt-‚àÄùïé-mon-PIa {u} {w} {A} {B} {A1} {A2} {B1} {B2} c‚ÇÅ c‚ÇÇ eqta w' e' (EQTBAR x) ext w1 e1 = {!!}
--}



{--is-universe-uni : (n : ‚Ñï) ‚Üí is-universe (uni n)
is-universe-uni n w A B h = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 z ‚Üí z) h--}



{--is-uni‚Üíis-universe : {u : univs} ‚Üí is-uni u ‚Üí is-universe u
is-uni‚Üíis-universe {u} (n , e) rewrite e = is-universe-uni (ul n)--}



{--is-uni‚Üímon : {u : univs} ‚Üí is-uni u ‚Üí mon (fst (snd u))
is-uni‚Üímon {u} (n , isu) {a} {b} {w} h w' e' rewrite isu = ‚Üëinbar h e'--}



eqInType-‚áõ-UNIV->0 : (n : ‚Ñï) (w : ùïé¬∑) (A B a b : CTerm)
                   ‚Üí A #‚áõ #UNIV n at w
                   ‚Üí B #‚áõ #UNIV n at w
                   ‚Üí (eqt : eqTypes (uni n) w A B)
                   ‚Üí (eqi : eqInType (uni n) w eqt a b)
                   ‚Üí 0 < n
{-# TERMINATING #-}
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTNAT x x‚ÇÅ) eqi = ‚ä•-elim (UNIVneqNAT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTQNAT x x‚ÇÅ) eqi = ‚ä•-elim (UNIVneqQNAT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) eqi = ‚ä•-elim (UNIVneqLT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) eqi = ‚ä•-elim (UNIVneqQLT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTFREE x x‚ÇÅ) eqi = ‚ä•-elim (UNIVneqFREE (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqi = ‚ä•-elim (UNIVneqPI (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqi = ‚ä•-elim (UNIVneqSUM (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqi = ‚ä•-elim (UNIVneqSET (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) eqi = ‚ä•-elim (UNIVneqEQ (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) eqi = ‚ä•-elim (UNIVneqUNION (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTSQUASH A1 A2 x x‚ÇÅ eqtA extA) eqi = ‚ä•-elim (UNIVneqTSQUASH (‚áõ-val-det tt tt c‚ÇÅ x))
--eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTDUM A1 A2 x x‚ÇÅ eqtA) eqi = ‚ä•-elim (UNIVneqDUM (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA extA eqx) eqi = ‚ä•-elim (UNIVneqFFDEFS (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 (suc n) w A B a b c‚ÇÅ c‚ÇÇ (EQTUNIV m p d‚ÇÅ d‚ÇÇ) eqi = _‚â§_.s‚â§s _‚â§_.z‚â§n
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTLIFT A1 A2 x x‚ÇÅ eqtA) eqi = ‚ä•-elim (UNIVneqLIFT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV->0 n w A B a b c‚ÇÅ c‚ÇÇ (EQTBAR x) eqi =
  lower (Bar.inBar-const inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar x aw eqi))
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes (uni n) w' A B) ‚Üí atbar x w' e' z
                         ‚Üí eqInType (uni n) w' z a b
                         ‚Üí Lift (lsuc Level.zero) (0 < n))
    aw w' e' z at eqi' = lift (eqInType-‚áõ-UNIV->0 n w' A B a b (‚áõ-mon e' c‚ÇÅ) (‚áõ-mon e' c‚ÇÇ) z eqi')



‚ÜíeqInType-EQTUNIV : (n : ‚Ñï) {w : ùïé¬∑} {a b : CTerm} {A B : CTerm}
                     (i : ‚Ñï) (p : i < n)
                     (c‚ÇÅ : A #‚áõ #UNIV i at w)
                     (c‚ÇÇ : B #‚áõ #UNIV i at w)
                     ‚Üí inbarEqTypes (uni i) w a b
                     ‚Üí eqInType (uni n) w {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ) a b
‚ÜíeqInType-EQTUNIV (suc n) {w} {a} {b} {A} {B} i p c‚ÇÅ c‚ÇÇ eqi with i <? n
... | yes q = ‚ÜíeqInType-EQTUNIV n {w} {a} {b} {A} {B} i q c‚ÇÅ c‚ÇÇ eqi
... | no q = d
  where
    e : n ‚â° i
    e = ‚â§-s‚â§s-‚â° i n (s‚â§s-inj p) (‚âÆ‚áí‚â• Œª z ‚Üí q (s‚â§s-inj z))

    d : inbarEqTypes (uni n) w a b
    d rewrite e = eqi



eqInType-EQTUNIV‚Üí : (n : ‚Ñï) {w : ùïé¬∑} {a b : CTerm} {A B : CTerm}
                     (i : ‚Ñï) (p : i < n)
                     (c‚ÇÅ : A #‚áõ #UNIV i at w)
                     (c‚ÇÇ : B #‚áõ #UNIV i at w)
                     ‚Üí eqInType (uni n) w {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ) a b
                     ‚Üí inbarEqTypes (uni i) w a b
eqInType-EQTUNIV‚Üí (suc n) {w} {a} {b} {A} {B} i p c‚ÇÅ c‚ÇÇ eqi with i <? n
... | yes q = eqInType-EQTUNIV‚Üí n {w} {a} {b} {A} {B} i q c‚ÇÅ c‚ÇÇ eqi
... | no q = d
  where
    e : n ‚â° i
    e = ‚â§-s‚â§s-‚â° i n (s‚â§s-inj p) (‚âÆ‚áí‚â• Œª z ‚Üí q (s‚â§s-inj z))

    d : inbarEqTypes (uni i) w a b
    d rewrite sym e = eqi



eqInType-‚áõ-UNIV : (i n : ‚Ñï) (p : i < n) (w : ùïé¬∑) (A B a b : CTerm)
                   ‚Üí A #‚áõ #UNIV i at w
                   ‚Üí B #‚áõ #UNIV i at w
                   ‚Üí (eqt : eqTypes (uni n) w A B)
                   ‚Üí (eqi : eqInType (uni n) w eqt a b)
                   ‚Üí inbarEqTypes (uni i) w a b
{-# TERMINATING #-}
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTNAT x x‚ÇÅ) eqi = ‚ä•-elim (UNIVneqNAT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTQNAT x x‚ÇÅ) eqi = ‚ä•-elim (UNIVneqQNAT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) eqi = ‚ä•-elim (UNIVneqLT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) eqi = ‚ä•-elim (UNIVneqQLT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTFREE x x‚ÇÅ) eqi = ‚ä•-elim (UNIVneqFREE (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqi = ‚ä•-elim (UNIVneqPI (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqi = ‚ä•-elim (UNIVneqSUM (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqi = ‚ä•-elim (UNIVneqSET (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) eqi = ‚ä•-elim (UNIVneqEQ (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) eqi = ‚ä•-elim (UNIVneqUNION (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTSQUASH A1 A2 x x‚ÇÅ eqtA extA) eqi = ‚ä•-elim (UNIVneqTSQUASH (‚áõ-val-det tt tt c‚ÇÅ x))
--eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTDUM A1 A2 x x‚ÇÅ eqtA) eqi = ‚ä•-elim (UNIVneqDUM (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA extA eqx) eqi = ‚ä•-elim (UNIVneqFFDEFS (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i (suc n) p w A B a b c‚ÇÅ c‚ÇÇ (EQTUNIV m q d‚ÇÅ d‚ÇÇ) eqi = c'
  where
    c : inbarEqTypes (uni m) w a b
    c = eqInType-EQTUNIV‚Üí (suc n) {w} {a} {b} {A} {B} m q d‚ÇÅ d‚ÇÇ eqi

    c' : inbarEqTypes (uni i) w a b
    c' rewrite UNIVinj (‚áõ-val-det tt tt c‚ÇÅ d‚ÇÅ) = c

eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTLIFT A1 A2 x x‚ÇÅ eqtA) eqi = ‚ä•-elim (UNIVneqLIFT (‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-‚áõ-UNIV i n p w A B a b c‚ÇÅ c‚ÇÇ (EQTBAR x) eqi =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar x aw eqi)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes (uni n) w' A B) ‚Üí atbar x w' e' z
                         ‚Üí eqInType (uni n) w' z a b
                         ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí eqTypes (uni i) w'' a b) e'))
    aw w' e' z at eqi' = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' z xt ‚Üí z) j
      where
        j : inbar w' (Œª w'' e ‚Üí eqTypes (uni i) w'' a b)
        j = eqInType-‚áõ-UNIV i n p w' A B a b (‚áõ-mon e' c‚ÇÅ) (‚áõ-mon e' c‚ÇÇ) z eqi'




{--inbar-eqTypes-pred‚ÜíeqInUnivi : {n : ‚Ñï} {w : ùïé¬∑} {a b : CTerm}
                                (p : 0 < n)
                                (i : inbar w (Œª w' _ ‚Üí eqTypes (uni (pred n)) w' a b))
                                ‚Üí eqInUnivi n w a b
inbar-eqTypes-pred‚ÜíeqInUnivi {suc n} {w} {a} {b} p i = i--}




{--is-uni-eqInType-EQTUNIV‚Üí : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {a b : CTerm} {A B : CTerm}
                            (x : fst (snd u) w A B)
                            ‚Üí eqInType u w (EQTUNIV x) a b
                            ‚Üí eqInUnivi (fst isu) w a b
is-uni-eqInType-EQTUNIV‚Üí {u} (n , isu) {w} {a} {b} {A} {B} x eqi rewrite isu = eqi--}



{--is-uni‚ÜíeqUnivi : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {A B : CTerm}
                  (x : fst (snd u) w A B)
                  ‚Üí eqUnivi (fst isu) w A B
is-uni‚ÜíeqUnivi {u} (n , isu) {w} {A} {B} x rewrite isu = x--}




eqInType-ext-bar : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {A B : CTerm}
                   (i : inbar w (Œª w' _ ‚Üí eqTypes u w' A B))
                   ‚Üí (ind : {u' : ùïå} {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : ‚â°Types u' w' A' B') ‚Üí <Type {u'} eqt' {(u , isu)} (EQTBAR i) ‚Üí eqInTypeExt eqt')
                   ‚Üí (a b : CTerm)
                   ‚Üí inbar' w i (Œª w' e' z ‚Üí eqInType u w' z a b)
                   ‚Üí (eqt : eqTypes u w A B) ‚Üí eqInType u w eqt a b
eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTNAT x x‚ÇÅ) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí #strongMonEq w'' a b) e'))
    aw w' e' z at eqt' =
      Bar.‚àÄùïé-inBarFunc
        inOpenBar-Bar
        (Œª w1 e1 s ext ‚Üí s)
        (eqInType-‚áõ-NAT u w' A B a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqt')

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTQNAT x x‚ÇÅ) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí #weakMonEq w'' a b) e'))
    aw w' e' z at eqt' =
      Bar.‚àÄùïé-inBarFunc
        inOpenBar-Bar
        (Œª w1 e1 s ext ‚Üí s)
        (eqInType-‚áõ-QNAT u w' A B a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqt')

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí #lift-<NUM-pair w'' a1 b1) e'))
    aw w' e' z at eqt' =
      Bar.‚àÄùïé-inBarFunc
        inOpenBar-Bar
        (Œª w1 e1 s ext ‚Üí s)
        (eqInType-‚áõ-LT u w' A B a1 b1 a2 b2 a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqt')

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí #lift-<NUM-pair w'' a1 b1) e'))
    aw w' e' z at eqt' =
      Bar.‚àÄùïé-inBarFunc
        inOpenBar-Bar
        (Œª w1 e1 s ext ‚Üí s)
        (eqInType-‚áõ-QLT u w' A B a1 b1 a2 b2 a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqt')

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTFREE x x‚ÇÅ) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí #‚áõto-same-CS w'' a b) e'))
    aw w' e' z at eqt' =
      Bar.‚àÄùïé-inBarFunc
        inOpenBar-Bar
        (Œª w1 e1 s ext ‚Üí s)
        (eqInType-‚áõ-FREE u w' A B a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqt')

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) ‚Üí atbar i w' e' z ‚Üí eqInType u w' z a b ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí PIeq (eqInType u w'' (eqta w'' e)) (Œª a1 a2 eqa ‚Üí eqInType u w'' (eqtb w'' e a1 a2 eqa)) a b) e'))
    aw w' e' z at eqi =
      Bar.‚àÄùïé-inBarFunc inOpenBar-Bar
        aw1
        (eqInType-‚áõ-PI2
          u w' A B A1 A2 B1 B2 a b
          (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb)
          (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')
          (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqi ind')

      where
        ind' : {u' : ùïå} {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : ‚â°Types u' w' A' B') ‚Üí ‚â§Type {u'} eqt' {u , isu} z ‚Üí eqInTypeExt eqt'
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§Type0 .eqt') = ind eqt' (<Type1 _ _ (<TypeBAR (u , isu) w A B i w' e' z at))
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§TypeS .eqt' .z x) = ind eqt' (<TypeS _ _ _ x (<TypeBAR (u , isu) w A B i w' e' z at))

        aw1 : ‚àÄùïé w' (Œª w'' e'' ‚Üí PIeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ a‚ÇÇ eqa)) a b
                                 ‚Üí ‚ÜëwPred' (Œª w''' e ‚Üí PIeq (eqInType u w''' (eqta w''' e)) (Œª a1 a2 eqa ‚Üí eqInType u w''' (eqtb w''' e a1 a2 eqa)) a b) e' w'' e'')
        aw1 w1 e1 h ext = PIeq-ext {u} {w} {A1} {A2} {B1} {B2} {eqta} {eqtb} {_} {_} {_} {a} {b} exta extb h

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) ‚Üí atbar i w' e' z ‚Üí eqInType u w' z a b ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí SUMeq (eqInType u w'' (eqta w'' e)) (Œª a1 a2 eqa ‚Üí eqInType u w'' (eqtb w'' e a1 a2 eqa)) w'' a b) e'))
    aw w' e' z at eqi =
      Bar.‚àÄùïé-inBarFunc inOpenBar-Bar
        aw1
        (eqInType-‚áõ-SUM2
          u w' A B A1 A2 B1 B2 a b
          (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb)
          (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')
          (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqi ind')

      where
        ind' : {u' : ùïå} {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : ‚â°Types u' w' A' B') ‚Üí ‚â§Type {u'} eqt' {u , isu} z ‚Üí eqInTypeExt eqt'
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§Type0 .eqt') = ind eqt' (<Type1 _ _ (<TypeBAR u w A B i w' e' z at))
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§TypeS .eqt' .z x) = ind eqt' (<TypeS _ _ _ x (<TypeBAR u w A B i w' e' z at))

        aw1 : ‚àÄùïé w' (Œª w'' e'' ‚Üí SUMeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ a‚ÇÇ eqa)) w'' a b
                                 ‚Üí ‚ÜëwPred' (Œª w''' e ‚Üí SUMeq (eqInType u w''' (eqta w''' e)) (Œª a1 a2 eqa ‚Üí eqInType u w''' (eqtb w''' e a1 a2 eqa)) w'' a b) e' w'' e'')
        aw1 w1 e1 h ext = SUMeq-ext {u} {w} {A1} {A2} {B1} {B2} {eqta} {eqtb} {_} {_} {_} {a} {b} exta extb h

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) ‚Üí atbar i w' e' z ‚Üí eqInType u w' z a b ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí SETeq (eqInType u w'' (eqta w'' e)) (Œª a1 a2 eqa ‚Üí eqInType u w'' (eqtb w'' e a1 a2 eqa)) a b) e'))
    aw w' e' z at eqi =
      Bar.‚àÄùïé-inBarFunc inOpenBar-Bar
        aw1
        (eqInType-‚áõ-SET2
          u w' A B A1 A2 B1 B2 a b
          (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb)
          (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')
          (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqi ind')

      where
        ind' : {u' : ùïå} {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : ‚â°Types u' w' A' B') ‚Üí ‚â§Type {u'} eqt' {u , isu} z ‚Üí eqInTypeExt eqt'
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§Type0 .eqt') = ind eqt' (<Type1 _ _ (<TypeBAR u w A B i w' e' z at))
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§TypeS .eqt' .z x) = ind eqt' (<TypeS _ _ _ x (<TypeBAR u w A B i w' e' z at))

        aw1 : ‚àÄùïé w' (Œª w'' e'' ‚Üí SETeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ a‚ÇÇ eqa)) a b
                                 ‚Üí ‚ÜëwPred' (Œª w''' e ‚Üí SETeq (eqInType u w''' (eqta w''' e)) (Œª a1 a2 eqa ‚Üí eqInType u w''' (eqtb w''' e a1 a2 eqa)) a b) e' w'' e'')
        aw1 w1 e1 h ext = SETeq-ext {u} {w} {A1} {A2} {B1} {B2} {eqta} {eqtb} exta extb h

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqta exta eqt1 eqt2) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) ‚Üí atbar i w' e' z ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí EQeq a1 a2 (eqInType u w'' (eqta w'' e)) w'' a b) e'))
    aw w' e' z at eqi =
      Bar.‚àÄùïé-inBarFunc inOpenBar-Bar
        aw1
        (eqInType-‚áõ-EQ2
          u w' A B A‚ÇÅ B‚ÇÅ a1 b1 a2 b2 a b
          (‚àÄùïé-mon e' eqta)
          (wPredExtIrr-eqInType-mon eqta exta w' e')
          (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqi ind')

      where
        ind' : {u' : ùïå} {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : ‚â°Types u' w' A' B') ‚Üí ‚â§Type {u'} eqt' {u , isu} z ‚Üí eqInTypeExt eqt'
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§Type0 .eqt') = ind eqt' (<Type1 _ _ (<TypeBAR u w A B i w' e' z at))
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§TypeS .eqt' .z x) = ind eqt' (<TypeS _ _ _ x (<TypeBAR u w A B i w' e' z at))

        aw1 : ‚àÄùïé w' (Œª w'' e'' ‚Üí EQeq a1 a2 (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b
                                 ‚Üí ‚ÜëwPred' (Œª w''' e ‚Üí EQeq a1 a2 (eqInType u w''' (eqta w''' e)) w''' a b) e' w'' e'')
        aw1 w1 e1 h ext = EQeq-ext {u} {w} {A‚ÇÅ} {B‚ÇÅ} {a1} {a2} {eqta} {_} {_} {_} {a} {b} exta h

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) ‚Üí atbar i w' e' z ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí UNIONeq (eqInType u w'' (eqta w'' e)) (eqInType u w'' (eqtb w'' e)) w'' a b) e'))
    aw w' e' z at eqi =
      Bar.‚àÄùïé-inBarFunc inOpenBar-Bar
        aw1
        (eqInType-‚áõ-UNION2
          u w' A B A1 A2 B1 B2 a b
          (‚àÄùïé-mon e' eqta)
          (‚àÄùïé-mon e' eqtb)
          (wPredExtIrr-eqInType-mon eqta exta w' e')
          (wPredExtIrr-eqInType-mon eqtb extb w' e')
          (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqi ind')

      where
        ind' : {u' : ùïå} {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : ‚â°Types u' w' A' B') ‚Üí ‚â§Type {u'} eqt' {u , isu} z ‚Üí eqInTypeExt eqt'
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§Type0 .eqt') = ind eqt' (<Type1 _ _ (<TypeBAR u w A B i w' e' z at))
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§TypeS .eqt' .z x) = ind eqt' (<TypeS _ _ _ x (<TypeBAR u w A B i w' e' z at))

        aw1 : ‚àÄùïé w' (Œª w'' e'' ‚Üí UNIONeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'')) w'' a b
                                 ‚Üí ‚ÜëwPred' (Œª w''' e ‚Üí UNIONeq (eqInType u w''' (eqta w''' e)) (eqInType u w''' (eqtb w''' e)) w''' a b) e' w'' e'')
        aw1 w1 e1 h ext = UNIONeq-ext {u} {w} {A1} {B1} {A2} {B2} {eqta} {eqtb} {_} {_} {_} {a} {b} exta extb h

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTSQUASH A1 A2 x x‚ÇÅ eqta exta) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) ‚Üí atbar i w' e' z ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí TSQUASHeq (eqInType u w'' (eqta w'' e)) w'' a b) e'))
    aw w' e' z at eqi =
      Bar.‚àÄùïé-inBarFunc inOpenBar-Bar
        aw1
        (eqInType-‚áõ-TSQUASH2
          u w' A B A1 A2 a b
          (‚àÄùïé-mon e' eqta)
          (wPredExtIrr-eqInType-mon eqta exta w' e')
          (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqi ind')

      where
        ind' : {u' : ùïå} {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : ‚â°Types u' w' A' B') ‚Üí ‚â§Type {u'} eqt' {u , isu} z ‚Üí eqInTypeExt eqt'
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§Type0 .eqt') = ind eqt' (<Type1 _ _ (<TypeBAR u w A B i w' e' z at))
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§TypeS .eqt' .z x) = ind eqt' (<TypeS _ _ _ x (<TypeBAR u w A B i w' e' z at))

        aw1 : ‚àÄùïé w' (Œª w'' e'' ‚Üí TSQUASHeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b
                                 ‚Üí ‚ÜëwPred' (Œª w''' e ‚Üí TSQUASHeq (eqInType u w''' (eqta w''' e)) w''' a b) e' w'' e'')
        aw1 w1 e1 h ext = TSQUASHeq-ext {u} {w} {A1} {A2} {eqta} {_} {_} {_} {a} {b} exta h

--eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTDUM A1 A2 x x‚ÇÅ eqt) = lift tt

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqta exta eqx) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) ‚Üí atbar i w' e' z ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí FFDEFSeq x1 (eqInType u w'' (eqta w'' e)) w'' a b) e'))
    aw w' e' z at eqi =
      Bar.‚àÄùïé-inBarFunc inOpenBar-Bar
        aw1
        (eqInType-‚áõ-FFDEFS2
          u w' A B A1 A2 x1 x2 a b
          (‚àÄùïé-mon e' eqta)
          (wPredExtIrr-eqInType-mon eqta exta w' e')
          (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z eqi ind')

      where
        ind' : {u' : ùïå} {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : ‚â°Types u' w' A' B') ‚Üí ‚â§Type {u'} eqt' {u , isu} z ‚Üí eqInTypeExt eqt'
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§Type0 .eqt') = ind eqt' (<Type1 _ _ (<TypeBAR u w A B i w' e' z at))
        ind' {u'} {w''} {A'} {B'} eqt' (‚â§TypeS .eqt' .z x) = ind eqt' (<TypeS _ _ _ x (<TypeBAR u w A B i w' e' z at))

        aw1 : ‚àÄùïé w' (Œª w'' e'' ‚Üí FFDEFSeq x1 (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b
                                 ‚Üí ‚ÜëwPred' (Œª w''' e ‚Üí FFDEFSeq x1 (eqInType u w''' (eqta w''' e)) w''' a b) e' w'' e'')
        aw1 w1 e1 h ext = FFDEFSeq-ext {u} {w} {A1} {A2} {x1} {eqta} {_} {_} {_} {a} {b} exta h

eqInType-ext-bar {u} (n , isu) {w} {A} {B} i ind a b j (EQTUNIV m p d‚ÇÅ d‚ÇÇ) rewrite isu =
  ‚ÜíeqInType-EQTUNIV n {w} {a} {b} {A} {B} m p d‚ÇÅ d‚ÇÇ c
  where
    j' : inbar' w i (Œª w' e' z ‚Üí eqInType (uni n) w' z a b)
    j' = j

    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes (uni n) w' A B) ‚Üí atbar i w' e' z
                             ‚Üí eqInType (uni n) w' z a b
                             ‚Üí inbar w' (‚ÜëwPred' (Œª w'' _ ‚Üí eqTypes (uni m) w'' a b) e'))
    aw w' e' z at eqt = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' z x ‚Üí z) ib
      where
        ib : inbar w' (Œª w'' _ ‚Üí eqTypes (uni m) w'' a b)
        ib = eqInType-‚áõ-UNIV m n p w' A B a b (‚áõ-mon e' d‚ÇÅ) (‚áõ-mon e' d‚ÇÇ) z eqt

    c : inbarEqTypes (uni m) w a b
    c = Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTLIFT A1 A2 x x‚ÇÅ eqta) = {!!}

eqInType-ext-bar {u} isu {w} {A} {B} i ind a b j (EQTBAR x) =
  Bar.inBar'-change inOpenBar-Bar i x aw j
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (x‚ÇÅ x‚ÇÇ : eqTypes u w' A B)
                         ‚Üí atbar i w' e' x‚ÇÅ
                         ‚Üí atbar x w' e' x‚ÇÇ
                         ‚Üí eqInType u w' x‚ÇÅ a b
                         ‚Üí eqInType u w' x‚ÇÇ a b)
    aw w1 e1 x‚ÇÅ x‚ÇÇ a‚ÇÅ a‚ÇÇ ei = fst (ext x‚ÇÇ a b) ei
      where
        ext : eqInTypeExt x‚ÇÅ
        ext = ind x‚ÇÅ (<Type1 _ _ (<TypeBAR _ _ _ _ i w1 e1 x‚ÇÅ a‚ÇÅ))




{--
data ¬¨bar (u : univs) {w : ùïé¬∑} {T1 T2 : CTerm} : eqTypes u w T1 T2 ‚Üí Set
data ¬¨bar u {w} {T1} {T2} where
  ¬¨bar-NAT : (c‚ÇÅ : T1 ‚áõ NAT at w) (c‚ÇÇ : T2 ‚áõ NAT at w) ‚Üí ¬¨bar u (EQTNAT c‚ÇÅ c‚ÇÇ)
  ¬¨bar-QNAT : (c‚ÇÅ : T1 ‚áõ QNAT at w) (c‚ÇÇ : T2 ‚áõ QNAT at w) ‚Üí ¬¨bar u (EQTQNAT c‚ÇÅ c‚ÇÇ)
  ¬¨bar-LT : (a1 a2 b1 b2 : CTerm)
            (c‚ÇÅ : T1 ‚áõ (LT a1 b1) at w) (c‚ÇÇ : T2 ‚áõ (LT a2 b2) at w)
            (s‚ÇÅ : strongMonEq w a1 a2) (s‚ÇÇ : strongMonEq w b1 b2)
            ‚Üí ¬¨bar u (EQTLT a1 a2 b1 b2 c‚ÇÅ c‚ÇÇ s‚ÇÅ s‚ÇÇ)
  ¬¨bar-QLT : (a1 a2 b1 b2 : CTerm)
             (c‚ÇÅ : T1 ‚áõ (QLT a1 b1) at w) (c‚ÇÇ : T2 ‚áõ (QLT a2 b2) at w)
             (w‚ÇÅ : weakMonEq w a1 a2) (w‚ÇÇ : weakMonEq w b1 b2)
             ‚Üí ¬¨bar u (EQTQLT a1 a2 b1 b2 c‚ÇÅ c‚ÇÇ w‚ÇÅ w‚ÇÇ)
  ¬¨bar-FREE : (c‚ÇÅ : T1 ‚áõ FREE at w) (c‚ÇÇ : T2 ‚áõ FREE at w) ‚Üí ¬¨bar u (EQTFREE c‚ÇÅ c‚ÇÇ)
  ¬¨bar-PI : (A1 B1 A2 B2 : CTerm)
            (c‚ÇÅ : T1 ‚áõ (PI A1 B1) at w) (c‚ÇÇ : T2 ‚áõ (PI A2 B2) at w)
            (eqta : ‚àÄùïé w (Œª w' _ ‚Üí eqTypes u w' A1 A2))
            (eqtb : ‚àÄùïé w (Œª w' e ‚Üí ‚àÄ a1 a2 ‚Üí eqInType u w' (eqta w' e) a1 a2
                                   ‚Üí eqTypes u w' (sub a1 B1) (sub a2 B2)))
            (exta : (a b : CTerm) ‚Üí wPredExtIrr (Œª w e ‚Üí eqInType u w (eqta w e) a b))
            (extb : (a b c d : CTerm) ‚Üí wPredDepExtIrr (Œª w e x ‚Üí eqInType u w (eqtb w e a b x) c d))
            ‚Üí ¬¨bar u (EQTPI A1 B1 A2 B2 c‚ÇÅ c‚ÇÇ eqta eqtb exta extb)
  ¬¨bar-SUM : (A1 B1 A2 B2 : CTerm)
             (c‚ÇÅ : T1 ‚áõ (SUM A1 B1) at w) (c‚ÇÇ : T2 ‚áõ (SUM A2 B2) at w)
             (eqta : ‚àÄùïé w (Œª w' _ ‚Üí eqTypes u w' A1 A2))
             (eqtb : ‚àÄùïé w (Œª w' e ‚Üí ‚àÄ a1 a2 ‚Üí eqInType u w' (eqta w' e) a1 a2
                                    ‚Üí eqTypes u w' (sub a1 B1) (sub a2 B2)))
             ‚Üí ¬¨bar u (EQTSUM A1 B1 A2 B2 c‚ÇÅ c‚ÇÇ eqta eqtb)
  ¬¨bar-SET : (A1 B1 A2 B2 : CTerm)
             (c‚ÇÅ : T1 ‚áõ (SET A1 B1) at w) (c‚ÇÇ : T2 ‚áõ (SET A2 B2) at w)
             (eqta : ‚àÄùïé w (Œª w' _ ‚Üí eqTypes u w' A1 A2))
             (eqtb : ‚àÄùïé w (Œª w' e ‚Üí ‚àÄ a1 a2 ‚Üí eqInType u w' (eqta w' e) a1 a2
                                    ‚Üí eqTypes u w' (sub a1 B1) (sub a2 B2)))
             ‚Üí ¬¨bar u (EQTSET A1 B1 A2 B2 c‚ÇÅ c‚ÇÇ eqta eqtb)
  ¬¨bar-EQ : (a1 b1 a2 b2 A B : CTerm)
            (c‚ÇÅ : T1 ‚áõ (EQ a1 a2 A) at w) (c‚ÇÇ : T2 ‚áõ (EQ b1 b2 B) at w)
            (eqtA : ‚àÄùïé w (Œª w' _ ‚Üí eqTypes u w' A B))
            (eqt1 : ‚àÄùïé w (Œª w' e ‚Üí eqInType u w' (eqtA w' e) a1 b1))
            (eqt2 : ‚àÄùïé w (Œª w' e ‚Üí eqInType u w' (eqtA w' e) a2 b2))
            ‚Üí ¬¨bar u (EQTEQ a1 b1 a2 b2 A B c‚ÇÅ c‚ÇÇ eqtA eqt1 eqt2)
  ¬¨bar-UNION : (A1 B1 A2 B2 : CTerm)
               (c‚ÇÅ : T1 ‚áõ (UNION A1 B1) at w) (c‚ÇÇ : T2 ‚áõ (UNION A2 B2) at w)
               (eqtA : ‚àÄùïé w (Œª w' _ ‚Üí eqTypes u w' A1 A2))
               (eqtB : ‚àÄùïé w (Œª w' _ ‚Üí eqTypes u w' B1 B2))
               ‚Üí ¬¨bar u (EQTUNION A1 B1 A2 B2 c‚ÇÅ c‚ÇÇ eqtA eqtB)
  ¬¨bar-SQUASH : (A1 A2 : CTerm)
                (c‚ÇÅ : T1 ‚áõ (TSQUASH A1) at w) (c‚ÇÇ : T2 ‚áõ (TSQUASH A2) at w)
                (eqtA : ‚àÄùïé w (Œª w' _ ‚Üí eqTypes u w' A1 A2))
                ‚Üí ¬¨bar u (EQTSQUASH A1 A2 c‚ÇÅ c‚ÇÇ eqtA)
  ¬¨bar-FFDEFS : (A1 A2 x1 x2 : CTerm)
                (c‚ÇÅ : T1 ‚áõ (FFDEFS A1 x1) at w) (c‚ÇÇ : T2 ‚áõ (FFDEFS A2 x2) at w)
                (eqtA : ‚àÄùïé w (Œª w' _ ‚Üí eqTypes u w' A1 A2))
                (eqx : ‚àÄùïé w (Œª w' e ‚Üí eqInType u w' (eqtA w' e) x1 x2))
                ‚Üí ¬¨bar u (EQFFDEFS A1 A2 x1 x2 c‚ÇÅ c‚ÇÇ eqtA eqx)
  ¬¨bar-UNIV : (c : proj‚ÇÅ (proj‚ÇÇ u) w T1 T2) ‚Üí ¬¨bar u (EQTUNIV c)
--}


{--
-- direct proof?
collapseBars-eqInType : {u : univs} (isu : is-universe u) {w : ùïé¬∑} {A B : CTerm}
                        (i : inbar w (Œª w' _ ‚Üí eqTypes u w' A B))
                        (ext : {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : eqTypes u w' A' B') ‚Üí <Type u eqt' (EQTBAR i) ‚Üí eqInTypeExt eqt')
                        {a b : CTerm}
                        (j : inbar' w i (Œª w' e' z ‚Üí eqInType u w' z a b))
                        ‚Üí inbar' w i (Œª w' e' z ‚Üí eqInType u w' z a b √ó ¬¨bar u z)
collapseBars-eqInType {u} isu {w} {A} {B} i ext {a} {b} j = {!!}

  Bar.inBar'-idem inOpenBar-Bar i k
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (x : eqTypes u w' A B) ‚Üí atbar i w' e' x
                         ‚Üí eqInType u w' x a b
                         ‚Üí inbar' w' (‚Üë'inbar i e') (‚ÜëwPredDep' (Œª w'' e'' z ‚Üí eqInType u w'' z a b √ó ¬¨bar u z) e'))
    aw w1 e1 (EQTNAT x x‚ÇÅ) at ei =
      Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar {!!} (‚Üë'inbar i e1)
      where
        aw0 : ‚àÄùïé w1 (Œª w' e' ‚Üí (x‚ÇÇ : ‚ÜëwPred' (Œª w'' e ‚Üí eqTypes u w'' A B) e1 w' e') ‚Üí  w')
    aw w1 e1 (EQTQNAT x x‚ÇÅ) at ei = {!!}
    aw w1 e1 (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) at ei = {!!}
    aw w1 e1 (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) at ei = {!!}
    aw w1 e1 (EQTFREE x x‚ÇÅ) at ei = {!!}
    aw w1 e1 (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) at ei = {!!}
    aw w1 e1 (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) at ei = {!!}
    aw w1 e1 (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) at ei = {!!}
    aw w1 e1 (EQTEQ a1 b1 a2 b2 A B x x‚ÇÅ eqtA eqt1 eqt2) at ei = {!!}
    aw w1 e1 (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) at ei = {!!}
    aw w1 e1 (EQTSQUASH A1 A2 x x‚ÇÅ eqtA) at ei = {!!}
    aw w1 e1 (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA eqx) at ei = {!!}
    aw w1 e1 (EQTUNIV x) at ei = {!!}
    aw w1 e1 (EQTBAR x) at ei = {!!}

    k : inbar w (Œª w' e' ‚Üí inbar' w' (‚Üë'inbar i e') (‚ÜëwPredDep' (Œª w' e' z ‚Üí eqInType u w' z a b √ó ¬¨bar u z) e'))
    k = Bar.‚àÄùïé-inBar'-inBar2 inOpenBar-Bar i aw j
--}



{--eqInUnivi-mon : (n : ‚Ñï) ‚Üí mon (eqInUnivi n)
eqInUnivi-mon (suc n) {a} {b} {w} eqi w' e' =
  Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' z ‚Üí z) (‚Üëinbar eqi e')--}



uniUpTo-mon : {n i : ‚Ñï} {p : i < n} ‚Üí mon (uniUpTo n i p)
uniUpTo-mon {suc n} {i} {p} {w} eqt w' e with i <? n
... | yes q = uniUpTo-mon {n} {i} {q} {w} eqt w' e
... | no q = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' z ‚Üí z) (‚Üëinbar eqt e)


uniUpTo‚ÜíinbarEqTypes : {i n : ‚Ñï} {p : i < n} {w : ùïé¬∑} {a b : CTerm}
                        ‚Üí uniUpTo n i p w a b
                        ‚Üí inbarEqTypes (uni i) w a b
uniUpTo‚ÜíinbarEqTypes {i} {suc n} {p} {w} {a} {b} eqi with i <? n
... | yes q = uniUpTo‚ÜíinbarEqTypes {i} {n} {q} {w} {a} {b} eqi
... | no q = d
  where
    e : n ‚â° i
    e = ‚â§-s‚â§s-‚â° i n (s‚â§s-inj p) (‚âÆ‚áí‚â• Œª z ‚Üí q (s‚â§s-inj z))

    d : inbarEqTypes (uni i) w a b
    d rewrite sym e = eqi



inbarEqTypes‚ÜíuniUpTo : {i n : ‚Ñï} {p : i < n} {w : ùïé¬∑} {a b : CTerm}
                        ‚Üí inbarEqTypes (uni i) w a b
                        ‚Üí uniUpTo n i p w a b
inbarEqTypes‚ÜíuniUpTo {i} {suc n} {p} {w} {a} {b} eqi with i <? n
... | yes q = inbarEqTypes‚ÜíuniUpTo {i} {n} {q} {w} {a} {b} eqi
... | no q = d
  where
    e : n ‚â° i
    e = ‚â§-s‚â§s-‚â° i n (s‚â§s-inj p) (‚âÆ‚áí‚â• Œª z ‚Üí q (s‚â§s-inj z))

    d : inbarEqTypes (uni n) w a b
    d rewrite e = eqi



uniUpTo-<irr : {i n : ‚Ñï} {p q : i < n} {w : ùïé¬∑} {a b : CTerm}
               ‚Üí uniUpTo n i p w a b
               ‚Üí uniUpTo n i q w a b
uniUpTo-<irr {i} {n} {p} {q} {w} {a} {b} e = inbarEqTypes‚ÜíuniUpTo {i} {n} {q} (uniUpTo‚ÜíinbarEqTypes {i} {n} {p} e)




_B#‚áõ_at_ : (T T' : CTerm) (w : ùïé¬∑) ‚Üí Set‚ÇÅ
T B#‚áõ T' at w = inbar w (Œª w' _ ‚Üí T #‚áõ T' at w')
infix 30 _B#‚áõ_at_


_B‚áõ_at_ : (T T' : Term) (w : ùïé¬∑) ‚Üí Set‚ÇÅ
T B‚áõ T' at w = inbar w (Œª w' _ ‚Üí T ‚áõ T' at w')
infix 30 _B‚áõ_at_


#‚áõ-mon : {a b : CTerm} {w2 w1 : ùïé¬∑} ‚Üí w1 ‚äë¬∑ w2 ‚Üí a #‚áõ b at w1 ‚Üí a #‚áõ b at w2
#‚áõ-mon {a} {b} {w2} {w1} e c = ‚áõ-mon e c


B#‚áõ-mon : {a b : CTerm} {w2 w1 : ùïé¬∑} ‚Üí w1 ‚äë¬∑ w2 ‚Üí a B#‚áõ b at w1 ‚Üí a B#‚áõ b at w2
B#‚áõ-mon {a} {b} {w2} {w1} e c = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' z ‚Üí z) (Bar.‚ÜëinBar inOpenBar-Bar c e)


#‚áõ‚ÜíB#‚áõ : {a b : CTerm} {w : ùïé¬∑} ‚Üí a #‚áõ b at w ‚Üí a B#‚áõ b at w
#‚áõ‚ÜíB#‚áõ {a} {b} {w} c = Bar.‚àÄùïé-inBar inOpenBar-Bar (Œª w' e' ‚Üí #‚áõ-mon {a} {b} e' c)


B‚Çó#‚áõ-val-det : {w : ùïé¬∑} {a v‚ÇÅ v‚ÇÇ : CTerm} ‚Üí #isValue v‚ÇÅ ‚Üí #isValue v‚ÇÇ ‚Üí a B#‚áõ v‚ÇÅ at w ‚Üí a #‚áõ v‚ÇÇ at w ‚Üí ‚åú v‚ÇÅ ‚åù ‚â° ‚åú v‚ÇÇ ‚åù
B‚Çó#‚áõ-val-det {w} {a} {v‚ÇÅ} {v‚ÇÇ} isv‚ÇÅ isv‚ÇÇ c‚ÇÅ c‚ÇÇ =
  lower (Bar.inBar-const inOpenBar-Bar (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw c‚ÇÅ))
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí a #‚áõ v‚ÇÅ at w' ‚Üí Lift 1‚Ñì (‚åú v‚ÇÅ ‚åù ‚â° ‚åú v‚ÇÇ ‚åù))
    aw w' e' c = lift (‚â°CTerm {v‚ÇÅ} {v‚ÇÇ} (#‚áõ-val-det {w'} {a} {v‚ÇÅ} {v‚ÇÇ} isv‚ÇÅ isv‚ÇÇ c (‚áõ-mon e' c‚ÇÇ)))



B‚Çó‚áõ-val-det : {w : ùïé¬∑} {a v‚ÇÅ v‚ÇÇ : Term} ‚Üí isValue v‚ÇÅ ‚Üí isValue v‚ÇÇ ‚Üí a B‚áõ v‚ÇÅ at w ‚Üí a ‚áõ v‚ÇÇ at w ‚Üí v‚ÇÅ ‚â° v‚ÇÇ
B‚Çó‚áõ-val-det {w} {a} {v‚ÇÅ} {v‚ÇÇ} isv‚ÇÅ isv‚ÇÇ c‚ÇÅ c‚ÇÇ =
  lower (Bar.inBar-const inOpenBar-Bar (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw c‚ÇÅ))
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí a ‚áõ v‚ÇÅ at w' ‚Üí Lift 1‚Ñì (v‚ÇÅ ‚â° v‚ÇÇ))
    aw w' e' c = lift (‚áõ-val-det isv‚ÇÅ isv‚ÇÇ c (‚áõ-mon e' c‚ÇÇ))



B·µ£#‚áõ-val-det : {w : ùïé¬∑} {a v‚ÇÅ v‚ÇÇ : CTerm} ‚Üí #isValue v‚ÇÅ ‚Üí #isValue v‚ÇÇ ‚Üí a #‚áõ v‚ÇÅ at w ‚Üí a B#‚áõ v‚ÇÇ at w ‚Üí ‚åú v‚ÇÅ ‚åù ‚â° ‚åú v‚ÇÇ ‚åù
B·µ£#‚áõ-val-det {w} {a} {v‚ÇÅ} {v‚ÇÇ} isv‚ÇÅ isv‚ÇÇ c‚ÇÅ c‚ÇÇ = sym (B‚Çó#‚áõ-val-det {w} {a} {v‚ÇÇ} {v‚ÇÅ}  isv‚ÇÇ isv‚ÇÅ c‚ÇÇ c‚ÇÅ)



B·µ£‚áõ-val-det : {w : ùïé¬∑} {a v‚ÇÅ v‚ÇÇ : Term} ‚Üí isValue v‚ÇÅ ‚Üí isValue v‚ÇÇ ‚Üí a ‚áõ v‚ÇÅ at w ‚Üí a B‚áõ v‚ÇÇ at w ‚Üí v‚ÇÅ ‚â° v‚ÇÇ
B·µ£‚áõ-val-det {w} {a} {v‚ÇÅ} {v‚ÇÇ} isv‚ÇÅ isv‚ÇÇ c‚ÇÅ c‚ÇÇ = sym (B‚Çó‚áõ-val-det isv‚ÇÇ isv‚ÇÅ c‚ÇÇ c‚ÇÅ)



eqInType-u-bar : {i n : ‚Ñï} (p : i < n) {w : ùïé¬∑} {A B : CTerm}
                 (c‚ÇÅ : A B#‚áõ (#UNIV i) at w)
                 (c‚ÇÇ : B B#‚áõ (#UNIV i) at w)
                 (eqt : eqTypes (uni n) w A B)
                 (a b : CTerm)
                 (eqi : uniUpTo n i p w a b)
                 ‚Üí eqInType (uni n) w eqt a b
{-# TERMINATING #-}
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTNAT x x‚ÇÅ) a b eqi = ‚ä•-elim (UNIVneqNAT (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTQNAT x x‚ÇÅ) a b eqi = ‚ä•-elim (UNIVneqQNAT (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) a b eqi = ‚ä•-elim (UNIVneqLT (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) a b eqi = ‚ä•-elim (UNIVneqQLT (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTFREE x x‚ÇÅ) a b eqi = ‚ä•-elim (UNIVneqFREE (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) a b eqi = ‚ä•-elim (UNIVneqPI (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) a b eqi = ‚ä•-elim (UNIVneqSUM (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) a b eqi = ‚ä•-elim (UNIVneqSET (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) a b eqi = ‚ä•-elim (UNIVneqEQ (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) a b eqi = ‚ä•-elim (UNIVneqUNION (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTSQUASH A1 A2 x x‚ÇÅ eqta exta) a b eqi = ‚ä•-elim (UNIVneqTSQUASH (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
--eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTDUM A1 A2 x x‚ÇÅ eqtA) a b eqi = ‚ä•-elim (lower (Bar.inBar-const inOpenBar-Bar (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' (c‚ÇÅ , c‚ÇÇ) ‚Üí lift (UNIVneqDUM (B‚Çó‚áõ-val-det tt tt c‚ÇÅ (‚áõ-mon e' x)))) i)))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA extA eqx) a b eqi = ‚ä•-elim (UNIVneqFFDEFS (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTUNIV m q d‚ÇÅ d‚ÇÇ) a b eqi rewrite UNIVinj (B‚Çó‚áõ-val-det tt tt c‚ÇÅ d‚ÇÅ) = uniUpTo-<irr {m} {n} {p} {q} eqi
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTLIFT A1 A2 x x‚ÇÅ eqta) a b eqi = ‚ä•-elim (UNIVneqLIFT (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTBAR x) a b eqi = c
  where
    c : inbar' w x (Œª w' _ (z : eqTypes (uni n) w' A B) ‚Üí eqInType (uni n) w' z a b)
    c = Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar x aw
      where
        aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes (uni n) w' A B) (at : atbar x w' e' z) ‚Üí eqInType (uni n) w' z a b)
        aw w' e' equ at = eqInType-u-bar p (B#‚áõ-mon {A} {#UNIV i} e' c‚ÇÅ) (B#‚áõ-mon {B} {#UNIV i} e' c‚ÇÇ) equ a b (uniUpTo-mon {n} {i} {p} eqi w' e')




eqInType-u : {i n : ‚Ñï} (p : i < n) {w : ùïé¬∑} {A B : CTerm}
             (c‚ÇÅ : A #‚áõ (#UNIV i) at w)
             (c‚ÇÇ : B #‚áõ (#UNIV i) at w)
             (eqt : eqTypes (uni n) w A B)
             (a b : CTerm)
             (eqi : uniUpTo n i p w a b)
             ‚Üí eqInType (uni n) w eqt a b
eqInType-u {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ eqt a b eqi =
  eqInType-u-bar p (#‚áõ‚ÜíB#‚áõ {A} {#UNIV i} c‚ÇÅ) (#‚áõ‚ÜíB#‚áõ {B} {#UNIV i} c‚ÇÇ) eqt a b eqi



eqInType-u-rev-bar : {i n : ‚Ñï} (p : i < n) {w : ùïé¬∑} {A B : CTerm}
                     (c‚ÇÅ : A B#‚áõ #UNIV i at w)
                     (c‚ÇÇ : B B#‚áõ #UNIV i at w)
                     (eqt : eqTypes (uni n) w A B)
                     (a b : CTerm)
                     (eqi : eqInType (uni n) w eqt a b)
                     ‚Üí uniUpTo n i p w a b
{-# TERMINATING #-}
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTNAT x x‚ÇÅ) a b eqi = ‚ä•-elim (UNIVneqNAT (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTQNAT x x‚ÇÅ) a b eqi = ‚ä•-elim (UNIVneqQNAT (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) a b eqi = ‚ä•-elim (UNIVneqLT (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) a b eqi = ‚ä•-elim (UNIVneqQLT (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTFREE x x‚ÇÅ) a b eqi = ‚ä•-elim (UNIVneqFREE (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) a b eqi = ‚ä•-elim (UNIVneqPI (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) a b eqi = ‚ä•-elim (UNIVneqSUM (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) a b eqi = ‚ä•-elim (UNIVneqSET (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) a b eqi = ‚ä•-elim (UNIVneqEQ (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) a b eqi = ‚ä•-elim (UNIVneqUNION (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTSQUASH A1 A2 x x‚ÇÅ eqta exta) a b eqi = ‚ä•-elim (UNIVneqTSQUASH (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
--eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTDUM A1 A2 x x‚ÇÅ eqtA) a b eqi = ‚ä•-elim (lower (Bar.inBar-const inOpenBar-Bar (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' (c‚ÇÅ , c‚ÇÇ) ‚Üí lift (UNIVneqDUM (B‚Çó‚áõ-val-det tt tt c‚ÇÅ (‚áõ-mon e' x)))) i)))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA extA eqx) a b eqi = ‚ä•-elim (UNIVneqFFDEFS (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTUNIV m q d‚ÇÅ d‚ÇÇ) a b eqi rewrite UNIVinj (B‚Çó‚áõ-val-det tt tt c‚ÇÅ d‚ÇÅ) = uniUpTo-<irr {m} {n} {q} {p} eqi
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTLIFT A1 A2 x x‚ÇÅ eqta) a b eqi = ‚ä•-elim (UNIVneqLIFT (B‚Çó‚áõ-val-det tt tt c‚ÇÅ x))
eqInType-u-rev-bar {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ (EQTBAR x) a b eqi = inbarEqTypes‚ÜíuniUpTo {i} {n} {p} {w} {a} {b} c
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes (uni n) w' A B) (at : atbar x w' e' z)
                         ‚Üí eqInType (uni n) w' z a b
                         ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí eqTypes (uni i) w'' a b) e'))
    aw w' e' z at eqi' = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 eqt' z ‚Üí eqt')
                                          (uniUpTo‚ÜíinbarEqTypes {i} {n} {p} {w'} {a} {b} (eqInType-u-rev-bar p (B#‚áõ-mon {A} {#UNIV i} e' c‚ÇÅ) (B#‚áõ-mon {B} {#UNIV i} e' c‚ÇÇ) z a b eqi'))

    c : inbarEqTypes (uni i) w a b
    c = Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar x aw eqi)


eqInType-u-rev : {i n : ‚Ñï} (p : i < n) {w : ùïé¬∑} {A B : CTerm}
                 (c‚ÇÅ : A #‚áõ (#UNIV i) at w)
                 (c‚ÇÇ : B #‚áõ (#UNIV i) at w)
                 (eqt : eqTypes (uni n) w A B)
                 (a b : CTerm)
                 (eqi : eqInType (uni n) w eqt a b)
                 ‚Üí uniUpTo n i p w a b
eqInType-u-rev {i} {n} p {w} {A} {B} c‚ÇÅ c‚ÇÇ eqt a b eqi =
  eqInType-u-rev-bar p (#‚áõ‚ÜíB#‚áõ {A} {#UNIV i} c‚ÇÅ) (#‚áõ‚ÜíB#‚áõ {B} {#UNIV i} c‚ÇÇ) eqt a b eqi



{--eqInType-u-rev2 : {u : univs} {w : ùïé¬∑} {A B : CTerm}
                  (isu : is-uni u)
                  (i : fst (snd u) w A B)
                  (eqt : eqTypes u w A B)
                  (a b : CTerm)
                  (eqi : eqInType u w eqt a b)
                  ‚Üí eqInType u w (EQTUNIV i) a b
eqInType-u-rev2 {u} {w} {A} {B} (n , isu) i eqt a b eqi rewrite isu = eqInType-u-rev i eqt a b eqi
--}




eqInTypeExt-EQTUNIV : {n : ‚Ñï} {w : ùïé¬∑} {A B : CTerm}
                      (i : ‚Ñï) (p : i < n)
                      (c‚ÇÅ : A #‚áõ #UNIV i at w)
                      (c‚ÇÇ : B #‚áõ #UNIV i at w)
                      ‚Üí eqInTypeExt {uni n} {w} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
eqInTypeExt-EQTUNIV {n} {w} {A} {B} i p c‚ÇÅ c‚ÇÇ eqt' a b =
  eqInType-u p c‚ÇÅ c‚ÇÇ eqt' a b , eqInType-u-rev p c‚ÇÅ c‚ÇÇ eqt' a b



{--
eqInType-mon : {u : univs} (umon : mon (fst (snd u))) {w : ùïé¬∑} {A B : CTerm}
               (eqt : eqTypes u w A B) {a b : CTerm} (w' : ùïé¬∑) (e' : w' ‚âΩ w)
               ‚Üí eqInType u w eqt a b
               ‚Üí eqInType u w' (eqTypes-mon u umon eqt w' e') a b
eqInType-mon {u} umon {w} {A} {B} eqt {a} {b} w' e' eqi = {!!}
--}





{--
subst-eqUnivi : {u : univs} {n : ‚Ñï} (e : u ‚â° uni (suc n))
                (x : proj‚ÇÅ (snd u) w A B)
                ‚Üí inbar w' (Œª w'' _ ‚Üí A #‚áõ #UNIV (suc n) at w'' √ó B #‚áõ #UNIV (suc n) at w'')
--}



eqInType-ext-bar-rev : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {A B : CTerm}
                       (i : inbar w (Œª w' _ ‚Üí eqTypes u w' A B))
                       ‚Üí (ind : {u' : univs} {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : eqTypes u' w' A' B') ‚Üí <Type {u'} eqt' (EQTBAR i) ‚Üí eqInTypeExt eqt')
                       ‚Üí (a b : CTerm)
                       ‚Üí (eqt : eqTypes u w A B)
                       ‚Üí eqInType u w eqt a b
                       ‚Üí inbar' w i (Œª w' e' z ‚Üí eqInType u w' z a b)
eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTNAT x x‚ÇÅ) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at = eqInType-‚áõ-NAT-rev u w' A B a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z ei
      where
        ei : inbar w' (Œª w'' e ‚Üí #strongMonEq w'' a b)
        ei = ‚Üëinbar eqi e'

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTQNAT x x‚ÇÅ) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at = eqInType-‚áõ-QNAT-rev u w' A B a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z ei
      where
        ei : inbar w' (Œª w'' e ‚Üí #weakMonEq w'' a b)
        ei = ‚Üëinbar eqi e'

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at = eqInType-‚áõ-LT-rev u w' A B a1 b1 a2 b2 a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z ei
      where
        ei : inbar w' (Œª w'' e ‚Üí #lift-<NUM-pair w'' a1 b1)
        ei = ‚Üëinbar eqi e'

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at = eqInType-‚áõ-QLT-rev u w' A B a1 b1 a2 b2 a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z ei
      where
        ei : inbar w' (Œª w'' e ‚Üí #lift-<NUM-pair w'' a1 b1)
        ei = ‚Üëinbar eqi e'

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTFREE x x‚ÇÅ) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at = eqInType-‚áõ-FREE-rev u w' A B a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z ei
      where
        ei : inbar w' (Œª w'' e ‚Üí #‚áõto-same-CS w'' a b)
        ei = ‚Üëinbar eqi e'

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at =
      eqInType-‚áõ-PI-rev2
        u w' A B A1 A2 B1 B2 a b
        (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb)
        (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')
        (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z (<Type-EQTBAR-eqInTypeExt at ind) ib
      where
        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí (a‚ÇÅ b‚ÇÅ : CTerm) (e‚ÇÅ : eqInType u w''' (eqta w''' e) a‚ÇÅ b‚ÇÅ) ‚Üí eqInType u w''' (eqtb w''' e a‚ÇÅ b‚ÇÅ e‚ÇÅ) (#APPLY a a‚ÇÅ) (#APPLY b b‚ÇÅ)) e' w'' e''
                                ‚Üí PIeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ a‚ÇÇ eqa)) a b)
        aw' w1 e1 h a‚ÇÅ a‚ÇÇ eqa = h a‚ÇÅ a‚ÇÇ eqa

        ib : inbar w' (Œª w'' e ‚Üí PIeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e a‚ÇÅ a‚ÇÇ eqa)) a b)
        ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' (‚Üëinbar eqi e')

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at =
      eqInType-‚áõ-SUM-rev2
        u w' A B A1 A2 B1 B2 a b
        (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb)
        (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')
        (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z (<Type-EQTBAR-eqInTypeExt at ind) ib
      where
        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí SUMeq (eqInType u w''' (eqta w''' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w''' (eqtb w''' e a‚ÇÅ a‚ÇÇ eqa)) w''' a b) e' w'' e''
                                 ‚Üí SUMeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ a‚ÇÇ eqa)) w'' a b)
        aw' w1 e1 h = SUMeq-ext {u} {w} {A1} {A2} {B1} {B2} {eqta} {eqtb} {_} {_} {_} {a} {b} exta extb h

        ib : inbar w' (Œª w'' e ‚Üí SUMeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e a‚ÇÅ a‚ÇÇ eqa)) w'' a b)
        ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' (‚Üëinbar eqi e')

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at =
      eqInType-‚áõ-SET-rev2
        u w' A B A1 A2 B1 B2 a b
        (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb)
        (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')
        (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z (<Type-EQTBAR-eqInTypeExt at ind) ib
      where
        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí SETeq (eqInType u w''' (eqta w''' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w''' (eqtb w''' e a‚ÇÅ a‚ÇÇ eqa)) a b) e' w'' e''
                                 ‚Üí SETeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ a‚ÇÇ eqa)) a b)
        aw' w1 e1 h = SETeq-ext {u} {w} {A1} {A2} {B1} {B2} {eqta} {eqtb} exta extb h

        ib : inbar w' (Œª w'' e ‚Üí SETeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e a‚ÇÅ a‚ÇÇ eqa)) a b)
        ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' (‚Üëinbar eqi e')

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqta exta eqt1 eqt2) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at =
      eqInType-‚áõ-EQ-rev2
        u w' A B A‚ÇÅ B‚ÇÅ a1 b1 a2 b2 a b
        (‚àÄùïé-mon e' eqta)
        (wPredExtIrr-eqInType-mon eqta exta w' e')
        (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z (<Type-EQTBAR-eqInTypeExt at ind) ib
      where
        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí EQeq a1 a2 (eqInType u w''' (eqta w''' e)) w''' a b) e' w'' e''
                                 ‚Üí EQeq a1 a2 (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b)
        aw' w1 e1 h = EQeq-ext {u} {w} {A‚ÇÅ} {B‚ÇÅ} {a1} {a2} {eqta} {_} {_} {_} {a} {b} exta h

        ib : inbar w' (Œª w'' e ‚Üí EQeq a1 a2 (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) w'' a b)
        ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' (‚Üëinbar eqi e')

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at =
      eqInType-‚áõ-UNION-rev2
        u w' A B A1 A2 B1 B2 a b
        (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb)
        (wPredExtIrr-eqInType-mon eqta exta w' e')
        (wPredExtIrr-eqInType-mon eqtb extb w' e')
        (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z (<Type-EQTBAR-eqInTypeExt at ind) ib
      where
        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí UNIONeq (eqInType u w''' (eqta w''' e)) (eqInType u w''' (eqtb w''' e)) w''' a b) e' w'' e''
                                 ‚Üí UNIONeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'')) w'' a b)
        aw' w1 e1 h = UNIONeq-ext {u} {w} {A1} {B1} {A2} {B2} {eqta} {eqtb} {_} {_} {_} {a} {b} exta extb h

        ib : inbar w' (Œª w'' e ‚Üí UNIONeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) (eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e)) w'' a b)
        ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' (‚Üëinbar eqi e')

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTSQUASH A1 A2 x x‚ÇÅ eqta exta) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at =
      eqInType-‚áõ-TSQUASH-rev2
        u w' A B A1 A2 a b
        (‚àÄùïé-mon e' eqta)
        (wPredExtIrr-eqInType-mon eqta exta w' e')
        (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z (<Type-EQTBAR-eqInTypeExt at ind) ib
      where
        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí TSQUASHeq (eqInType u w''' (eqta w''' e)) w''' a b) e' w'' e''
                                 ‚Üí TSQUASHeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b)
        aw' w1 e1 h = TSQUASHeq-ext {u} {w} {A1} {A2} {eqta} {_} {_} {_} {a} {b} exta h

        ib : inbar w' (Œª w'' e ‚Üí TSQUASHeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) w'' a b)
        ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' (‚Üëinbar eqi e')

--eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTDUM A1 A2 x x‚ÇÅ eqtA) eqi = {!!}
eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqta exta eqx) eqi =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at =
      eqInType-‚áõ-FFDEFS-rev2
        u w' A B A1 A2 x1 x2 a b
        (‚àÄùïé-mon e' eqta)
        (wPredExtIrr-eqInType-mon eqta exta w' e')
        (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z (<Type-EQTBAR-eqInTypeExt at ind) ib
      where
        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí FFDEFSeq x1 (eqInType u w''' (eqta w''' e)) w''' a b) e' w'' e''
                                 ‚Üí FFDEFSeq x1(eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b)
        aw' w1 e1 h = FFDEFSeq-ext {u} {w} {A1} {A2} {x1} {eqta} {_} {_} {_} {a} {b} exta h

        ib : inbar w' (Œª w'' e ‚Üí FFDEFSeq x1 (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) w'' a b)
        ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' (‚Üëinbar eqi e')

eqInType-ext-bar-rev {u} (n , isu) {w} {A} {B} i ind a b (EQTUNIV m p c‚ÇÅ c‚ÇÇ) eqi rewrite isu =
  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes (uni n) w' A B) (at : atbar i w' e' z) ‚Üí eqInType (uni n) w' z a b)
    aw w' e' z at = ei
      where
        ei : eqInType (uni n) w' z a b
        ei = eqInType-u p {w'} {A} {B} (‚áõ-mon e' c‚ÇÅ) (‚áõ-mon e' c‚ÇÇ) z a b (uniUpTo-mon {n} {m} {p} eqi w' e')

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTLIFT A1 A2 x x‚ÇÅ eqta) eqi = ?
{--  Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar i aw
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b)
    aw w' e' z at =
      eqInType-‚áõ-TSQUASH-rev2
        u w' A B A1 A2 a b
        (‚àÄùïé-mon e' eqta)
        (wPredExtIrr-eqInType-mon eqta exta w' e')
        (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) z (<Type-EQTBAR-eqInTypeExt at ind) ib
      where
        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí TSQUASHeq (eqInType u w''' (eqta w''' e)) w''' a b) e' w'' e''
                                 ‚Üí TSQUASHeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b)
        aw' w1 e1 h = TSQUASHeq-ext {u} {w} {A1} {A2} {eqta} {_} {_} {_} {a} {b} exta h

        ib : inbar w' (Œª w'' e ‚Üí TSQUASHeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) w'' a b)
        ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' (‚Üëinbar eqi e')
--}

eqInType-ext-bar-rev {u} isu {w} {A} {B} i ind a b (EQTBAR x) eqi =
  Bar.inBar'-change inOpenBar-Bar x i aw eqi
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (x‚ÇÅ y : eqTypes u w' A B) (at1 : atbar x w' e' x‚ÇÅ) (at2 : atbar i w' e' y)
                         ‚Üí eqInType u w' x‚ÇÅ a b
                         ‚Üí eqInType u w' y a b)
    aw w' e' x‚ÇÅ y at1 at2 eqi' = snd (ind y (<Type1 _ _ (<TypeBAR u w A B i w' e' y at2)) x‚ÇÅ a b) eqi'




eqInType-ext0 : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {A B : CTerm} (eqt : eqTypes u w A B)
                ‚Üí ({u' : univs} {w' : ùïé¬∑} {A' B' : CTerm} (eqt' : eqTypes u' w' A' B') ‚Üí <Type {u'} eqt' eqt ‚Üí eqInTypeExt eqt')
                ‚Üí eqInTypeExt eqt
eqInType-ext0 {u} isu {w} {A} {B} (EQTNAT x x‚ÇÅ) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-NAT-rev u w A B a b x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-NAT u w A B a b x x‚ÇÅ eqt2

eqInType-ext0 {u} isu {w} {A} {B} (EQTQNAT x x‚ÇÅ) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-QNAT-rev u w A B a b x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-QNAT u w A B a b x x‚ÇÅ eqt2

eqInType-ext0 {u} isu {w} {A} {B} (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-LT-rev u w A B a1 b1 a2 b2 a b x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-LT u w A B a1 b1 a2 b2 a b x x‚ÇÅ eqt2

eqInType-ext0 {u} isu {w} {A} {B} (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-QLT-rev u w A B a1 b1 a2 b2 a b x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-QLT u w A B a1 b1 a2 b2 a b x x‚ÇÅ eqt2

eqInType-ext0 {u} isu {w} {A} {B} (EQTFREE x x‚ÇÅ) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-FREE-rev u w A B a b x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-FREE u w A B a b x x‚ÇÅ eqt2

eqInType-ext0 {u} isu {w} {A} {B} (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-PI-rev u w A B A1 A2 B1 B2 a b eqta eqtb exta extb inda indb x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-PI u w A B A1 A2 B1 B2 a b eqta eqtb exta extb inda indb x x‚ÇÅ eqt2
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí eqInTypeExt (eqta w1 e1))
    inda w1 e1 = ind (eqta w1 e1) (<Type1 _ _ (<TypePIa u w A B A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb w1 e1))

    indb : ‚àÄùïé w (Œª w1 e1 ‚Üí (a1 a2 : CTerm) (ea : eqInType u w1 (eqta w1 e1) a1 a2) ‚Üí eqInTypeExt (eqtb w1 e1 a1 a2 ea))
    indb w1 e1 a‚ÇÅ a‚ÇÇ eqa = ind (eqtb w1 e1 a‚ÇÅ a‚ÇÇ eqa) (<Type1 _ _ (<TypePIb u w A B A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb w1 e1 a‚ÇÅ a‚ÇÇ eqa))

eqInType-ext0 {u} isu {w} {A} {B} (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-SUM-rev u w A B A1 A2 B1 B2 a b eqta eqtb exta extb inda indb x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-SUM u w A B A1 A2 B1 B2 a b eqta eqtb exta extb inda indb x x‚ÇÅ eqt2
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí eqInTypeExt (eqta w1 e1))
    inda w1 e1 = ind (eqta w1 e1) (<Type1 _ _ (<TypeSUMa u w A B A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb w1 e1))

    indb : ‚àÄùïé w (Œª w1 e1 ‚Üí (a1 a2 : CTerm) (ea : eqInType u w1 (eqta w1 e1) a1 a2) ‚Üí eqInTypeExt (eqtb w1 e1 a1 a2 ea))
    indb w1 e1 a‚ÇÅ a‚ÇÇ eqa = ind (eqtb w1 e1 a‚ÇÅ a‚ÇÇ eqa) (<Type1 _ _ (<TypeSUMb u w A B A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb w1 e1 a‚ÇÅ a‚ÇÇ eqa))

eqInType-ext0 {u} isu {w} {A} {B} (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-SET-rev u w A B A1 A2 B1 B2 a b eqta eqtb exta extb inda indb x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-SET u w A B A1 A2 B1 B2 a b eqta eqtb exta extb inda indb x x‚ÇÅ eqt2
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí eqInTypeExt (eqta w1 e1))
    inda w1 e1 = ind (eqta w1 e1) (<Type1 _ _ (<TypeSETa u w A B A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb w1 e1))

    indb : ‚àÄùïé w (Œª w1 e1 ‚Üí (a1 a2 : CTerm) (ea : eqInType u w1 (eqta w1 e1) a1 a2) ‚Üí eqInTypeExt (eqtb w1 e1 a1 a2 ea))
    indb w1 e1 a‚ÇÅ a‚ÇÇ eqa = ind (eqtb w1 e1 a‚ÇÅ a‚ÇÇ eqa) (<Type1 _ _ (<TypeSETb u w A B A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb w1 e1 a‚ÇÅ a‚ÇÇ eqa))

eqInType-ext0 {u} isu {w} {A} {B} (EQTEQ a1 b1 a2 b2 A1 B1 x x‚ÇÅ eqta exta eqt1 eqt2) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-EQ-rev u w A B A1 B1 a1 b1 a2 b2 a b eqta exta inda x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-EQ u w A B A1 B1 a1 b1 a2 b2 a b eqta exta inda x x‚ÇÅ eqt2
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí eqInTypeExt (eqta w1 e1))
    inda w1 e1 = ind (eqta w1 e1) (<Type1 _ _ (<TypeEQ u w A B a1 b1 a2 b2 A1 B1 x x‚ÇÅ eqta exta eqt1 eqt2 w1 e1))

eqInType-ext0 {u} isu {w} {A} {B} (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-UNION-rev u w A B A1 A2 B1 B2 a b eqta eqtb exta extb inda indb x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-UNION u w A B A1 A2 B1 B2 a b eqta eqtb exta extb inda indb x x‚ÇÅ eqt2
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí eqInTypeExt (eqta w1 e1))
    inda w1 e1 = ind (eqta w1 e1) (<Type1 _ _ (<TypeUNIONl u w A B A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb w1 e1))

    indb : ‚àÄùïé w (Œª w1 e1 ‚Üí eqInTypeExt (eqtb w1 e1))
    indb w1 e1 = ind (eqtb w1 e1) (<Type1 _ _ (<TypeUNIONr u w A B A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb w1 e1))

eqInType-ext0 {u} isu {w} {A} {B} (EQTSQUASH A1 A2 x x‚ÇÅ eqta exta) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-TSQUASH-rev u w A B A1 A2 a b eqta exta inda x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-TSQUASH u w A B A1 A2 a b eqta exta inda x x‚ÇÅ eqt2
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí eqInTypeExt (eqta w1 e1))
    inda w1 e1 = ind (eqta w1 e1) (<Type1 _ _ (<TypeSQUASH u w A B A1 A2 x x‚ÇÅ eqta exta w1 e1))

--eqInType-ext0 {u} isu {w} {A} {B} (EQTDUM A1 A2 x x‚ÇÅ eqta) ind = {!!}
eqInType-ext0 {u} isu {w} {A} {B} (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqta exta eqx) ind =
  Œª eqt2 a b ‚Üí eqInType-‚áõ-FFDEFS-rev u w A B A1 A2 x1 x2 a b eqta exta inda x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-FFDEFS u w A B A1 A2 x1 x2 a b eqta exta inda x x‚ÇÅ eqt2
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí eqInTypeExt (eqta w1 e1))
    inda w1 e1 = ind (eqta w1 e1) (<Type1 _ _ (<TypeFFDEFS u w A B A1 A2 x1 x2 x x‚ÇÅ eqta exta eqx w1 e1))

eqInType-ext0 {u} isu {w} {A} {B} (EQTLIFT A1 A2 x x‚ÇÅ eqta) ind = ?
{--  Œª eqt2 a b ‚Üí eqInType-‚áõ-TSQUASH-rev u w A B A1 A2 a b eqta exta inda x x‚ÇÅ eqt2 ,
                eqInType-‚áõ-TSQUASH u w A B A1 A2 a b eqta exta inda x x‚ÇÅ eqt2
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí eqInTypeExt (eqta w1 e1))
    inda w1 e1 = ind (eqta w1 e1) (<Type1 _ _ (<TypeSQUASH w A B A1 A2 x x‚ÇÅ eqta exta w1 e1))--}

eqInType-ext0 {u} (n , isu) {w} {A} {B} (EQTUNIV m p c‚ÇÅ c‚ÇÇ) ind rewrite isu = eqInTypeExt-EQTUNIV m p c‚ÇÅ c‚ÇÇ
eqInType-ext0 {u} isu {w} {A} {B} (EQTBAR x) ind =
  Œª eqt' a b ‚Üí (Œª ei ‚Üí eqInType-ext-bar {u} isu x ind a b ei eqt') ,
                (Œª ei ‚Üí eqInType-ext-bar-rev {u} isu x ind a b eqt' ei)



eqInType-ext : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {A B : CTerm} (eqt : eqTypes u w A B) ‚Üí eqInTypeExt eqt
eqInType-ext {u} isu {w} {A} {B} eqt = ind<Type eqInTypeExt (eqInType-ext0 isu) eqt




is-uni‚ÜíeqTypes : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {A B : CTerm}
                  (eqt : eqTypes u w A B)
                  ‚Üí eqTypes (uni (fst isu)) w A B
is-uni‚ÜíeqTypes {u} (n , isu) {w} {A} {B} eqt rewrite isu = eqt




is-uni‚ÜíeqInType : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {A B : CTerm} {a b : CTerm}
                   (eqt : eqTypes u w A B)
                   (eqi : eqInType u w eqt a b)
                   ‚Üí Œ£ (eqTypes (uni (fst isu)) w A B) (Œª z ‚Üí eqInType (uni (fst isu)) w z a b)
is-uni‚ÜíeqInType {u} (n , isu) {w} {A} {B} {a} {b} eqt eqi rewrite isu = eqt , eqi




is-uni-eqInType‚Üí : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {A B : CTerm} {a b : CTerm}
                    (eqt : eqTypes (uni (fst isu)) w A B)
                    (eqi : eqInType (uni (fst isu)) w eqt a b)
                    (eqt' : eqTypes u w A B)
                    ‚Üí eqInType u w eqt' a b
is-uni-eqInType‚Üí {u} (n , isu) {w} {A} {B} {a} {b} eqt eqi eqt' rewrite isu =
  fst (eqInType-ext {uni n} (is-uni-uni n) eqt eqt' a b) eqi





wPredDepExtIrr-eqInType-if-inbar : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {A B a b : CTerm}
                                   (x : inbar w (Œª w' _ ‚Üí eqTypes u w' A B))
                                   ‚Üí wpreddepextirr (Œª w1 e1 z ‚Üí eqInType u w1 z a b) x
wPredDepExtIrr-eqInType-if-inbar {u} isu {w} {A} {B} {a} {b} x w0 w1 w2 e0 e1 e2 e0' e1' e2' q =
  fst (eqInType-ext {u} isu {w2} {A} {B} (snd (snd (x w0 e0)) w2 e0' e2') (snd (snd (x w1 e1)) w2 e1' e2) a b) q




local-eqInType : (u : univs) (w : ùïé¬∑) (A B a b : CTerm)
                 ‚Üí (i : inbar w (Œª w' e ‚Üí eqTypes u w' A B))
                 ‚Üí inbar' w i (Œª w' e z ‚Üí eqInType u w' z a b)
                 ‚Üí Œ£ (eqTypes u w A B) (Œª eqt ‚Üí eqInType u w eqt a b)
local-eqInType u w A B a b i j = EQTBAR i , j




local-eqInType2 : (u : univs) (isu : is-uni u) (w : ùïé¬∑) (A B a b : CTerm)
                  ‚Üí (eqt : eqTypes u w A B)
                  ‚Üí (i : inbar w (Œª w' e ‚Üí eqTypes u w' A B))
                  ‚Üí inbar' w i (Œª w' e z ‚Üí eqInType u w' z a b)
                  ‚Üí eqInType u w eqt a b
{-# TERMINATING #-}
local-eqInType2 u isu w A B a b (EQTNAT x x‚ÇÅ) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b ‚Üí inbar w' (Œª w1 e1 ‚Üí w ‚äë¬∑ w1 ‚Üí #strongMonEq w1 a b))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 s x ‚Üí s) h1
      where
        h1 : eqInType u w' {A} {B} (EQTNAT (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ)) a b
        h1 = fst (eqInType-ext isu z (EQTNAT (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ)) a b) ei

local-eqInType2 u isu w A B a b (EQTQNAT x x‚ÇÅ) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b ‚Üí inbar w' (Œª w1 e1 ‚Üí w ‚äë¬∑ w1 ‚Üí #weakMonEq w1 a b))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 s x ‚Üí s) h1
      where
        h1 : eqInType u w' {A} {B} (EQTQNAT (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ)) a b
        h1 = fst (eqInType-ext isu z (EQTQNAT (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ)) a b) ei

local-eqInType2 u isu w A B a b (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b ‚Üí inbar w' (Œª w1 e1 ‚Üí w ‚äë¬∑ w1 ‚Üí #lift-<NUM-pair w1 a1 b1))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 s x ‚Üí s) h1
      where
        h1 : eqInType u w' {A} {B} (EQTLT a1 a2 b1 b2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (#strongMonEq-mon {a1} {a2} x‚ÇÇ w' e') (#strongMonEq-mon {b1} {b2} x‚ÇÉ w' e')) a b
        h1 = fst (eqInType-ext isu z (EQTLT a1 a2 b1 b2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (#strongMonEq-mon {a1} {a2} x‚ÇÇ w' e') (#strongMonEq-mon {b1} {b2} x‚ÇÉ w' e')) a b) ei

local-eqInType2 u isu w A B a b (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b ‚Üí inbar w' (Œª w1 e1 ‚Üí w ‚äë¬∑ w1 ‚Üí #lift-<NUM-pair w1 a1 b1))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 s x ‚Üí s) h1
      where
        h1 : eqInType u w' {A} {B} (EQTQLT a1 a2 b1 b2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (#weakMonEq-mon {a1} {a2} x‚ÇÇ w' e') (#weakMonEq-mon {b1} {b2} x‚ÇÉ w' e')) a b
        h1 = fst (eqInType-ext isu z (EQTQLT a1 a2 b1 b2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (#weakMonEq-mon {a1} {a2} x‚ÇÇ w' e') (#weakMonEq-mon {b1} {b2} x‚ÇÉ w' e')) a b) ei

local-eqInType2 u isu w A B a b (EQTFREE x x‚ÇÅ) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z) ‚Üí eqInType u w' z a b ‚Üí inbar w' (Œª w1 e1 ‚Üí w ‚äë¬∑ w1 ‚Üí #‚áõto-same-CS w1 a b))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 s x ‚Üí s) h1
      where
        h1 : eqInType u w' {A} {B} (EQTFREE (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ)) a b
        h1 = fst (eqInType-ext isu z (EQTFREE (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ)) a b) ei

local-eqInType2 u isu w A B a b (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z)
                         ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (Œª w1 e1 ‚Üí (x : w ‚äë¬∑ w1) ‚Üí PIeq (eqInType u w1 (eqta w1 x)) (Œª a1 a2 eqa ‚Üí eqInType u w1 (eqtb w1 x a1 a2 eqa)) a b))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' h1
      where
        h1 : eqInType u w' {A} {B} (EQTPI A1 B1 A2 B2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb) (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')) a b
        h1 = fst (eqInType-ext isu z (EQTPI A1 B1 A2 B2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb) (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')) a b) ei

        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí PIeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ b‚ÇÅ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ b‚ÇÅ eqa)) a b
                                 ‚Üí (x‚ÇÇ : w ‚äë¬∑ w'') ‚Üí PIeq (eqInType u w'' (eqta w'' x‚ÇÇ)) (Œª a1 a2 eqa ‚Üí eqInType u w'' (eqtb w'' x‚ÇÇ a1 a2 eqa)) a b)
        aw' w1 e1 h x‚ÇÇ = PIeq-ext {u} {w} {A1} {A2} {B1} {B2} {eqta} {eqtb} {_} {_} {a} {b} exta extb h

local-eqInType2 u isu w A B a b (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z)
                         ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (Œª w1 e1 ‚Üí (x : w ‚äë¬∑ w1) ‚Üí SUMeq (eqInType u w1 (eqta w1 x)) (Œª a1 a2 eqa ‚Üí eqInType u w1 (eqtb w1 x a1 a2 eqa)) w1 a b))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' h1
      where
        h1 : eqInType u w' {A} {B} (EQTSUM A1 B1 A2 B2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb) (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')) a b
        h1 = fst (eqInType-ext isu z (EQTSUM A1 B1 A2 B2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb) (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')) a b) ei

        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí SUMeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ b‚ÇÅ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ b‚ÇÅ eqa)) w'' a b
                                 ‚Üí (x‚ÇÇ : w ‚äë¬∑ w'') ‚Üí SUMeq (eqInType u w'' (eqta w'' x‚ÇÇ)) (Œª a1 a2 eqa ‚Üí eqInType u w'' (eqtb w'' x‚ÇÇ a1 a2 eqa)) w'' a b)
        aw' w1 e1 h x‚ÇÇ = SUMeq-ext {u} {w} {A1} {A2} {B1} {B2} {eqta} {eqtb} {_} {_} {_} {a} {b} exta extb h

local-eqInType2 u isu w A B a b (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z)
                         ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (Œª w1 e1 ‚Üí (x : w ‚äë¬∑ w1) ‚Üí SETeq (eqInType u w1 (eqta w1 x)) (Œª a1 a2 eqa ‚Üí eqInType u w1 (eqtb w1 x a1 a2 eqa)) a b))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' h1
      where
        h1 : eqInType u w' {A} {B} (EQTSET A1 B1 A2 B2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb) (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')) a b
        h1 = fst (eqInType-ext isu z (EQTSET A1 B1 A2 B2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb) (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')) a b) ei

        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí SETeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ b‚ÇÅ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ b‚ÇÅ eqa)) a b
                                 ‚Üí (x‚ÇÇ : w ‚äë¬∑ w'') ‚Üí SETeq (eqInType u w'' (eqta w'' x‚ÇÇ)) (Œª a1 a2 eqa ‚Üí eqInType u w'' (eqtb w'' x‚ÇÇ a1 a2 eqa)) a b)
        aw' w1 e1 h x‚ÇÇ = SETeq-ext {u} {w} {A1} {A2} {B1} {B2} {eqta} {eqtb} {_} {_} {_} {a} {b} exta extb h

local-eqInType2 u isu w A B a b (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqta exta eqt1 eqt2) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z)
                         ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (Œª w1 e1 ‚Üí (x : w ‚äë¬∑ w1) ‚Üí EQeq a1 a2 (eqInType u w1 (eqta w1 x)) w1 a b))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' h1
      where
        h1 : eqInType u w' {A} {B} (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (wPredExtIrr-eqInType-mon eqta exta w' e') (‚àÄùïé-mon e' eqt1) (‚àÄùïé-mon e' eqt2)) a b
        h1 = fst (eqInType-ext isu z (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (wPredExtIrr-eqInType-mon eqta exta w' e') (‚àÄùïé-mon e' eqt1) (‚àÄùïé-mon e' eqt2)) a b) ei

        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí EQeq a1 a2 (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b
                                 ‚Üí (x‚ÇÇ : w ‚äë¬∑ w'') ‚Üí EQeq a1 a2 (eqInType u w'' (eqta w'' x‚ÇÇ)) w'' a b)
        aw' w1 e1 h x‚ÇÇ = EQeq-ext {u} {w} {A‚ÇÅ} {B‚ÇÅ} {a1} {a2} {eqta} {_} {_} {_} {a} {b} exta h

local-eqInType2 u isu w A B a b (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z)
                         ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (Œª w1 e1 ‚Üí (x : w ‚äë¬∑ w1) ‚Üí UNIONeq (eqInType u w1 (eqta w1 x)) (eqInType u w1 (eqtb w1 x)) w1 a b))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' h1
      where
        h1 : eqInType u w' {A} {B} (EQTUNION A1 B1 A2 B2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb) (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredExtIrr-eqInType-mon eqtb extb w' e')) a b
        h1 = fst (eqInType-ext isu z (EQTUNION A1 B1 A2 B2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb) (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredExtIrr-eqInType-mon eqtb extb w' e')) a b) ei

        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí UNIONeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'')) w'' a b
                                 ‚Üí (x‚ÇÇ : w ‚äë¬∑ w'') ‚Üí UNIONeq (eqInType u w'' (eqta w'' x‚ÇÇ)) (eqInType u w'' (eqtb w'' x‚ÇÇ)) w'' a b)
        aw' w1 e1 h x‚ÇÇ = UNIONeq-ext {u} {w} {A1} {B1} {A2} {B2} {eqta} {eqtb} {_} {_} {_} {a} {b} exta extb h

local-eqInType2 u isu w A B a b (EQTSQUASH A1 A2 x x‚ÇÅ eqta exta) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z)
                         ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (Œª w1 e1 ‚Üí (x : w ‚äë¬∑ w1) ‚Üí TSQUASHeq (eqInType u w1 (eqta w1 x)) w1 a b))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' h1
      where
        h1 : eqInType u w' {A} {B} (EQTSQUASH A1 A2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (wPredExtIrr-eqInType-mon eqta exta w' e')) a b
        h1 = fst (eqInType-ext isu z (EQTSQUASH A1 A2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (wPredExtIrr-eqInType-mon eqta exta w' e')) a b) ei

        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí TSQUASHeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b
                                 ‚Üí (x‚ÇÇ : w ‚äë¬∑ w'') ‚Üí TSQUASHeq (eqInType u w'' (eqta w'' x‚ÇÇ)) w'' a b)
        aw' w1 e1 h x‚ÇÇ = TSQUASHeq-ext {u} {w} {A1} {A2} {eqta} {_} {_} {_} {a} {b} exta h

--local-eqInType2 u isu w A B a b (EQTDUM A1 A2 x x‚ÇÅ eqta) i j = lift tt
local-eqInType2 u isu w A B a b (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqta exta eqx) i j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z)
                         ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (Œª w1 e1 ‚Üí (x : w ‚äë¬∑ w1) ‚Üí FFDEFSeq x1 (eqInType u w1 (eqta w1 x)) w1 a b))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' h1
      where
        h1 : eqInType u w' {A} {B} (EQFFDEFS A1 A2 x1 x2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (wPredExtIrr-eqInType-mon eqta exta w' e') (‚àÄùïé-mon e' eqx)) a b
        h1 = fst (eqInType-ext isu z (EQFFDEFS A1 A2 x1 x2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (wPredExtIrr-eqInType-mon eqta exta w' e') (‚àÄùïé-mon e' eqx)) a b) ei

        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí FFDEFSeq x1 (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b
                                 ‚Üí (x‚ÇÇ : w ‚äë¬∑ w'') ‚Üí FFDEFSeq x1 (eqInType u w'' (eqta w'' x‚ÇÇ)) w'' a b)
        aw' w1 e1 h x‚ÇÇ = FFDEFSeq-ext {u} {w} {A1} {A2} {x1} {eqta} {_} {_} {_} {a} {b} exta h

local-eqInType2 u (n , isu) w A B a b (EQTUNIV m p c‚ÇÅ c‚ÇÇ) i j rewrite isu =
  inbarEqTypes‚ÜíuniUpTo
    {m} {n} {p} {w} {a} {b}
    (Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j))
    where
      aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes (uni n) w' A B) ‚Üí atbar i w' e' z
                          ‚Üí eqInType (uni n) w' z a b
                          ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí eqTypes (uni m) w'' a b) e'))
      aw w' e' z at eqi =
        Bar.‚àÄùïé-inBarFunc inOpenBar-Bar
          (Œª w1 e1 et z ‚Üí et)
          (uniUpTo‚ÜíinbarEqTypes {m} {n} {p} {w'} {a} {b} (eqInType-u-rev p (‚áõ-mon e' c‚ÇÅ) (‚áõ-mon e' c‚ÇÇ) z a b eqi))

local-eqInType2 u isu w A B a b (EQTLIFT A1 A2 x x‚ÇÅ eqta) i j = ?
{--  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar i aw j)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar i w' e' z)
                         ‚Üí eqInType u w' z a b
                         ‚Üí inbar w' (Œª w1 e1 ‚Üí (x : w ‚äë¬∑ w1) ‚Üí TSQUASHeq (eqInType u w1 (eqta w1 x)) w1 a b))
    aw w' e' z at ei = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw' h1
      where
        h1 : eqInType u w' {A} {B} (EQTSQUASH A1 A2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (wPredExtIrr-eqInType-mon eqta exta w' e')) a b
        h1 = fst (eqInType-ext isu z (EQTSQUASH A1 A2 (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) (‚àÄùïé-mon e' eqta) (wPredExtIrr-eqInType-mon eqta exta w' e')) a b) ei

        aw' : ‚àÄùïé w' (Œª w'' e'' ‚Üí TSQUASHeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b
                                 ‚Üí (x‚ÇÇ : w ‚äë¬∑ w'') ‚Üí TSQUASHeq (eqInType u w'' (eqta w'' x‚ÇÇ)) w'' a b)
        aw' w1 e1 h x‚ÇÇ = TSQUASHeq-ext {u} {w} {A1} {A2} {eqta} {_} {_} {_} {a} {b} exta h--}

local-eqInType2 u isu w A B a b (EQTBAR x) i j =
  Bar.inBar'-change inOpenBar-Bar i x aw j
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (x‚ÇÅ y : eqTypes u w' A B) ‚Üí atbar i w' e' x‚ÇÅ ‚Üí atbar x w' e' y
                         ‚Üí eqInType u w' x‚ÇÅ a b
                         ‚Üí eqInType u w' y a b)
    aw w' e' x‚ÇÅ x‚ÇÇ at‚ÇÅ at‚ÇÇ eqi = proj‚ÇÅ (eqInType-ext isu x‚ÇÅ x‚ÇÇ a b) eqi





{--
local-eqInType3 : (u : univs) (isu : is-universe u) (w : ùïé¬∑) (A B a b : CTerm)
                  ‚Üí (i : inbar w (Œª w' e ‚Üí eqTypes u w' A B))
                  ‚Üí inbar' w i (Œª w' e z ‚Üí eqInType u w' z a b)
--                  ‚Üí inbar' w i (Œª w' e ‚Üí TSP)
                  ‚Üí (eqt : eqTypes u w A B)
                  ‚Üí eqInType u w eqt a b √ó eqInTypeExt eqt
local-eqInType3 u isu w A B a b i j (EQTNAT x x‚ÇÅ) =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar aw i j) ,
  (Œª eqt2 a b ‚Üí eqInType-‚áõ-NAT-rev u isu w A B a b x x‚ÇÅ eqt2 , eqInType-‚áõ-NAT u isu w A B a b x x‚ÇÅ eqt2)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí (x‚ÇÇ : eqTypes u w' A B)
                         ‚Üí eqInType u w' x‚ÇÇ a b
                         ‚Üí inbar w' (‚ÜëwPred' (Œª w'' e ‚Üí strongMonEq w'' a b) e'))
    aw w' e' x‚ÇÇ eqt' = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 z k ‚Üí z) aw'
      where
        aw' : inbar w' (Œª w'' _ ‚Üí strongMonEq w'' a b)
        aw' = eqInType-‚áõ-NAT u isu w' A B a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) x‚ÇÇ eqt'
local-eqInType3 u isu w A B a b i j (EQTQNAT x x‚ÇÅ) = {!!}
local-eqInType3 u isu w A B a b i j (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = {!!}
local-eqInType3 u isu w A B a b i j (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = {!!}
local-eqInType3 u isu w A B a b i j (EQTFREE x x‚ÇÅ) = {!!}
local-eqInType3 u isu w A B a b i j (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) = {!!}
local-eqInType3 u isu w A B a b i j (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) = {!!}
local-eqInType3 u isu w A B a b i j (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) = {!!}
local-eqInType3 u isu w A B a b i j (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) = {!!}
local-eqInType3 u isu w A B a b i j (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) = {!!}
local-eqInType3 u isu w A B a b i j (EQTSQUASH A1 A2 x x‚ÇÅ eqtA) = {!!}
local-eqInType3 u isu w A B a b i j (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA eqx) = {!!}
local-eqInType3 u isu w A B a b i j (EQTUNIV x) = {!!}
local-eqInType3 u isu w A B a b i j (EQTBAR x) = {!!}
--}


TSP-change : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {A B : CTerm}
             (eqt1 eqt2 : eqTypes u w A B)
             ‚Üí TSP eqt1
             ‚Üí TSP eqt2
TSP-change {u} isu {w} {A} {B} eqt1 eqt2 tsp =
  mktsp (TSP.tsym tsp) ttrans isym itrans iextl1 iextl2 iextr1 iextr2 iextrevl1 iextrevl2 iextrevr1 iextrevr2 local
  where
    ttrans : eqTypesTrans u w A B
    ttrans C eqt = TSP.ttrans tsp C eqt

    isym : eqInTypeSym u eqt2
    isym a b eqi = fst (eqInType-ext isu eqt1 eqt2 b a) (TSP.isym tsp a b (fst (eqInType-ext isu eqt2 eqt1 a b) eqi))

    itrans : eqInTypeTrans u eqt2
    itrans a b c eqi1 eqi2 = proj‚ÇÅ (eqInType-ext isu eqt1 eqt2 a c) (TSP.itrans tsp a b c (fst (eqInType-ext isu eqt2 eqt1 a b) eqi1) (fst (eqInType-ext isu eqt2 eqt1 b c) eqi2))

    iextl1 : eqInTypeExtL1 eqt2
    iextl1 C eqt' a b eqi = TSP.extl1 tsp C eqt' a b (fst (eqInType-ext isu eqt2 eqt1 a b) eqi)

    iextl2 : eqInTypeExtL2 eqt2
    iextl2 C eqt' a b eqi = TSP.extl2 tsp C eqt' a b (fst (eqInType-ext isu eqt2 eqt1 a b) eqi)

    iextr1 : eqInTypeExtR1 eqt2
    iextr1 C eqt' a b eqi = TSP.extr1 tsp C eqt' a b (fst (eqInType-ext isu eqt2 eqt1 a b) eqi)

    iextr2 : eqInTypeExtR2 eqt2
    iextr2 C eqt' a b eqi = TSP.extr2 tsp C eqt' a b (fst (eqInType-ext isu eqt2 eqt1 a b) eqi)

    iextrevl1 : eqInTypeExtRevL1 eqt2
    iextrevl1 C eqt' a b eqi = fst (eqInType-ext isu eqt1 eqt2 a b) (TSP.extrevl1 tsp C eqt' a b eqi)

    iextrevl2 : eqInTypeExtRevL2 eqt2
    iextrevl2 C eqt' a b eqi = fst (eqInType-ext isu eqt1 eqt2 a b) (TSP.extrevl2 tsp C eqt' a b eqi)

    iextrevr1 : eqInTypeExtRevR1 eqt2
    iextrevr1 C eqt' a b eqi = fst (eqInType-ext isu eqt1 eqt2 a b) (TSP.extrevr1 tsp C eqt' a b eqi)

    iextrevr2 : eqInTypeExtRevR2 eqt2
    iextrevr2 C eqt' a b eqi = fst (eqInType-ext isu eqt1 eqt2 a b) (TSP.extrevr2 tsp C eqt' a b eqi)

    local : eqInTypeLocal eqt2
    local a b i j = proj‚ÇÅ (eqInType-ext isu eqt1 eqt2 a b) (TSP.local tsp a b i j)




eqInType-mon : {u : univs} (isu : is-uni u) {w : ùïé¬∑} {A B : CTerm}
               {w' : ùïé¬∑} (e' : w ‚äë¬∑ w')
               (eqt1 : eqTypes u w A B)
               (eqt2 : eqTypes u w' A B)
               (a b : CTerm)
               (eqi  : eqInType u w eqt1 a b)
               ‚Üí eqInType u w' eqt2 a b
{-# TERMINATING #-}
eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTNAT x x‚ÇÅ) eqt2 a b eqi =
  eqInType-‚áõ-NAT-rev u w' A B a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 ei
  where
    ei : inbar w' (Œª w'' e ‚Üí #strongMonEq w'' a b)
    ei = ‚Üëinbar eqi e'

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTQNAT x x‚ÇÅ) eqt2 a b eqi =
  eqInType-‚áõ-QNAT-rev u w' A B a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 ei
  where
    ei : inbar w' (Œª w'' e ‚Üí #weakMonEq w'' a b)
    ei = ‚Üëinbar eqi e'

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) eqt2 a b eqi =
  eqInType-‚áõ-LT-rev u w' A B a1 b1 a2 b2 a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 ei
  where
    ei : inbar w' (Œª w'' e ‚Üí #lift-<NUM-pair w'' a1 b1)
    ei = ‚Üëinbar eqi e'

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) eqt2 a b eqi =
  eqInType-‚áõ-QLT-rev u w' A B a1 b1 a2 b2 a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 ei
  where
    ei : inbar w' (Œª w'' e ‚Üí #lift-<NUM-pair w'' a1 b1)
    ei = ‚Üëinbar eqi e'

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTFREE x x‚ÇÅ) eqt2 a b eqi =
  eqInType-‚áõ-FREE-rev u w' A B a b (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 ei
  where
    ei : inbar w' (Œª w'' e ‚Üí #‚áõto-same-CS w'' a b)
    ei = ‚Üëinbar eqi e'

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqt2 a b eqi =
  eqInType-‚áõ-PI-rev2
    u w' A B A1 A2 B1 B2 a b
    (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb)
    (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')
    (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 (Œª eqt' lety ‚Üí eqInType-ext isu eqt') ib
  where
    aw : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí PIeq (eqInType u w''' (eqta w''' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w''' (eqtb w''' e a‚ÇÅ a‚ÇÇ eqa)) a b) e' w'' e''
                            ‚Üí PIeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ a‚ÇÇ eqa)) a b)
    aw w1 e1 h = PIeq-ext {u} {w} {A1} {A2} {B1} {B2} {eqta} {eqtb} {_} {_} {_} {a} {b} exta extb h

    ib : inbar w' (Œª w'' e ‚Üí PIeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e a‚ÇÅ a‚ÇÇ eqa)) a b)
    ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw (‚Üëinbar eqi e')

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqt2 a b eqi =
  eqInType-‚áõ-SUM-rev2
    u w' A B A1 A2 B1 B2 a b
    (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb)
    (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')
    (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 (Œª eqt' lety ‚Üí eqInType-ext isu eqt') ib
  where
    aw : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí SUMeq (eqInType u w''' (eqta w''' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w''' (eqtb w''' e a‚ÇÅ a‚ÇÇ eqa)) w''' a b) e' w'' e''
                            ‚Üí SUMeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ a‚ÇÇ eqa)) w'' a b)
    aw w1 e1 h = SUMeq-ext {u} {w} {A1} {A2} {B1} {B2} {eqta} {eqtb} {_} {_} {_} {a} {b} exta extb h

    ib : inbar w' (Œª w'' e ‚Üí SUMeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e a‚ÇÅ a‚ÇÇ eqa)) w'' a b)
    ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw (‚Üëinbar eqi e')

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqt2 a b eqi =
  eqInType-‚áõ-SET-rev2
    u w' A B A1 A2 B1 B2 a b
    (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb)
    (wPredExtIrr-eqInType-mon eqta exta w' e') (wPredDepExtIrr-eqInType-mon {u} {w} {A1} {A2} {B1} {B2} eqta eqtb extb w' e')
    (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 (Œª eqt' lety ‚Üí eqInType-ext isu eqt') ib
  where
    aw : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí SETeq (eqInType u w''' (eqta w''' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w''' (eqtb w''' e a‚ÇÅ a‚ÇÇ eqa)) a b) e' w'' e''
                            ‚Üí SETeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'' a‚ÇÅ a‚ÇÇ eqa)) a b)
    aw w1 e1 h = SETeq-ext {u} {w} {A1} {A2} {B1} {B2} {eqta} {eqtb} exta extb h

    ib : inbar w' (Œª w'' e ‚Üí SETeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) (Œª a‚ÇÅ a‚ÇÇ eqa ‚Üí eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e a‚ÇÅ a‚ÇÇ eqa)) a b)
    ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw (‚Üëinbar eqi e')

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqta exta eqt1 eqt3) eqt2 a b eqi =
  eqInType-‚áõ-EQ-rev2
    u w' A B A‚ÇÅ B‚ÇÅ a1 b1 a2 b2 a b
    (‚àÄùïé-mon e' eqta)
    (wPredExtIrr-eqInType-mon eqta exta w' e')
    (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 (Œª eqt' lety ‚Üí eqInType-ext isu eqt') ib
  where
    aw : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí EQeq a1 a2 (eqInType u w''' (eqta w''' e)) w''' a b) e' w'' e''
                            ‚Üí EQeq a1 a2 (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b)
    aw w1 e1 h = EQeq-ext {u} {w} {A‚ÇÅ} {B‚ÇÅ} {a1} {a2} {eqta} {_} {_} {_} {a} {b} exta h

    ib : inbar w' (Œª w'' e ‚Üí EQeq a1 a2 (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) w'' a b)
    ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw (‚Üëinbar eqi e')

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) eqt2 a b eqi =
  eqInType-‚áõ-UNION-rev2
    u w' A B A1 A2 B1 B2 a b
    (‚àÄùïé-mon e' eqta) (‚àÄùïé-mon e' eqtb)
    (wPredExtIrr-eqInType-mon eqta exta w' e')
    (wPredExtIrr-eqInType-mon eqtb extb w' e')
    (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 (Œª eqt' lety ‚Üí eqInType-ext isu eqt') ib
  where
    aw : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí UNIONeq (eqInType u w''' (eqta w''' e)) (eqInType u w''' (eqtb w''' e)) w''' a b) e' w'' e''
                            ‚Üí UNIONeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) (eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e'')) w'' a b)
    aw w1 e1 h = UNIONeq-ext {u} {w} {A1} {B1} {A2} {B2} {eqta} {eqtb} {_} {_} {_} {a} {b} exta extb h

    ib : inbar w' (Œª w'' e ‚Üí UNIONeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) (eqInType u w'' (‚àÄùïé-mon e' eqtb w'' e)) w'' a b)
    ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw (‚Üëinbar eqi e')

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTSQUASH A1 A2 x x‚ÇÅ eqta exta) eqt2 a b eqi =
  eqInType-‚áõ-TSQUASH-rev2
    u w' A B A1 A2 a b
    (‚àÄùïé-mon e' eqta)
    (wPredExtIrr-eqInType-mon eqta exta w' e')
    (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 (Œª eqt' lety ‚Üí eqInType-ext isu eqt') ib
  where
    aw : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí TSQUASHeq (eqInType u w''' (eqta w''' e)) w''' a b) e' w'' e''
                            ‚Üí TSQUASHeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b)
    aw w1 e1 h = TSQUASHeq-ext {u} {w} {A1} {A2} {eqta} {_} {_} {_} {a} {b} exta h

    ib : inbar w' (Œª w'' e ‚Üí TSQUASHeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) w'' a b)
    ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw (‚Üëinbar eqi e')

--eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTDUM A1 A2 x x‚ÇÅ eqta) eqt2 a b eqi = {!!}
eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqta exta eqx) eqt2 a b eqi =
  eqInType-‚áõ-FFDEFS-rev2
    u w' A B A1 A2 x1 x2 a b
    (‚àÄùïé-mon e' eqta)
    (wPredExtIrr-eqInType-mon eqta exta w' e')
    (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 (Œª eqt' lety ‚Üí eqInType-ext isu eqt') ib
  where
    aw : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí FFDEFSeq x1 (eqInType u w''' (eqta w''' e)) w''' a b) e' w'' e''
                            ‚Üí FFDEFSeq x1 (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b)
    aw w1 e1 h = FFDEFSeq-ext {u} {w} {A1} {A2} {x1} {eqta} {_} {_} {_} {a} {b} exta h

    ib : inbar w' (Œª w'' e ‚Üí FFDEFSeq x1 (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) w'' a b)
    ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw (‚Üëinbar eqi e')

eqInType-mon {u} (n , isu) {w} {A} {B} {w'} e' (EQTUNIV m p c‚ÇÅ c‚ÇÇ) eqt2 a b eqi rewrite isu =
  eqInType-u p (‚áõ-mon e' c‚ÇÅ) (‚áõ-mon e' c‚ÇÇ) eqt2 a b (uniUpTo-mon {n} {m} {p} eqi w' e')

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTLIFT A1 A2 x x‚ÇÅ eqta) eqt2 a b eqi = ?
{--  eqInType-‚áõ-TSQUASH-rev2
    u w' A B A1 A2 a b
    (‚àÄùïé-mon e' eqta)
    (wPredExtIrr-eqInType-mon eqta exta w' e')
    (‚áõ-mon e' x) (‚áõ-mon e' x‚ÇÅ) eqt2 (Œª eqt' lety ‚Üí eqInType-ext isu eqt') ib
  where
    aw : ‚àÄùïé w' (Œª w'' e'' ‚Üí ‚ÜëwPred (Œª w''' e ‚Üí TSQUASHeq (eqInType u w''' (eqta w''' e)) w''' a b) e' w'' e''
                            ‚Üí TSQUASHeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e'')) w'' a b)
    aw w1 e1 h = TSQUASHeq-ext {u} {w} {A1} {A2} {eqta} {_} {_} {_} {a} {b} exta h

    ib : inbar w' (Œª w'' e ‚Üí TSQUASHeq (eqInType u w'' (‚àÄùïé-mon e' eqta w'' e)) w'' a b)
    ib = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw (‚Üëinbar eqi e')--}

eqInType-mon {u} isu {w} {A} {B} {w'} e' (EQTBAR x) eqt2 a b eqi =
  local-eqInType2 u isu w' A B a b eqt2 ib ib'
  where
    ib : inbar w' (Œª w'' e ‚Üí eqTypes u w'' A B)
    ib = ‚Üëinbar x e'

    aw : ‚àÄùïé w (Œª w'' e'' ‚Üí (x‚ÇÅ y : eqTypes u w'' A B) (at‚ÇÅ : atbar x w'' e'' x‚ÇÅ) (at‚ÇÇ : atbar x w'' e'' y)
                           ‚Üí eqInType u w'' x‚ÇÅ a b
                           ‚Üí (w' : ùïé¬∑) (e' : w'' ‚äë¬∑ w') (eqt2 : eqTypes u w' A B) ‚Üí eqInType u w' eqt2 a b)
    aw w'' e'' x‚ÇÅ y at‚ÇÅ at‚ÇÇ eqi' w''' e''' eqt2' = eqInType-mon isu e''' x‚ÇÅ eqt2' a b eqi'

    ind : inbar' w x (Œª w1 e1 z ‚Üí (w' : ùïé¬∑) (e' : w1 ‚äë¬∑ w') (eqt2 : eqTypes u w' A B) ‚Üí eqInType u w' eqt2 a b)
    ind = Bar.inBar'-change inOpenBar-Bar x x aw eqi

    aw' : ‚àÄùïé w (Œª w'' e'' ‚Üí (x‚ÇÅ y : eqTypes u w'' A B) (at‚ÇÅ : atbar x w'' e'' x‚ÇÅ) (at‚ÇÇ : atbar x w'' e'' y)
                            ‚Üí ((w' : ùïé¬∑) (e' : w'' ‚äë¬∑ w') (eqt2 : eqTypes u w' A B) ‚Üí eqInType u w' eqt2 a b)
                            ‚Üí eqInType u w'' y a b)
    aw' w'' e'' x‚ÇÅ y at‚ÇÅ at‚ÇÇ imp = imp w'' (‚äë-refl¬∑ w'') y

    ib0 : inbar' w x (Œª w'' e z ‚Üí eqInType u w'' z a b)
    ib0 = Bar.inBar'-change inOpenBar-Bar x x aw' ind

    ib1 : inbar' w' ib (‚ÜëwPredDep (Œª w'' e (z : eqTypes u w'' A B) ‚Üí eqInType u w'' z a b) e')
    ib1 = ‚Üëinbar' {w} {Œª w e ‚Üí eqTypes u w A B} {Œª w e z ‚Üí eqInType u w z a b} x e' ib0

    ib' : inbar' w' ib (Œª w'' e z ‚Üí eqInType u w'' z a b)
    ib' = ib1




typeSysConds-BAR : (u : univs) (isu : is-uni u) (w : ùïé¬∑) (A B : CTerm)
                   (x : inbar w (Œª w' _ ‚Üí eqTypes u w' A B))
                   (ind : inbar' w x (Œª w1 e1 z ‚Üí TSP z))
                   ‚Üí TSP (EQTBAR x)
typeSysConds-BAR u isu w A B x ind =
  mktsp tsym ttrans isym itrans iextl1 iextl2 iextr1 iextr2 iextrevl1 iextrevl2 iextrevr1 iextrevr2 local
  where
    tsym : eqTypes u w B A
    tsym = EQTBAR (Bar.‚àÄùïé-inBar'-inBar inOpenBar-Bar x aw ind)
      where
        aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes u w' A B) (at : atbar x w' e' z) ‚Üí TSP z ‚Üí eqTypes u w' B A)
        aw w1 e1 eqt at tsp = TSP.tsym tsp

    ttrans : eqTypesTrans u w A B
    ttrans C eqt = typeSysConds-BAR-ttrans u w A B C x ind eqt

    isym : eqInTypeSym u (EQTBAR x)
    isym a b eqi = Bar.inBar'-comb inOpenBar-Bar x aw ind eqi
      where
        aw : ‚àÄùïé w (Œª w' e' ‚Üí (z zg zh : eqTypes u w' A B) ‚Üí TSP zg ‚Üí eqInType u w' zh a b ‚Üí eqInType u w' z b a)
        aw w1 e1 z zg zh tsp i = TSP.extl1 tsp B z b a (TSP.extrevl1 tsp B zg b a (TSP.isym tsp a b (TSP.extrevl1 tsp B zh a b i)))

    itrans : eqInTypeTrans u (EQTBAR x)
    itrans a b c eqi‚ÇÅ eqi‚ÇÇ = inBar'3 inOpenBar-Bar x aw ind eqi‚ÇÅ eqi‚ÇÇ
      where
        aw : ‚àÄùïé w (Œª w' e' ‚Üí (z zg zh zk : eqTypes u w' A B) ‚Üí TSP zg ‚Üí eqInType u w' zh a b ‚Üí eqInType u w' zk b c ‚Üí eqInType u w' z a c)
        aw w1 e1 z zg zh zk tsp i j = TSP.extl1 tsp B z a c (TSP.itrans tsp a b c i1 i2)
          where
            i1 : eqInType u w1 zg a b
            i1 = TSP.extrevl1 tsp B zh a b i

            i2 : eqInType u w1 zg b c
            i2 = TSP.extrevl1 tsp B zk b c j

    iextl1 : eqInTypeExtL1 (EQTBAR x)
    iextl1 C eqt a b eqi = local-eqInType2 u isu w A C a b eqt j ei'
      where
        j : inbar w (Œª w' e ‚Üí eqTypes u w' A C)
        j = Bar.‚àÄùïé-inBar inOpenBar-Bar (eqTypes-mon u eqt)

        aw : ‚àÄùïé w (Œª w' e' ‚Üí (x‚ÇÅ : eqTypes u w' A B) (x‚ÇÇ : eqTypes u w' A C) (at‚ÇÅ : atbar x w' e' x‚ÇÅ) (at‚ÇÇ : atbar j w' e' x‚ÇÇ)
                             ‚Üí TSP x‚ÇÅ √ó eqInType u w' x‚ÇÅ a b
                             ‚Üí eqInType u w' x‚ÇÇ a b)
        aw w' e' x‚ÇÅ x‚ÇÇ at‚ÇÅ at‚ÇÇ (tsp , eqi) = TSP.extl1 tsp C x‚ÇÇ a b eqi

        aw' : ‚àÄùïé w (Œª w' e' ‚Üí (z zg zh : eqTypes u w' A B)
                              ‚Üí TSP zg ‚Üí eqInType u w' zh a b ‚Üí TSP z √ó eqInType u w' z a b)
        aw' w' e' z zg zh tsp eqi = TSP-change isu zg z tsp , fst (eqInType-ext isu zh z a b) eqi

        ei' : inbar' w j (Œª w' e z ‚Üí eqInType u w' z a b)
        ei' = Bar.inBar'-change inOpenBar-Bar x j aw (Bar.inBar'-comb inOpenBar-Bar x aw' ind eqi)

    iextl2 : eqInTypeExtL2 (EQTBAR x)
    iextl2 C eqt a b eqi = local-eqInType2 u isu w C A a b eqt j ei'
      where
        j : inbar w (Œª w' e ‚Üí eqTypes u w' C A)
        j = Bar.‚àÄùïé-inBar inOpenBar-Bar (eqTypes-mon u eqt)

        aw : ‚àÄùïé w (Œª w' e' ‚Üí (x‚ÇÅ : eqTypes u w' A B) (x‚ÇÇ : eqTypes u w' C A) (at‚ÇÅ : atbar x w' e' x‚ÇÅ) (at‚ÇÇ : atbar j w' e' x‚ÇÇ)
                             ‚Üí TSP x‚ÇÅ √ó eqInType u w' x‚ÇÅ a b
                             ‚Üí eqInType u w' x‚ÇÇ a b)
        aw w' e' x‚ÇÅ x‚ÇÇ at‚ÇÅ at‚ÇÇ (tsp , eqi) = TSP.extl2 tsp C x‚ÇÇ a b eqi

        aw' : ‚àÄùïé w (Œª w' e' ‚Üí (z zg zh : eqTypes u w' A B)
                              ‚Üí TSP zg ‚Üí eqInType u w' zh a b ‚Üí TSP z √ó eqInType u w' z a b)
        aw' w' e' z zg zh tsp eqi = TSP-change isu zg z tsp , fst (eqInType-ext isu zh z a b) eqi

        ei' : inbar' w j (Œª w' e z ‚Üí eqInType u w' z a b)
        ei' = Bar.inBar'-change inOpenBar-Bar x j aw (Bar.inBar'-comb inOpenBar-Bar x aw' ind eqi)

    iextr1 : eqInTypeExtR1 (EQTBAR x)
    iextr1 C eqt a b eqi = local-eqInType2 u isu w C B a b eqt j ei'
      where
        j : inbar w (Œª w' e ‚Üí eqTypes u w' C B)
        j = Bar.‚àÄùïé-inBar inOpenBar-Bar (eqTypes-mon u eqt)

        aw : ‚àÄùïé w (Œª w' e' ‚Üí (x‚ÇÅ : eqTypes u w' A B) (x‚ÇÇ : eqTypes u w' C B) (at‚ÇÅ : atbar x w' e' x‚ÇÅ) (at‚ÇÇ : atbar j w' e' x‚ÇÇ)
                             ‚Üí TSP x‚ÇÅ √ó eqInType u w' x‚ÇÅ a b
                             ‚Üí eqInType u w' x‚ÇÇ a b)
        aw w' e' x‚ÇÅ x‚ÇÇ at‚ÇÅ at‚ÇÇ (tsp , eqi) = TSP.extr1 tsp C x‚ÇÇ a b eqi

        aw' : ‚àÄùïé w (Œª w' e' ‚Üí (z zg zh : eqTypes u w' A B)
                              ‚Üí TSP zg ‚Üí eqInType u w' zh a b ‚Üí TSP z √ó eqInType u w' z a b)
        aw' w' e' z zg zh tsp eqi = TSP-change isu zg z tsp , fst (eqInType-ext isu zh z a b) eqi

        ei' : inbar' w j (Œª w' e z ‚Üí eqInType u w' z a b)
        ei' = Bar.inBar'-change inOpenBar-Bar x j aw (Bar.inBar'-comb inOpenBar-Bar x aw' ind eqi)

    iextr2 : eqInTypeExtR2 (EQTBAR x)
    iextr2 C eqt a b eqi = local-eqInType2 u isu w B C a b eqt j ei'
      where
        j : inbar w (Œª w' e ‚Üí eqTypes u w' B C)
        j = Bar.‚àÄùïé-inBar inOpenBar-Bar (eqTypes-mon u eqt)

        aw : ‚àÄùïé w (Œª w' e' ‚Üí (x‚ÇÅ : eqTypes u w' A B) (x‚ÇÇ : eqTypes u w' B C) (at‚ÇÅ : atbar x w' e' x‚ÇÅ) (at‚ÇÇ : atbar j w' e' x‚ÇÇ)
                             ‚Üí TSP x‚ÇÅ √ó eqInType u w' x‚ÇÅ a b
                             ‚Üí eqInType u w' x‚ÇÇ a b)
        aw w' e' x‚ÇÅ x‚ÇÇ at‚ÇÅ at‚ÇÇ (tsp , eqi) = TSP.extr2 tsp C x‚ÇÇ a b eqi

        aw' : ‚àÄùïé w (Œª w' e' ‚Üí (z zg zh : eqTypes u w' A B)
                              ‚Üí TSP zg ‚Üí eqInType u w' zh a b ‚Üí TSP z √ó eqInType u w' z a b)
        aw' w' e' z zg zh tsp eqi = TSP-change isu zg z tsp , fst (eqInType-ext isu zh z a b) eqi

        ei' : inbar' w j (Œª w' e z ‚Üí eqInType u w' z a b)
        ei' = Bar.inBar'-change inOpenBar-Bar x j aw (Bar.inBar'-comb inOpenBar-Bar x aw' ind eqi)

    iextrevl1 : eqInTypeExtRevL1 (EQTBAR x)
    iextrevl1 C eqt a b eqi = Bar.inBar'-comb inOpenBar-Bar x aw ind ind
      where
        aw : ‚àÄùïé w (Œª w' e' ‚Üí (z zg zh : eqTypes u w' A B)
                             ‚Üí TSP zg ‚Üí TSP zh ‚Üí eqInType u w' z a b)
        aw w' e' z zg zh tsp _ =
          TSP.extl1
            tsp B z a b
            (TSP.extrevl1
              tsp C
              (eqTypes-mon u eqt w' e')
              a b
              (eqInType-mon isu e' eqt (eqTypes-mon u eqt w' e') a b eqi))

    iextrevl2 : eqInTypeExtRevL2 (EQTBAR x)
    iextrevl2 C eqt a b eqi = Bar.inBar'-comb inOpenBar-Bar x aw ind ind
      where
        aw : ‚àÄùïé w (Œª w' e' ‚Üí (z zg zh : eqTypes u w' A B)
                             ‚Üí TSP zg ‚Üí TSP zh ‚Üí eqInType u w' z a b)
        aw w' e' z zg zh tsp _ =
          TSP.extl1 tsp B z a b
            (TSP.extrevl2
                tsp C (eqTypes-mon u eqt w' e') a b
                (eqInType-mon isu e' eqt (eqTypes-mon u eqt w' e') a b eqi))

    iextrevr1 : eqInTypeExtRevR1 (EQTBAR x)
    iextrevr1 C eqt a b eqi = Bar.inBar'-comb inOpenBar-Bar x aw ind ind
      where
        aw : ‚àÄùïé w (Œª w' e' ‚Üí (z zg zh : eqTypes u w' A B)
                             ‚Üí TSP zg ‚Üí TSP zh ‚Üí eqInType u w' z a b)
        aw w' e' z zg zh tsp _ =
          TSP.extl1 tsp B z a b
            (TSP.extrevr1
                tsp C (eqTypes-mon u eqt w' e') a b
                (eqInType-mon isu e' eqt (eqTypes-mon u eqt w' e') a b eqi))

    iextrevr2 : eqInTypeExtRevR2 (EQTBAR x)
    iextrevr2 C eqt a b eqi = Bar.inBar'-comb inOpenBar-Bar x aw ind ind
      where
        aw : ‚àÄùïé w (Œª w' e' ‚Üí (z zg zh : eqTypes u w' A B)
                             ‚Üí TSP zg ‚Üí TSP zh ‚Üí eqInType u w' z a b)
        aw w' e' z zg zh tsp _ =
          TSP.extl1 tsp B z a b
            (TSP.extrevr2
                tsp C (eqTypes-mon u eqt w' e') a b
                (eqInType-mon isu e' eqt (eqTypes-mon u eqt w' e') a b eqi))

    local : eqInTypeLocal (EQTBAR x)
    local a b i j = Bar.inBar'-comb inOpenBar-Bar x aw ind ind
      where
        aw : ‚àÄùïé w (Œª w' e' ‚Üí (z zg zh : eqTypes u w' A B)
                             ‚Üí TSP zg ‚Üí TSP zh ‚Üí eqInType u w' z a b)
        aw w' e' z zg zh tsp _ =
          TSP.extl1 tsp B z a b
            (TSP.local tsp a b (‚Üëinbar i e') ib)
          where
            ib : inbar' w' (‚Üëinbar i e') (‚ÜëwPredDep (Œª w'' e (z‚ÇÅ : eqTypes u w'' A B) ‚Üí eqInType u w'' z‚ÇÅ a b) e')
            ib = ‚Üëinbar' {w} {Œª w e ‚Üí eqTypes u w A B} {Œª w e z ‚Üí eqInType u w z a b} i e' j





eqUnivi-sym : {n : ‚Ñï} {w : ùïé¬∑} {A B : CTerm} ‚Üí eqUnivi n w A B ‚Üí eqUnivi n w B A
eqUnivi-sym {n} {w} {A} {B} h = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 (c‚ÇÅ , c‚ÇÇ) ‚Üí c‚ÇÇ , c‚ÇÅ) h



eqUnivi-trans : {i n : ‚Ñï} (p : i < n) {w : ùïé¬∑} {A B C : CTerm}
                ‚Üí A #‚áõ #UNIV i at w
                ‚Üí B #‚áõ #UNIV i at w
                ‚Üí eqTypes (uni n) w B C
                ‚Üí eqTypes (uni n) w A C
{-# TERMINATING #-}
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTNAT x x‚ÇÅ) = ‚ä•-elim (UNIVneqNAT (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTQNAT x x‚ÇÅ) = ‚ä•-elim (UNIVneqQNAT (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = ‚ä•-elim (UNIVneqLT (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = ‚ä•-elim (UNIVneqQLT (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTFREE x x‚ÇÅ) = ‚ä•-elim (UNIVneqFREE (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) = ‚ä•-elim (UNIVneqPI (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) = ‚ä•-elim (UNIVneqSUM (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) = ‚ä•-elim (UNIVneqSET (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) = ‚ä•-elim (UNIVneqEQ (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) = ‚ä•-elim (UNIVneqUNION (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTSQUASH A1 A2 x x‚ÇÅ eqta exta) = ‚ä•-elim (UNIVneqTSQUASH (‚áõ-val-det tt tt c‚ÇÇ x))
--eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTDUM A1 A2 x x‚ÇÅ eqta) = ‚ä•-elim (UNIVneqDUM (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqta exta eqx) = ‚ä•-elim (UNIVneqFFDEFS (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTUNIV m q d‚ÇÅ d‚ÇÇ) =
  EQTUNIV i p c‚ÇÅ c
  where
    c : C #‚áõ #UNIV i at w
    c rewrite UNIVinj (‚áõ-val-det tt tt d‚ÇÅ c‚ÇÇ) = d‚ÇÇ
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTLIFT A1 A2 x x‚ÇÅ eqta) = ‚ä•-elim (UNIVneqLIFT (‚áõ-val-det tt tt c‚ÇÇ x))
eqUnivi-trans {i} {n} p {w} {A} {B} {C} c‚ÇÅ c‚ÇÇ (EQTBAR x) =
  EQTBAR (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw x)
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí eqTypes (uni n) w' B C ‚Üí eqTypes (uni n) w' A C)
    aw w1 e1 eqt =
      eqUnivi-trans p (‚áõ-mon e1 c‚ÇÅ) (‚áõ-mon e1 c‚ÇÇ) eqt




eqInUnivi-sym : {i n : ‚Ñï} (p : i < n) {w : ùïé¬∑} {A B : CTerm}
                (ind : (m : ‚Ñï) ‚Üí m < n ‚Üí is-TSP-univs (uni m))
                ‚Üí uniUpTo n i p w A B ‚Üí uniUpTo n i p w B A
eqInUnivi-sym {i} {n} p {w} {A} {B} ind x =
  inbarEqTypes‚ÜíuniUpTo {i} {n} {p} {w} {B} {A} (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw (uniUpTo‚ÜíinbarEqTypes {i} {n} {p} x))
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí eqTypes (uni i) w' A B
                        ‚Üí eqTypes (uni i) w' B A)
    aw w' e' eqt = TSP.tsym (ind i p w' A B eqt)





eqInUnivi-trans : {i n : ‚Ñï} (p : i < n) {w : ùïé¬∑} {A B C : CTerm}
                  (ind : (m : ‚Ñï) ‚Üí m < n ‚Üí is-TSP-univs (uni m))
                  ‚Üí uniUpTo n i p w A B
                  ‚Üí uniUpTo n i p w B C
                  ‚Üí uniUpTo n i p w A C
eqInUnivi-trans {i} {n} p {w} {A} {B} {C} ind eqi eqj =
  inbarEqTypes‚ÜíuniUpTo {i} {n} {p} {w} {A} {C}
    (Bar.inBarFunc inOpenBar-Bar (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw (uniUpTo‚ÜíinbarEqTypes {i} {n} {p} eqi))
                                 (uniUpTo‚ÜíinbarEqTypes {i} {n} {p} eqj))
  where
    aw : ‚àÄùïé w (Œª w' e' ‚Üí eqTypes (uni i) w' A B
                        ‚Üí eqTypes (uni i) w' B C
                        ‚Üí eqTypes (uni i) w' A C)
    aw w' e' eqt1 eqt2 = TSP.ttrans (ind i p w' A B eqt1) C eqt2




eqTypes-preserves-in-bar-‚áõ-UNIV : {i n : ‚Ñï} (p : i < n) {w : ùïé¬∑} {A B : CTerm}
                                   (eqt : eqTypes (uni n) w A B)
                                   ‚Üí A B#‚áõ #UNIV i at w
                                   ‚Üí B B#‚áõ #UNIV i at w
{-# TERMINATING #-}
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTNAT x x‚ÇÅ) j = ‚ä•-elim (UNIVneqNAT (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTQNAT x x‚ÇÅ) j = ‚ä•-elim (UNIVneqQNAT (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) j = ‚ä•-elim (UNIVneqLT (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) j = ‚ä•-elim (UNIVneqQLT (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTFREE x x‚ÇÅ) j = ‚ä•-elim (UNIVneqFREE (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) j = ‚ä•-elim (UNIVneqPI (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) j = ‚ä•-elim (UNIVneqSUM (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) j = ‚ä•-elim (UNIVneqSET (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA exta eqt1 eqt2) j = ‚ä•-elim (UNIVneqEQ (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB exta extb) j = ‚ä•-elim (UNIVneqUNION (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTSQUASH A1 A2 x x‚ÇÅ eqtA exta) j = ‚ä•-elim (UNIVneqTSQUASH (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA exta eqx) j = ‚ä•-elim (UNIVneqFFDEFS (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTUNIV m q c‚ÇÅ c‚ÇÇ) j rewrite UNIVinj (B‚Çó‚áõ-val-det tt tt j c‚ÇÅ) = #‚áõ‚ÜíB#‚áõ {B} {#UNIV m} c‚ÇÇ
--  Bar.inBarFunc inOpenBar-Bar (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' (a , b) c ‚Üí b) x) i
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTLIFT A1 A2 x x‚ÇÅ eqtA) j = ‚ä•-elim (UNIVneqLIFT (B‚Çó‚áõ-val-det tt tt j x))
eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p {w} {A} {B} (EQTBAR x) j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw x)
  where
    aw0 : ‚àÄùïé w (Œª w' e' ‚Üí eqTypes (uni n) w' A B ‚Üí inbar w' (Œª w'' _ ‚Üí B #‚áõ #UNIV i at w''))
    aw0 w' e' eqt = eqTypes-preserves-in-bar-‚áõ-UNIV {i} {n} p eqt (Bar.‚ÜëinBar inOpenBar-Bar j e')

    aw : ‚àÄùïé w (Œª w' e' ‚Üí eqTypes (uni n) w' A B ‚Üí inbar w' (Œª w'' _ ‚Üí (z : w ‚äë¬∑ w'') ‚Üí B #‚áõ #UNIV i at w''))
    aw w' e' eqt = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' b z ‚Üí b) (aw0 w' e' eqt)




eqTypes-preserves-in-bar-‚áõ-UNIV-rev : {i n : ‚Ñï} (p : i < n) {w : ùïé¬∑} {A B : CTerm}
                                       (eqt : eqTypes (uni n) w A B)
                                       ‚Üí B B#‚áõ #UNIV i at w
                                       ‚Üí A B#‚áõ #UNIV i at w
{-# TERMINATING #-}
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTNAT x x‚ÇÅ) j = ‚ä•-elim (UNIVneqNAT (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTQNAT x x‚ÇÅ) j = ‚ä•-elim (UNIVneqQNAT (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) j = ‚ä•-elim (UNIVneqLT (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) j = ‚ä•-elim (UNIVneqQLT (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTFREE x x‚ÇÅ) j = ‚ä•-elim (UNIVneqFREE (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) j = ‚ä•-elim (UNIVneqPI (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) j = ‚ä•-elim (UNIVneqSUM (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) j = ‚ä•-elim (UNIVneqSET (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA exta eqt1 eqt2) j = ‚ä•-elim (UNIVneqEQ (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB exta extb) j = ‚ä•-elim (UNIVneqUNION (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTSQUASH A1 A2 x x‚ÇÅ eqtA exta) j = ‚ä•-elim (UNIVneqTSQUASH (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA exta eqx) j = ‚ä•-elim (UNIVneqFFDEFS (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTUNIV m q c‚ÇÅ c‚ÇÇ) j rewrite UNIVinj (B‚Çó‚áõ-val-det tt tt j c‚ÇÇ) = #‚áõ‚ÜíB#‚áõ {A} {#UNIV m} c‚ÇÅ
--  Bar.inBarFunc inOpenBar-Bar (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' (a , b) c ‚Üí a) x) i
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTLIFT A1 A2 x x‚ÇÅ eqtA) j = ‚ä•-elim (UNIVneqLIFT (B‚Çó‚áõ-val-det tt tt j x‚ÇÅ))
eqTypes-preserves-in-bar-‚áõ-UNIV-rev {i} {n} p {w} {A} {B} (EQTBAR x) j =
  Bar.inBar-idem inOpenBar-Bar (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw x)
  where
    aw0 : ‚àÄùïé w (Œª w' e' ‚Üí eqTypes (uni n) w' A B ‚Üí inbar w' (Œª w'' _ ‚Üí A #‚áõ #UNIV i at w''))
    aw0 w' e' eqt = eqTypes-preserves-in-bar-‚áõ-UNIV-rev p eqt (Bar.‚ÜëinBar inOpenBar-Bar j e')

    aw : ‚àÄùïé w (Œª w' e' ‚Üí eqTypes (uni n) w' A B ‚Üí inbar w' (Œª w'' _ ‚Üí (z : w ‚äë¬∑ w'') ‚Üí A #‚áõ #UNIV i at w''))
    aw w' e' eqt = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' b z ‚Üí b) (aw0 w' e' eqt)



is-TSP-univs-eqUnivi : (n : ‚Ñï)
                       (ind : (m : ‚Ñï) ‚Üí m < n ‚Üí is-TSP-univs (uni m))
                       (w : ùïé¬∑) (A B : CTerm)
                       (i : ‚Ñï) (p : i < n)
                       (c‚ÇÅ : A #‚áõ #UNIV i at w)
                       (c‚ÇÇ : B #‚áõ #UNIV i at w)
                       ‚Üí TSP {uni n} {w} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
is-TSP-univs-eqUnivi n ind w A B i p c‚ÇÅ c‚ÇÇ =
  mktsp tsym ttrans isym itrans iextl1 iextl2 iextr1 iextr2 iextrevl1 iextrevl2 iextrevr1 iextrevr2 local
  where
    tsym : eqTypes (uni n) w B A
    tsym = EQTUNIV i p c‚ÇÇ c‚ÇÅ

    ttrans : eqTypesTrans (uni n) w A B
    ttrans C h = eqUnivi-trans p c‚ÇÅ c‚ÇÇ h

    isym : eqInTypeSym (uni n) {_} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
    isym a b eqi = eqInUnivi-sym {i} {n} p {w} {a} {b} ind eqi

    itrans : eqInTypeTrans (uni n) {_} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
    itrans a b c eqi‚ÇÅ eqi‚ÇÇ = eqInUnivi-trans {i} {n} p {w} {a} {b} {c} ind eqi‚ÇÅ eqi‚ÇÇ

    iextl1 : eqInTypeExtL1 {_} {_} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
    iextl1 C eqt' a b eqi =
      eqInType-u-bar {i} {n} p (#‚áõ‚ÜíB#‚áõ {A} {#UNIV i} c‚ÇÅ)
                               (eqTypes-preserves-in-bar-‚áõ-UNIV p eqt' (#‚áõ‚ÜíB#‚áõ {A} {#UNIV i} c‚ÇÅ))
                               eqt' a b eqi

    iextl2 : eqInTypeExtL2 {_} {_} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
    iextl2 C eqt' a b eqi =
      eqInType-u-bar {i} {n} p (eqTypes-preserves-in-bar-‚áõ-UNIV-rev p eqt' (#‚áõ‚ÜíB#‚áõ {A} {#UNIV i} c‚ÇÅ))
                               (#‚áõ‚ÜíB#‚áõ {A} {#UNIV i} c‚ÇÅ)
                               eqt' a b eqi

    iextr1 : eqInTypeExtR1 {_} {_} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
    iextr1 C eqt' a b eqi =
      eqInType-u-bar {i} {n} p (eqTypes-preserves-in-bar-‚áõ-UNIV-rev p eqt' (#‚áõ‚ÜíB#‚áõ {B} {#UNIV i} c‚ÇÇ))
                               (#‚áõ‚ÜíB#‚áõ {B} {#UNIV i} c‚ÇÇ)
                               eqt' a b eqi

    iextr2 : eqInTypeExtR2 {_} {_} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
    iextr2 C eqt' a b eqi =
      eqInType-u-bar {i} {n} p (#‚áõ‚ÜíB#‚áõ {B} {#UNIV i} c‚ÇÇ)
                               (eqTypes-preserves-in-bar-‚áõ-UNIV p eqt' (#‚áõ‚ÜíB#‚áõ {B} {#UNIV i} c‚ÇÇ))
                               eqt' a b eqi

    iextrevl1 : eqInTypeExtRevL1 {_} {_} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
    iextrevl1 C eqt' a b eqi =
      eqInType-u-rev-bar {i} {n} p (#‚áõ‚ÜíB#‚áõ {A} {#UNIV i} c‚ÇÅ)
                                   (eqTypes-preserves-in-bar-‚áõ-UNIV p eqt' (#‚áõ‚ÜíB#‚áõ {A} {#UNIV i} c‚ÇÅ))
                                   eqt' a b eqi

    iextrevl2 : eqInTypeExtRevL2 {_} {_} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
    iextrevl2 C eqt' a b eqi =
      eqInType-u-rev-bar {i} {n} p (eqTypes-preserves-in-bar-‚áõ-UNIV-rev p eqt' (#‚áõ‚ÜíB#‚áõ {A} {#UNIV i} c‚ÇÅ))
                                   (#‚áõ‚ÜíB#‚áõ {A} {#UNIV i} c‚ÇÅ)
                                   eqt' a b eqi

    iextrevr1 : eqInTypeExtRevR1 {_} {_} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
    iextrevr1 C eqt' a b eqi =
      eqInType-u-rev-bar {i} {n} p (eqTypes-preserves-in-bar-‚áõ-UNIV-rev p eqt' (#‚áõ‚ÜíB#‚áõ {B} {#UNIV i} c‚ÇÇ))
                                   (#‚áõ‚ÜíB#‚áõ {B} {#UNIV i} c‚ÇÇ)
                                   eqt' a b eqi

    iextrevr2 : eqInTypeExtRevR2 {_} {_} {A} {B} (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
    iextrevr2 C eqt' a b eqi =
      eqInType-u-rev-bar {i} {n} p (#‚áõ‚ÜíB#‚áõ {B} {#UNIV i} c‚ÇÇ)
                                   (eqTypes-preserves-in-bar-‚áõ-UNIV p eqt' (#‚áõ‚ÜíB#‚áõ {B} {#UNIV i} c‚ÇÇ))
                                   eqt' a b eqi

    local : eqInTypeLocal (EQTUNIV i p c‚ÇÅ c‚ÇÇ)
    local a b m j =
      eqInType-u-rev-bar {i} {n} p (#‚áõ‚ÜíB#‚áõ {A} {#UNIV i} c‚ÇÅ)
                                   (#‚áõ‚ÜíB#‚áõ {B} {#UNIV i} c‚ÇÇ)
                                   (EQTBAR m) a b
                                   (local-eqInType2 (uni n) (is-uni-uni n) w A B a b (EQTBAR m) m j)



typeSysConds-aux : (n : ‚Ñï) (ind : (m : ‚Ñï) ‚Üí m < n ‚Üí is-TSP-univs (uni m))
                   (w : ùïé¬∑) (A B : CTerm) (eqt : eqTypes (uni n) w A B) ‚Üí TSP eqt
{-# TERMINATING #-}
typeSysConds-aux n ind w A B (EQTNAT x x‚ÇÅ) = typeSysConds-NAT (uni n) w A B x x‚ÇÅ
typeSysConds-aux n ind w A B (EQTQNAT x x‚ÇÅ) = typeSysConds-QNAT (uni n) w A B x x‚ÇÅ
typeSysConds-aux n ind w A B (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = typeSysConds-LT (uni n) w A B a1 b1 a2 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ
typeSysConds-aux n ind w A B (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = typeSysConds-QLT (uni n) w A B a1 b1 a2 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ
typeSysConds-aux n ind w A B (EQTFREE x x‚ÇÅ) = typeSysConds-FREE (uni n) w A B x x‚ÇÅ
typeSysConds-aux n ind w A B (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) =
  typeSysConds-PI (uni n) w A B A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb inda indb
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí TSP (eqta w1 e1))
    inda w1 e1 = typeSysConds-aux n ind w1 A1 A2 (eqta w1 e1)

    indb : ‚àÄùïé w (Œª w1 e1 ‚Üí
                     (a1 a2 : CTerm) (ea : eqInType (uni n) w1 (eqta w1 e1) a1 a2)
                     ‚Üí TSP (eqtb w1 e1 a1 a2 ea))
    indb w1 e1 a1 a2 ea = typeSysConds-aux n ind w1 (sub0 a1 B1) (sub0 a2 B2) (eqtb w1 e1 a1 a2 ea)

typeSysConds-aux n ind w A B (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) =
  typeSysConds-SUM (uni n) w A B A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb inda indb
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí TSP (eqta w1 e1))
    inda w1 e1 = typeSysConds-aux n ind w1 A1 A2 (eqta w1 e1)

    indb : ‚àÄùïé w (Œª w1 e1 ‚Üí
                     (a1 a2 : CTerm) (ea : eqInType (uni n) w1 (eqta w1 e1) a1 a2)
                     ‚Üí TSP (eqtb w1 e1 a1 a2 ea))
    indb w1 e1 a1 a2 ea = typeSysConds-aux n ind w1 (sub0 a1 B1) (sub0 a2 B2) (eqtb w1 e1 a1 a2 ea)

typeSysConds-aux n ind w A B (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) =
  typeSysConds-SET (uni n) w A B A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb inda indb
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí TSP (eqta w1 e1))
    inda w1 e1 = typeSysConds-aux n ind w1 A1 A2 (eqta w1 e1)

    indb : ‚àÄùïé w (Œª w1 e1 ‚Üí
                     (a1 a2 : CTerm) (ea : eqInType (uni n) w1 (eqta w1 e1) a1 a2)
                     ‚Üí TSP (eqtb w1 e1 a1 a2 ea))
    indb w1 e1 a1 a2 ea = typeSysConds-aux n ind w1 (sub0 a1 B1) (sub0 a2 B2) (eqtb w1 e1 a1 a2 ea)

typeSysConds-aux n ind w A B (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) =
  typeSysConds-EQ (uni n) w A B A‚ÇÅ B‚ÇÅ a1 b1 a2 b2 x x‚ÇÅ eqtA extA inda eqt1 eqt2
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí TSP (eqtA w1 e1))
    inda w1 e1 = typeSysConds-aux n ind w1 A‚ÇÅ B‚ÇÅ (eqtA w1 e1)

typeSysConds-aux n ind w A B (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) =
  typeSysConds-UNION (uni n) w A B A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB inda indb
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí TSP (eqtA w1 e1))
    inda w1 e1 = typeSysConds-aux n ind w1 A1 A2 (eqtA w1 e1)

    indb : ‚àÄùïé w (Œª w1 e1 ‚Üí TSP (eqtB w1 e1))
    indb w1 e1 = typeSysConds-aux n ind w1 B1 B2 (eqtB w1 e1)

typeSysConds-aux n ind w A B (EQTSQUASH A1 A2 x x‚ÇÅ eqtA exta) =
  typeSysConds-TSQUASH (uni n) w A B A1 A2 x x‚ÇÅ eqtA exta inda
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí TSP (eqtA w1 e1))
    inda w1 e1 = typeSysConds-aux n ind w1 A1 A2 (eqtA w1 e1)

--typeSysConds-aux n ind w A B (EQTDUM A1 A2 x x‚ÇÅ eqta) = {!!}

typeSysConds-aux n ind w A B (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqta exta eqx) =
  typeSysConds-FFDEFS (uni n) w A B A1 A2 x1 x2 x x‚ÇÅ eqta exta inda eqx
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí TSP (eqta w1 e1))
    inda w1 e1 = typeSysConds-aux n ind w1 A1 A2 (eqta w1 e1)

typeSysConds-aux n ind w A B (EQTUNIV m p c‚ÇÅ c‚ÇÇ) =
  is-TSP-univs-eqUnivi n ind w A B m p c‚ÇÅ c‚ÇÇ

typeSysConds-aux n ind w A B (EQTLIFT A1 A2 x x‚ÇÅ eqtA) = ?
{--  typeSysConds-TSQUASH (uni n) w A B A1 A2 x x‚ÇÅ eqtA exta inda
  where
    inda : ‚àÄùïé w (Œª w1 e1 ‚Üí TSP (eqtA w1 e1))
    inda w1 e1 = typeSysConds-aux n ind w1 A1 A2 (eqtA w1 e1)--}

typeSysConds-aux n ind w A B (EQTBAR x) =
  typeSysConds-BAR (uni n) (is-uni-uni n) w A B x ind'
  where
    ind' : inbar' w x (Œª w1 e1 z ‚Üí TSP z)
    ind' = Bar.‚àÄùïé-inBar-inBar' inOpenBar-Bar x aw
      where
        aw : ‚àÄùïé w (Œª w' e' ‚Üí (z : eqTypes (uni n) w' A B) (at : atbar x w' e' z) ‚Üí TSP z)
        aw w1 e1 z at = typeSysConds-aux n ind w1 A B z




eqTypes-inbar : {u : univs} {w : ùïé¬∑} {a b c d : CTerm} {F : wPred w}
                ‚Üí ‚àÄùïé w (Œª w1 e1 ‚Üí F w1 e1 ‚Üí eqTypes u w1 a b ‚Üí eqTypes u w1 c d)
                ‚Üí inbar w F
                ‚Üí eqTypes u w a b
                ‚Üí eqTypes u w c d
eqTypes-inbar {u} {w} {a} {b} {c} {d} {F} aw i e =
  EQTBAR (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar q i)
  where
    q : ‚àÄùïé w (Œª w' e' ‚Üí F w' e' ‚Üí eqTypes u w' c d)
    q w1 e1 f = aw w1 e1 f (eqTypes-mon u e w1 e1)


eqUnivi-mon : (n : ‚Ñï) ‚Üí mon (eqUnivi n)
eqUnivi-mon n e w1 e1 = Bar.‚ÜëinBar inOpenBar-Bar e e1




{--
eqInUnivi‚Üí : {n : ‚Ñï} {w : ùïé¬∑} {A B : CTerm} ‚Üí eqInUnivi n w A B ‚Üí Œ£ ‚Ñï (Œª m ‚Üí m < n √ó inbar w (Œª w' _ ‚Üí eqTypes (uni m) w' A B))
eqInUnivi‚Üí {suc n} {w} {A} {B} ({--inj‚ÇÅ--} x) = n , n<1+n n , x
{--eqInUnivi‚Üí {suc n} {w} {A} {B} (inj‚ÇÇ y) = fst ind , <-trans (fst (snd ind)) (n<1+n n) , snd (snd ind)
  where
    ind : Œ£ ‚Ñï (Œª m ‚Üí m < n √ó eqTypes (uni m) w A B)
    ind = eqInUnivi‚Üí y--}
--}



{--mon-univs-uni : (n : ‚Ñï) ‚Üí mon-univs (uni n)
mon-univs-uni n {a} {b} {w} h w1 e1 =
  Bar.‚àÄùïé-inBarFunc inOpenBar-Bar aw (Bar.‚ÜëinBar inOpenBar-Bar h e1)
  where
    aw : ‚àÄùïé w1 (Œª w' e' ‚Üí ‚ÜëwPred (Œª w'' e ‚Üí a #‚áõ #UNIV n at w'' √ó b #‚áõ #UNIV n at w'') e1 w' e'
                          ‚Üí a #‚áõ #UNIV n at w' √ó b #‚áõ #UNIV n at w')
    aw w' e' x = x--}



‚Üíinbar√ó : {w : ùïé¬∑} {f g : wPred w}
           ‚Üí inbar w f
           ‚Üí inbar w g
           ‚Üí inbar w (Œª w' e' ‚Üí f w' e' √ó g w' e')
‚Üíinbar√ó {w} {f} {g} i j = Bar.inBarFunc inOpenBar-Bar (Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' a b ‚Üí (a , b)) i) j



inbar√ó‚Üí‚ÇÅ : {w : ùïé¬∑} {f g : wPred w}
           ‚Üí inbar w (Œª w' e' ‚Üí f w' e' √ó g w' e')
           ‚Üí inbar w f
inbar√ó‚Üí‚ÇÅ {w} {f} {g} i = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' ‚Üí fst) i



inbar√ó‚Üí‚ÇÇ : {w : ùïé¬∑} {f g : wPred w}
           ‚Üí inbar w (Œª w' e' ‚Üí f w' e' √ó g w' e')
           ‚Üí inbar w g
inbar√ó‚Üí‚ÇÇ {w} {f} {g} i = Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w' e' ‚Üí snd) i



comp-ind-‚Ñï-aux : (P : ‚Ñï ‚Üí Set‚ÇÅ)
                 ‚Üí ((n : ‚Ñï) ‚Üí ((m : ‚Ñï) ‚Üí m < n ‚Üí P m) ‚Üí P n)
                 ‚Üí (n m : ‚Ñï) ‚Üí m < n ‚Üí P m
comp-ind-‚Ñï-aux P ind (suc n) m (_‚â§_.s‚â§s z) with m‚â§n‚áím<n‚à®m‚â°n z
... | inj‚ÇÅ q = comp-ind-‚Ñï-aux P ind n m q
... | inj‚ÇÇ q rewrite q = ind n (comp-ind-‚Ñï-aux P ind n)


comp-ind-‚Ñï : (P : ‚Ñï ‚Üí Set‚ÇÅ)
              ‚Üí ((n : ‚Ñï) ‚Üí ((m : ‚Ñï) ‚Üí m < n ‚Üí P m) ‚Üí P n)
              ‚Üí (n : ‚Ñï) ‚Üí P n
comp-ind-‚Ñï P ind n = comp-ind-‚Ñï-aux P ind (suc n) n (_‚â§_.s‚â§s ‚â§-refl)


{--
is-TSP-univs-uni : (n : ‚Ñï) ‚Üí is-TSP-univs (uni n)
is-TSP-univs-uni n = comp-ind-‚Ñï (Œª n ‚Üí is-TSP-univs (uni n)) h n
  where
    h : (i : ‚Ñï) ‚Üí ((m : ‚Ñï) ‚Üí m < i ‚Üí is-TSP-univs (uni m)) ‚Üí is-TSP-univs (uni i)
    h i ind w A B x = {!!} --is-TSP-univs-eqUnivi i ind w A B x
--}



typeSysConds : (n : ‚Ñï) ‚Üí is-TSP-univs (uni n)
typeSysConds n = comp-ind-‚Ñï (Œª n ‚Üí is-TSP-univs (uni n)) typeSysConds-aux n



TEQsym-eqtypes : TEQsym eqtypes
TEQsym-eqtypes w A B (n , h) = n , TSP.tsym (typeSysConds n w A B h)


{--
eqTypes-uni-mon-suc : {n : ‚Ñï} {w : ùïé¬∑} {A B : CTerm}
                      ‚Üí eqTypes (uni n) w A B
                      ‚Üí eqTypes (uni (suc n)) w A B
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTNAT x x‚ÇÅ) = EQTNAT x x‚ÇÅ
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTQNAT x x‚ÇÅ) = EQTQNAT x x‚ÇÅ
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTFREE x x‚ÇÅ) = EQTFREE x x‚ÇÅ
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) =
  EQTPI
    A1 B1 A2 B2 x x‚ÇÅ
    {!!}
    {!!}
    ? ?
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) = {!!}
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) = {!!}
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) = {!!}
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) = {!!}
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTSQUASH A1 A2 x x‚ÇÅ eqtA) = {!!}
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA eqx) = {!!}
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTUNIV x) = {!!}
eqTypes-uni-mon-suc {n} {w} {A} {B} (EQTBAR x) = {!!}
--}


TEQsym-equalTypes : (n : ‚Ñï) ‚Üí TEQsym (equalTypes n)
TEQsym-equalTypes n w A B h = TSP.tsym (typeSysConds n w A B h)


TEQtrans-equalTypes : (n : ‚Ñï) ‚Üí TEQtrans (equalTypes n)
TEQtrans-equalTypes n w A B C h q =
  TSP.ttrans (typeSysConds n w A B h) C q


EQTsym-equalInType : (n : ‚Ñï) ‚Üí EQTsym (equalInType n)
EQTsym-equalInType n w A a b (teq , eqi) =
  teq , TSP.isym (typeSysConds n w A A teq) a b eqi


EQTtrans-equalInType : (n : ‚Ñï) ‚Üí EQTtrans (equalInType n)
EQTtrans-equalInType n w A a b c (teq‚ÇÅ , eqi‚ÇÅ) (teq‚ÇÇ , eqi‚ÇÇ) =
  teq‚ÇÅ , TSP.itrans
           (typeSysConds n w A A teq‚ÇÅ)
           a b c
           eqi‚ÇÅ
           (TSP.extl1 (typeSysConds n w A A teq‚ÇÇ) A teq‚ÇÅ b c eqi‚ÇÇ)


TEQrefl : TEQ ‚Üí Set‚ÇÅ
TEQrefl œÑ = (w : ùïé¬∑) (A B : CTerm) ‚Üí œÑ w A B ‚Üí œÑ w A A


TEQrefl-rev : TEQ ‚Üí Set‚ÇÅ
TEQrefl-rev œÑ = (w : ùïé¬∑) (A B : CTerm) ‚Üí œÑ w A B ‚Üí œÑ w B B



TEQrefl-equalTypes : (n : ‚Ñï) ‚Üí TEQrefl (equalTypes n)
TEQrefl-equalTypes n w A B h =
  TEQtrans-equalTypes n w A B A h (TEQsym-equalTypes n w A B h)


TEQrefl-rev-equalTypes : (n : ‚Ñï) ‚Üí TEQrefl-rev (equalTypes n)
TEQrefl-rev-equalTypes n w A B h =
  TEQtrans-equalTypes n w B A B (TEQsym-equalTypes n w A B h) h


TSext-equalTypes-equalInType : (n : ‚Ñï) ‚Üí TSext (equalTypes n) (equalInType n)
TSext-equalTypes-equalInType n w A B a b h (teq , eqi) =
  TEQrefl-rev-equalTypes n w A B h ,
  TSP.extr1
    (typeSysConds n w A B h)
    B (TEQrefl-rev-equalTypes n w A B h) a b
    (TSP.extl1 (typeSysConds n w A A teq) B h a b eqi)


typeSys : (n : ‚Ñï) ‚Üí TS (equalTypes n) (equalInType n)
typeSys n =
  mkts
    (TEQsym-equalTypes n)
    (TEQtrans-equalTypes n)
    (EQTsym-equalInType n)
    (EQTtrans-equalInType n)
    (TSext-equalTypes-equalInType n)



{--
-- Those need to be packaged as we did in Coq
eqTypes-sym : (u : univs) ‚Üí TEQsym (eqTypes u)
eqInType-sym : (u : univs) (w : ùïé¬∑) (A B a b : CTerm) (eqt : eqTypes u w A B)
               ‚Üí eqInType u w eqt a b
               ‚Üí eqInType u w eqt b a
eqType-refl : (u : univs) (w : ùïé¬∑) (A B : CTerm)
              ‚Üí eqTypes u w A B
              ‚Üí eqTypes u w A A
eqInType-refl : (u : univs) (w : ùïé¬∑) (A B a b : CTerm) (eqt : eqTypes u w A B)
                ‚Üí eqInType u w eqt a b
                ‚Üí eqInType u w eqt a a
eqType-pres-eqInType : (u : univs) (w : ùïé¬∑) (A B C D a b : CTerm)
                       (eqt1 : eqTypes u w A B) (eqt2 : eqTypes u w C D)
                       ‚Üí eqTypes u w B C
                       ‚Üí eqInType u w eqt1 a b
                       ‚Üí eqInType u w eqt2 a b
eqTypes-trans : (u : univs) (w : ùïé¬∑) (A B C : CTerm) ‚Üí eqTypes u w A B ‚Üí eqTypes u w B C ‚Üí eqTypes u w A C


eqTypes-sym u w A B (EQTNAT x x‚ÇÅ) = EQTNAT x‚ÇÅ x
eqTypes-sym u w A B (EQTQNAT x x‚ÇÅ) = EQTQNAT x‚ÇÅ x
eqTypes-sym u w A B (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) =
  EQTLT a2 a1 b2 b1 x‚ÇÅ x (strongMonEq-sym x‚ÇÇ) (strongMonEq-sym x‚ÇÉ)
eqTypes-sym u w A B (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) =
  EQTQLT a2 a1 b2 b1 x‚ÇÅ x (weakMonEq-sym x‚ÇÇ) (weakMonEq-sym x‚ÇÉ)
eqTypes-sym u w A B (EQTFREE x x‚ÇÅ) = EQTFREE x‚ÇÅ x
eqTypes-sym u w A B (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) =
  EQTPI
    A2 B2 A1 B1 x‚ÇÅ x
    (Œª w1 e1 ‚Üí eqTypes-sym u w1 A1 A2 (eqta w1 e1))
    (Œª w1 e1 a b eqi ‚Üí
      eqTypes-sym
        u w1 (sub0 b B1) (sub0 a B2)
        (eqtb w1 e1 b a
              (eqInType-sym u w1 A1 A2 a b (eqta w1 e1)
                (eqType-pres-eqInType u w1 A2 A1 A1 A2 a b
                  (eqTypes-sym u w1 A1 A2 (eqta w1 e1))
                  (eqta w1 e1)
                  (eqType-refl u w1 A1 A2 (eqta w1 e1))
                  eqi))))
    ? ?
eqTypes-sym u w A B (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) =
  EQTSUM
    A2 B2 A1 B1 x‚ÇÅ x
    (Œª w1 e1 ‚Üí eqTypes-sym u w1 A1 A2 (eqta w1 e1))
    (Œª w1 e1 a b eqi ‚Üí
      eqTypes-sym
        u w1 (sub0 b B1) (sub0 a B2)
        (eqtb w1 e1 b a
              (eqInType-sym u w1 A1 A2 a b (eqta w1 e1)
                (eqType-pres-eqInType u w1 A2 A1 A1 A2 a b
                  (eqTypes-sym u w1 A1 A2 (eqta w1 e1))
                  (eqta w1 e1)
                  (eqType-refl u w1 A1 A2 (eqta w1 e1))
                  eqi))))
eqTypes-sym u w A B (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) =
  EQTSET
    A2 B2 A1 B1 x‚ÇÅ x
    (Œª w1 e1 ‚Üí eqTypes-sym u w1 A1 A2 (eqta w1 e1))
    (Œª w1 e1 a b eqi ‚Üí
      eqTypes-sym
        u w1 (sub0 b B1) (sub0 a B2)
        (eqtb w1 e1 b a
              (eqInType-sym u w1 A1 A2 a b (eqta w1 e1)
                (eqType-pres-eqInType u w1 A2 A1 A1 A2 a b
                  (eqTypes-sym u w1 A1 A2 (eqta w1 e1))
                  (eqta w1 e1)
                  (eqType-refl u w1 A1 A2 (eqta w1 e1))
                  eqi))))
eqTypes-sym u w A B (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) =
  EQTEQ
    b1 a1 b2 a2 B‚ÇÅ A‚ÇÅ x‚ÇÅ x
    (Œª w1 e1 ‚Üí eqTypes-sym u w1 A‚ÇÅ B‚ÇÅ (eqtA w1 e1))
    (Œª w1 e1 ‚Üí {!!}) --eqType-sym-pres-rev u w1 A‚ÇÅ B‚ÇÅ b1 a1 (eqtA w1 e1) (eqInType-sym u w1 A‚ÇÅ B‚ÇÅ a1 b1 (eqtA w1 e1) (eqt1 w1 e1)))
    (Œª w1 e1 ‚Üí {!!}) --eqType-sym-pres-rev u w1 A‚ÇÅ B‚ÇÅ b2 a2 (eqtA w1 e1) (eqInType-sym u w1 A‚ÇÅ B‚ÇÅ a2 b2 (eqtA w1 e1) (eqt2 w1 e1)))
eqTypes-sym u w A B (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) =
  EQTUNION
    A2 B2 A1 B1 x‚ÇÅ x
    (Œª w1 e1 ‚Üí eqTypes-sym u w1 A1 A2 (eqtA w1 e1))
    (Œª w1 e1 ‚Üí eqTypes-sym u w1 B1 B2 (eqtB w1 e1))
eqTypes-sym u w A B (EQTSQUASH A1 A2 x x‚ÇÅ eqtA) =
  EQTSQUASH
    A2 A1 x‚ÇÅ x
    (Œª w1 e1 ‚Üí eqTypes-sym u w1 A1 A2 (eqtA w1 e1))
eqTypes-sym u w A B (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA eqx) =
  EQFFDEFS
    A2 A1 x2 x1 x‚ÇÅ x
    (Œª w1 e1 ‚Üí eqTypes-sym u w1 A1 A2 (eqtA w1 e1))
    (Œª w1 e1 ‚Üí {!!}) --eqType-sym-pres-rev u w1 A1 A2 x2 x1 (eqtA w1 e1) (eqInType-sym u w1 A1 A2 x1 x2 (eqtA w1 e1) (eqx w1 e1)))
eqTypes-sym u w A B (EQTUNIV x) = {!!}
eqTypes-sym u w A B (EQTBAR x) = {!!}

eqInType-sym u w A B a b (EQTNAT x x‚ÇÅ) h =
  Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 ‚Üí strongMonEq-sym) h
eqInType-sym u w A B a b (EQTQNAT x x‚ÇÅ) h =
  Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 ‚Üí weakMonEq-sym) h
eqInType-sym u w A B a b (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) h =
  Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 z ‚Üí z) h
eqInType-sym u w A B a b (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) h = {!!}
eqInType-sym u w A B a b (EQTFREE x x‚ÇÅ) h = {!!}
eqInType-sym u w A B a b (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) h =
  Bar.‚àÄùïé-inBarFunc
    inOpenBar-Bar
    h‚ÇÅ
    h
  where
    h‚ÇÅ : ‚àÄùïé w
           (Œª w' e'
             ‚Üí ((a1 a2 : CTerm) (eqa : eqInType u w' (eqta w' e') a1 a2) ‚Üí eqInType u w' (eqtb w' e' a1 a2 eqa) (APPLY a a1) (APPLY b a2))
             ‚Üí (a1 a2 : CTerm) (eqa : eqInType u w' (eqta w' e') a1 a2) ‚Üí eqInType u w' (eqtb w' e' a1 a2 eqa) (APPLY b a1) (APPLY a a2))
    h‚ÇÅ w1 e1 z a‚ÇÅ b‚ÇÅ eqa =
      eqInType-sym
        u w1 (sub0 a‚ÇÅ B1) (sub0 b‚ÇÅ B2) (APPLY a b‚ÇÅ) (APPLY b a‚ÇÅ)
        (eqtb w1 e1 a‚ÇÅ b‚ÇÅ eqa)
        (eqType-pres-eqInType u w1 (sub0 b‚ÇÅ B1) (sub0 a‚ÇÅ B2) (sub0 a‚ÇÅ B1) (sub0 b‚ÇÅ B2) (APPLY a b‚ÇÅ) (APPLY b a‚ÇÅ)
          (eqtb w1 e1 b‚ÇÅ a‚ÇÅ (eqInType-sym u w1 A1 A2 a‚ÇÅ b‚ÇÅ (eqta w1 e1) eqa))
          (eqtb w1 e1 a‚ÇÅ b‚ÇÅ eqa)
          (eqTypes-sym u w1 (sub0 a‚ÇÅ B1) (sub0 a‚ÇÅ B2) (eqtb w1 e1 a‚ÇÅ a‚ÇÅ (eqInType-refl u w1 A1 A2 a‚ÇÅ b‚ÇÅ (eqta w1 e1) eqa)))
          h‚ÇÇ)
        where
          h‚ÇÇ : eqInType u w1 (eqtb w1 e1 b‚ÇÅ a‚ÇÅ (eqInType-sym u w1 A1 A2 a‚ÇÅ b‚ÇÅ (eqta w1 e1) eqa)) (APPLY a b‚ÇÅ) (APPLY b a‚ÇÅ)
          h‚ÇÇ = z b‚ÇÅ a‚ÇÅ (eqInType-sym u w1 A1 A2 a‚ÇÅ b‚ÇÅ (eqta w1 e1) eqa)
{--      eqInType-sym
        u w1 (sub0 b‚ÇÅ B1) (sub0 a‚ÇÅ B2) (APPLY a b‚ÇÅ) (APPLY b a‚ÇÅ)
        {!!} --(eqtb w1 e1 b‚ÇÅ a‚ÇÅ (eqInType-sym-rev u w1 A1 A2 a‚ÇÅ b‚ÇÅ (eqta w1 e1) eqa))
        {!!}) --(z b‚ÇÅ a‚ÇÅ (eqInType-sym-rev u w1 A1 A2 a‚ÇÅ b‚ÇÅ (eqta w1 e1) eqa))) --}
eqInType-sym u w A B a b (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) h = {!!}
eqInType-sym u w A B a b (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) h = {!!}
eqInType-sym u w A B a b (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) h = {!!}
eqInType-sym u w A B a b (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) h = {!!}
eqInType-sym u w A B a b (EQTSQUASH A1 A2 x x‚ÇÅ eqtA) h = {!!}
eqInType-sym u w A B a b (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA eqx) h = {!!}
eqInType-sym u w A B a b (EQTUNIV x) h = {!!}
eqInType-sym u w A B a b (EQTBAR x) h = {!!}

eqType-refl u w A B (EQTNAT x x‚ÇÅ) = EQTNAT x x
eqType-refl u w A B (EQTQNAT x x‚ÇÅ) = {!!}
eqType-refl u w A B (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = {!!}
eqType-refl u w A B (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) = {!!}
eqType-refl u w A B (EQTFREE x x‚ÇÅ) = {!!}
eqType-refl u w A B (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) =
  EQTPI
    A1 B1 A1 B1 x x
    (Œª w1 e1 ‚Üí eqType-refl u w1 A1 A2 (eqta w1 e1))
    h
    ? ?
  where
    h : ‚àÄùïé w (Œª w' e ‚Üí
         (a1 a2 : CTerm) ‚Üí eqInType u w' (eqType-refl u w' A1 A2 (eqta w' e)) a1 a2
         ‚Üí eqTypes u w' (sub0 a1 B1) (sub0 a2 B1))
    h w1 e1 a1 a2 eqa = h‚ÇÄ
      where
        h‚ÇÉ : eqTypes u w1 A1 A1
        h‚ÇÉ = eqType-refl u w1 A1 A2 (eqta w1 e1)

        h‚ÇÇ : eqInType u w1 (eqta w1 e1) a1 a2
        h‚ÇÇ = eqType-pres-eqInType u w1 A1 A1 A1 A2 a1 a2 (eqType-refl u w1 A1 A2 (eqta w1 e1)) (eqta w1 e1) h‚ÇÉ eqa

        h‚ÇÅ : eqTypes u w1 (sub0 a1 B1) (sub0 a2 B2)
        h‚ÇÅ = eqtb w1 e1 a1 a2 h‚ÇÇ

        h‚ÇÜ : eqInType u w1 (eqta w1 e1) a2 a1
        h‚ÇÜ = eqInType-sym u w1 A1 A2 a1 a2 (eqta w1 e1) h‚ÇÇ

        h‚ÇÖ : eqInType u w1 (eqta w1 e1) a2 a2
        h‚ÇÖ = eqInType-refl u w1 A1 A2 a2 a1 (eqta w1 e1) h‚ÇÜ

        h‚ÇÑ : eqTypes u w1 (sub0 a2 B1) (sub0 a2 B2)
        h‚ÇÑ = eqtb w1 e1 a2 a2 h‚ÇÖ

        h‚Çá : eqTypes u w1 (sub0 a2 B2) (sub0 a2 B1)
        h‚Çá = eqTypes-sym u w1 (sub0 a2 B1) (sub0 a2 B2) h‚ÇÑ

        h‚ÇÄ : eqTypes u w1 (sub0 a1 B1) (sub0 a2 B1)
        h‚ÇÄ = eqTypes-trans u w1 (sub0 a1 B1) (sub0 a2 B2) (sub0 a2 B1) h‚ÇÅ h‚Çá


eqType-refl u w A B (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) = {!!}
eqType-refl u w A B (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) = {!!}
eqType-refl u w A B (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) = {!!}
eqType-refl u w A B (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) = {!!}
eqType-refl u w A B (EQTSQUASH A1 A2 x x‚ÇÅ eqtA) = {!!}
eqType-refl u w A B (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA eqx) = {!!}
eqType-refl u w A B (EQTUNIV x) = {!!}
eqType-refl u w A B (EQTBAR x) = {!!}

eqInType-refl u w A B a b eqt h = {!!}

eqType-pres-eqInType u w A B a b eqt h = {!!}

eqTypes-trans u w A B C eqta eqtb = {!!}
--}


{--
eqInType-sym-rev u w A B a b (EQTNAT x x‚ÇÅ) h =
  Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 ‚Üí strongMonEq-sym) h
eqInType-sym-rev u w A B a b (EQTQNAT x x‚ÇÅ) h =
  Bar.‚àÄùïé-inBarFunc inOpenBar-Bar (Œª w1 e1 ‚Üí weakMonEq-sym) h
eqInType-sym-rev u w A B a b (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) h =
  Bar.‚àÄùïé-inBarFunc
    inOpenBar-Bar
    (Œª w1 e1 (lift (n , m , c‚ÇÅ , c‚ÇÇ , d)) ‚Üí
      lift (n , m ,
              strongMonEq-pres-‚áì (strongMonEq-sym (strongMonEq-mon x‚ÇÇ w1 e1)) c‚ÇÅ ,
              strongMonEq-pres-‚áì (strongMonEq-sym (strongMonEq-mon x‚ÇÉ w1 e1)) c‚ÇÇ ,
              d))
    h
eqInType-sym-rev u w A B a b (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ) h = {!!}
eqInType-sym-rev u w A B a b (EQTFREE x x‚ÇÅ) h = {!!}
eqInType-sym-rev u w A B a b (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb) h =
  Bar.‚àÄùïé-inBarFunc
    inOpenBar-Bar
    (Œª w1 e1 z a‚ÇÅ b‚ÇÅ eqa ‚Üí
      eqInType-sym-rev
        u w1 (sub0 b‚ÇÅ B1) (sub0 a‚ÇÅ B2) (APPLY a b‚ÇÅ) (APPLY b a‚ÇÅ)
        {!eqtb w1 e1 b‚ÇÅ a‚ÇÅ (eqInType-sym u w1 A1 A2 a‚ÇÅ b‚ÇÅ (eqa w1 e1))!} --(eqtb w1 e1 b‚ÇÅ a‚ÇÅ (eqInType-sym u w1 A1 A2 a‚ÇÅ b‚ÇÅ (eqa w1 e1)))  -- eqTypes u w1 (sub0 b‚ÇÅ B1) (sub0 a‚ÇÅ B2)
        {!!})
    h
eqInType-sym-rev u w A B a b (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) h = {!!}
eqInType-sym-rev u w A B a b (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb) h = {!!}
eqInType-sym-rev u w A B a b (EQTEQ a1 b1 a2 b2 A‚ÇÅ B‚ÇÅ x x‚ÇÅ eqtA extA eqt1 eqt2) h = {!!}
eqInType-sym-rev u w A B a b (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB extA extB) h = {!!}
eqInType-sym-rev u w A B a b (EQTSQUASH A1 A2 x x‚ÇÅ eqtA) h = {!!}
eqInType-sym-rev u w A B a b (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA eqx) h = {!!}
eqInType-sym-rev u w A B a b (EQTUNIV x) h = {!!}
eqInType-sym-rev u w A B a b (EQTBAR x) h = {!!}
--}


{--if-equalInType-NAT : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (t‚ÇÅ t‚ÇÇ : CTerm)
                     ‚Üí equalInType u I w NAT t‚ÇÅ t‚ÇÇ
                     ‚Üí inOpenBar I w (Œª w1 e1 ‚Üí strongMonEq I w1 t‚ÇÅ t‚ÇÇ)
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTNAT x x‚ÇÅ , eqi) = eqi
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTQNAT x x‚ÇÅ , eqi) = ‚ä•-elim (NATneqQNAT (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ , eqi) = ‚ä•-elim (NATneqLT (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ , eqi) = ‚ä•-elim (NATneqQLT (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTFREE x x‚ÇÅ , eqi) = ‚ä•-elim (NATneqFREE (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb , eqi) = ‚ä•-elim (NATneqPI (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb , eqi) = ‚ä•-elim (NATneqSUM (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb , eqi) = ‚ä•-elim (NATneqSET (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTEQ a1 b1 a2 b2 A B x x‚ÇÅ eqtA eqt1 eqt2 , eqi) = ‚ä•-elim (NATneqEQ (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB , eqi) = ‚ä•-elim (NATneqUNION (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTSQUASH A1 A2 x x‚ÇÅ eqtA , eqi) = ‚ä•-elim (NATneqTSQUASH (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA eqx , eqi) = ‚ä•-elim (NATneqFFDEFS (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTUNIV x , eqi) =
  let (w1 , e1 , h) = x w ([]‚âΩ-refl I w) in
  let (c1 , c2) = h w1 ([]‚âΩ-refl I w1) in
  ‚ä•-elim (NATneqUNIV (compAllVal I c1 tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTBAR x , eqi) w1 e1 =
  let (w2 , e2 , eqi1) = eqi w1 e1 in
  let (w3 , e3 , x1) = x w1 e1 in
  let eqi2 = eqi1 w2 ([]‚âΩ-refl I w2) in
  let x2 = x1 w2 (extTrans ([]‚âΩ-refl I w2) e2) in
  let (w4 , e4 , z) = if-equalInType-NAT u I w2 t‚ÇÅ t‚ÇÇ (x2 , eqi2) w2 ([]‚âΩ-refl I w2) in
  (w4 , extTrans e4 (extTrans e2 e3) , z)
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTLOWER A1 A2 x x‚ÇÅ eqt , eqi) = ‚ä•-elim (NATneqLOWER (compAllVal I x‚ÇÅ tt))
if-equalInType-NAT u I w t‚ÇÅ t‚ÇÇ (EQTSHRINK A1 A2 x x‚ÇÅ eqt , eqi) = ‚ä•-elim (NATneqSHRINK (compAllVal I x‚ÇÅ tt))


¬¨strongMonEq01 : (I : Inh) (w : ùïé¬∑) ‚Üí ¬¨ strongMonEq I w (NUM 0) (NUM 1)
¬¨strongMonEq01 I w (n , c‚ÇÅ , c‚ÇÇ) = eb
  where
    ea : NUM 0 ‚â° NUM 1
    ea rewrite compAllVal I c‚ÇÅ tt | compAllVal I c‚ÇÇ tt = refl

    eb : ‚ä•
    eb with ea
    ... | ()


VOID : CTerm
VOID = EQ (NUM 0) (NUM 1) NAT


weak-consistency : (w : ùïé¬∑) ‚Üí ¬¨ Œ£ Term (Œª t ‚Üí eqintype w VOID t t)
weak-consistency w (t , u , n , k , c) = ¬¨strongMonEq01 I w2 ea5
  where
    ea1 : eqintypeN u n (k + n) w VOID t t
    ea1 = c n ‚â§-refl

    I : Inh
    I = inhN u n (k + n)

    ea2 : inOpenBar I w (Œª w' e' ‚Üí [ I ] t ‚áõ AX at w' √ó [ I ] t ‚áõ AX at w' √ó equalInType u I w' NAT (NUM 0) (NUM 1))
    ea2 = if-equalInType-EQ u I w NAT (NUM 0) (NUM 1) t t ea1

    w1 : ùïé¬∑
    w1 = proj‚ÇÅ (ea2 w ([]‚âΩ-refl I w))

    e1 : [ I ] w1 ‚™∞ w
    e1 = proj‚ÇÅ (proj‚ÇÇ (ea2 w ([]‚âΩ-refl I w)))

    ea3 : equalInType u I w1 NAT (NUM 0) (NUM 1)
    ea3 = proj‚ÇÇ (proj‚ÇÇ (proj‚ÇÇ (proj‚ÇÇ (ea2 w ([]‚âΩ-refl I w))) w1 ([]‚âΩ-refl I w1)))

    ea4 : inOpenBar I w1 (Œª w1 e1 ‚Üí strongMonEq I w1 (NUM 0) (NUM 1))
    ea4 = if-equalInType-NAT u I w1 (NUM 0) (NUM 1) ea3

    w2 : ùïé¬∑
    w2 = proj‚ÇÅ (ea4 w1 ([]‚âΩ-refl I w1))

    e2 : [ I ] w2 ‚™∞ w1
    e2 = proj‚ÇÅ (proj‚ÇÇ (ea4 w1 ([]‚âΩ-refl I w1)))

    ea5 : strongMonEq I w2 (NUM 0) (NUM 1)
    ea5 = proj‚ÇÇ (proj‚ÇÇ (ea4 w1 ([]‚âΩ-refl I w1))) w2 ([]‚âΩ-refl I w2)
--}
\end{code}


%Let us now prove further results about this semantics


\begin{code}[hide]
{--
-- ---------------------------------
-- Some simple lemmas
‚àÄùïéimpliesinOpenBar : {I : Inh} {w : ùïé¬∑} {f : wPred I w} ‚Üí ‚àÄùïé I w f ‚Üí inOpenBar I w f
‚àÄùïéimpliesinOpenBar {I} {w} {f} h w1 e1 = (w1 , ([]‚âΩ-refl I _ , Œª w2 e2 ‚Üí h w2 ([]‚âΩ-trans {I} e2 _)))

eqTypesNAT : (w : ùïé¬∑) (I : Inh) (u : univs) ‚Üí eqTypes u I w NAT NAT
eqTypesNAT w I u =
  EQTNAT (compAllRefl I NAT w) (compAllRefl I NAT w)

strongMonEqN0 : (I : Inh) (w : ùïé¬∑) ‚Üí strongMonEq I w N0 N0
strongMonEqN0 I w =  (0 , (compAllRefl I N0 w , compAllRefl I N0 w))

allInOpenBarStrongMonEqN0 : (I : Inh) (w : ùïé¬∑) ‚Üí ‚àÄùïé I w (Œª w' e ‚Üí inOpenBar I w' (Œª w'' _ ‚Üí strongMonEq I w'' N0 N0))
allInOpenBarStrongMonEqN0 I w w1 e1 w2 e2 = (w2 , ([]‚âΩ-refl I _ , Œª w3 e3 ‚Üí strongMonEqN0 I w3))

eqTypesTRUE : (w : ùïé¬∑) (I : Inh) (u : univs) ‚Üí eqTypes u I w TRUE TRUE
eqTypesTRUE w I u =
  EQTEQ N0 N0 N0 N0 NAT NAT
        (compAllRefl I (EQ N0 N0 NAT) w)
        (compAllRefl I (EQ N0 N0 NAT) w)
        (Œª w1 e1 ‚Üí eqTypesNAT _ _ _)
        (allInOpenBarStrongMonEqN0 I w)
        (allInOpenBarStrongMonEqN0 I w)



-- wPredExtIrr
wPredExtIrr-equalInType : (u : ‚Ñï) (I1 I2 : Inh) (w : ùïé¬∑) (T a b : CTerm)
                          ‚Üí wPredExtIrr {I1} {w} (Œª w1 e1 ‚Üí equalInType u I2 w1 T a b)
wPredExtIrr-equalInType u I1 I2 w T a b w' e1 e2 h = h


wPredExtIrr-eqTypes : (u : univs) (I1 I2 : Inh) (w : ùïé¬∑) (A B : CTerm)
                      ‚Üí wPredExtIrr {I1} {w} (Œª w1 e1 ‚Üí eqTypes u I2 w1 A B)
wPredExtIrr-eqTypes u I1 I2 w A B w' e1 e2 h = h




eqUnivi-mon : (i : ‚Ñï) ‚Üí mon (eqUnivi i)
eqUnivi-mon i {a} {b} I {w} h w1 e1 =
  inOpenBar-mon I {w1} {w} {Œª w' _ ‚Üí [ I ] a #‚áõ (#UNIV i) at w' √ó [ I ] b #‚áõ (#UNIV i) at w'} (Œª w' e2 e3 h ‚Üí h) e1 h


eqInUnivi-mon : (i : ‚Ñï) ‚Üí mon (eqInUnivi i)
eqInUnivi-mon (suc i) {a} {b} I {w} (inj‚ÇÅ x) w1 e1 =
  inj‚ÇÅ (eqTypes-mon (i , eqUnivi i , eqInUnivi i) (eqUnivi-mon i) I x w1 e1)
eqInUnivi-mon (suc i) {a} {b} I {w} (inj‚ÇÇ y) w1 e1 =
  inj‚ÇÇ (eqInUnivi-mon i I y w1 e1)



-- SET
SETinj1 : {a b : CTerm} {c d : CTerm} ‚Üí SET a c ‚â° SET b d ‚Üí a ‚â° b
SETinj1 refl =  refl

SETinj2 : {a b : CTerm} {c d : CTerm} ‚Üí SET a c ‚â° SET b d ‚Üí c ‚â° d
SETinj2 refl =  refl


-- SET
SETneqNAT : {a : CTerm} {b : CTerm} ‚Üí ¬¨ (SET a b) ‚â° NAT
SETneqNAT {a} {b} ()

SETneqQNAT : {a : CTerm} {b : CTerm} ‚Üí ¬¨ (SET a b) ‚â° QNAT
SETneqQNAT {a} {b} ()

SETneqLT : {a : CTerm} {b : CTerm} {c d : CTerm} ‚Üí ¬¨ (SET a b) ‚â° LT c d
SETneqLT {a} {b} {c} {d} ()

SETneqQLT : {a : CTerm} {b : CTerm} {c d : CTerm} ‚Üí ¬¨ (SET a b) ‚â° QLT c d
SETneqQLT {a} {b} {c} {d} ()

SETneqFREE : {a : CTerm} {b : CTerm} ‚Üí ¬¨ (SET a b) ‚â° FREE
SETneqFREE {a} {b} ()

SETneqPI : {a : CTerm} {b : CTerm} {c : CTerm} {d : CTerm} ‚Üí ¬¨ (SET a b) ‚â° PI c d
SETneqPI {a} {b} {c} {d} ()

SETneqSUM : {a : CTerm} {b : CTerm} {c : CTerm} {d : CTerm} ‚Üí ¬¨ (SET a b) ‚â° SUM c d
SETneqSUM {a} {b} {c} {d} ()

SETneqUNION : {a : CTerm} {b : CTerm} {c : CTerm} {d : CTerm} ‚Üí ¬¨ (SET a b) ‚â° UNION c d
SETneqUNION {a} {b} {c} {d} ()

SETneqTSQUASH : {a : CTerm} {b : CTerm} {c : CTerm} ‚Üí ¬¨ (SET a b) ‚â° TSQUASH c
SETneqTSQUASH {a} {b} {c} ()

SETneqEQ : {a : CTerm} {b : CTerm} {c d e : CTerm} ‚Üí ¬¨ (SET a b) ‚â° EQ c d e
SETneqEQ {a} {b} {c} {d} {e} ()

SETneqFFDEFS : {a : CTerm} {b : CTerm} {c d : CTerm} ‚Üí ¬¨ (SET a b) ‚â° FFDEFS c d
SETneqFFDEFS {a} {b} {c} {d} ()

SETneqLOWER : {a : CTerm} {b : CTerm} {c : CTerm} ‚Üí ¬¨ (SET a b) ‚â° LOWER c
SETneqLOWER {a} {b} {c} ()

SETneqSHRINK : {a : CTerm} {b : CTerm} {c : CTerm} ‚Üí ¬¨ (SET a b) ‚â° SHRINK c
SETneqSHRINK {a} {b} {c} ()

SETneqUNIV : {a : CTerm} {b : CTerm} {n : ‚Ñï} ‚Üí ¬¨ (SET a b) ‚â° UNIV n
SETneqUNIV {a} {b} {n} ()


-- LOWER
LOWERneqNAT : {a : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° NAT
LOWERneqNAT {a} ()

LOWERneqQNAT : {a : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° QNAT
LOWERneqQNAT {a} ()

LOWERneqLT : {a : CTerm} {c d : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° LT c d
LOWERneqLT {a} {c} {d} ()

LOWERneqQLT : {a : CTerm} {c d : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° QLT c d
LOWERneqQLT {a} {c} {d} ()

LOWERneqFREE : {a : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° FREE
LOWERneqFREE {a} ()

LOWERneqPI : {a : CTerm} {c : CTerm} {d : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° PI c d
LOWERneqPI {a} {c} {d} ()

LOWERneqSUM : {a : CTerm} {c : CTerm} {d : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° SUM c d
LOWERneqSUM {a} {c} {d} ()

LOWERneqSET : {a : CTerm} {c : CTerm} {d : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° SET c d
LOWERneqSET {a} {c} {d} ()

LOWERneqUNION : {a : CTerm} {c : CTerm} {d : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° UNION c d
LOWERneqUNION {a} {c} {d} ()

LOWERneqTSQUASH : {a : CTerm} {c : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° TSQUASH c
LOWERneqTSQUASH {a} {c} ()

LOWERneqEQ : {a : CTerm} {c d e : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° EQ c d e
LOWERneqEQ {a} {c} {d} {e} ()

LOWERneqFFDEFS : {a : CTerm} {c d : CTerm} ‚Üí ¬¨ (LOWER a) ‚â° FFDEFS c d
LOWERneqFFDEFS {a} {c} {d} ()

LOWERneqUNIV : {a : CTerm} {n : ‚Ñï} ‚Üí ¬¨ (LOWER a) ‚â° UNIV n
LOWERneqUNIV {a} {n} ()

LOWERneqSHRINK : {a b : CTerm} ‚Üí ¬¨ LOWER a ‚â° SHRINK b
LOWERneqSHRINK {a} {b} ()

LOWERinj : {a b : CTerm} ‚Üí LOWER a ‚â° LOWER b ‚Üí a ‚â° b
LOWERinj refl =  refl

compAllLOWER : {I : Inh} {w : ùïé¬∑} {a b : CTerm} ‚Üí [ I ] LOWER a ‚áõ LOWER b at w ‚Üí a ‚â° b
compAllLOWER {I} {w} {a} {b} e = LOWERinj (compAllVal I e tt)


-- SHRINK
SHRINKneqNAT : {a : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° NAT
SHRINKneqNAT {a} ()

SHRINKneqQNAT : {a : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° QNAT
SHRINKneqQNAT {a} ()

SHRINKneqLT : {a : CTerm} {c d : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° LT c d
SHRINKneqLT {a} {c} {d} ()

SHRINKneqQLT : {a : CTerm} {c d : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° QLT c d
SHRINKneqQLT {a} {c} {d} ()

SHRINKneqFREE : {a : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° FREE
SHRINKneqFREE {a} ()

SHRINKneqPI : {a : CTerm} {c : CTerm} {d : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° PI c d
SHRINKneqPI {a} {c} {d} ()

SHRINKneqSUM : {a : CTerm} {c : CTerm} {d : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° SUM c d
SHRINKneqSUM {a} {c} {d} ()

SHRINKneqSET : {a : CTerm} {c : CTerm} {d : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° SET c d
SHRINKneqSET {a} {c} {d} ()

SHRINKneqUNION : {a : CTerm} {c : CTerm} {d : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° UNION c d
SHRINKneqUNION {a} {c} {d} ()

SHRINKneqTSQUASH : {a : CTerm} {c : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° TSQUASH c
SHRINKneqTSQUASH {a} {c} ()

SHRINKneqEQ : {a : CTerm} {c d e : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° EQ c d e
SHRINKneqEQ {a} {c} {d} {e} ()

SHRINKneqFFDEFS : {a : CTerm} {c d : CTerm} ‚Üí ¬¨ (SHRINK a) ‚â° FFDEFS c d
SHRINKneqFFDEFS {a} {c} {d} ()

SHRINKneqUNIV : {a : CTerm} {n : ‚Ñï} ‚Üí ¬¨ (SHRINK a) ‚â° UNIV n
SHRINKneqUNIV {a} {n} ()

SHRINKneqLOWER : {a b : CTerm} ‚Üí ¬¨ SHRINK a ‚â° LOWER b
SHRINKneqLOWER {a} {b} ()

SHRINKinj : {a b : CTerm} ‚Üí SHRINK a ‚â° SHRINK b ‚Üí a ‚â° b
SHRINKinj refl =  refl

compAllSHRINK : {I : Inh} {w : ùïé¬∑} {a b : CTerm} ‚Üí [ I ] SHRINK a ‚áõ SHRINK b at w ‚Üí a ‚â° b
compAllSHRINK {I} {w} {a} {b} e = SHRINKinj (compAllVal I e tt)



closedlamAX : # lamAX
closedlamAX v ()

closedAX : # AX
closedAX v ()

sublamAX : (t : CTerm) ‚Üí sub t lamAX ‚â° lamAX
sublamAX t = subNotIn t lamAX closedAX

subAX : (t : CTerm) ‚Üí sub t AX ‚â° AX
subAX t = subNotIn t AX closedAX

closedNAT : # NAT
closedNAT v ()

closedLNAT : # LNAT
closedLNAT v ()

subNAT : (t : CTerm) ‚Üí sub t NAT ‚â° NAT
subNAT t = subNotIn t NAT closedNAT

subLNAT : (t : CTerm) ‚Üí sub t LNAT ‚â° LNAT
subLNAT t = subNotIn t LNAT closedLNAT

eqFun : {a b c d : CTerm} ‚Üí a ‚â° b ‚Üí c ‚â° d ‚Üí FUN a c ‚â° FUN b d
eqFun {a} {b} {c} {d} e f rewrite e rewrite f = refl

closedLe : {u : CTerm} ‚Üí # u ‚Üí (v : Var) ‚Üí ((w : Var) ‚Üí v ‚â§ w ‚Üí w # u)
closedLe {u} c v w j = c w

subacFun : (t : CTerm) ‚Üí # t ‚Üí sub t acFun ‚â° FUN (acHypPi t) (acConclP t)
subacFun t c
  rewrite shiftUpTrivial 0 t (closedLe {t} c 0)
  rewrite shiftUpTrivial 0 t (closedLe {t} c 0)
  rewrite shiftUpTrivial 0 t (closedLe {t} c 0)
  rewrite shiftUpTrivial 0 t (closedLe {t} c 0)
  rewrite shiftDownTrivial 3 t (closedLe {t} c 3)
  rewrite shiftUpTrivial 0 t (closedLe {t} c 0)
  rewrite shiftDownTrivial 4 t (closedLe {t} c 4) = eqFun refl refl

notinnil : {A : Set} (l : List A) ‚Üí ((v : A) ‚Üí ¬¨ (v ‚àà l)) ‚Üí l ‚â° []
notinnil {A} [] i = refl
notinnil {A} (x ‚à∑ l) i = ‚ä•-elim (i x (here refl))

closedfvarsnil : (t : CTerm) ‚Üí # t ‚Üí fvars t ‚â° []
closedfvarsnil t c = notinnil (fvars t) c

innilfalse : {A : Set} (v : A) ‚Üí v ‚àà [] ‚Üí ‚ä•
innilfalse {A} v ()

closedacConclP : (P : CTerm) ‚Üí # P ‚Üí # (acConclP P)
closedacConclP P c v i
  rewrite lowerVarsApp (fvars P ++ 0 ‚à∑ []) (1 ‚à∑ 0 ‚à∑ [])
  rewrite lowerVarsApp (fvars P) (0 ‚à∑ [])
  rewrite lowerVarsApp (lowerVars (fvars P) ++ []) (0 ‚à∑ [])
  rewrite lowerVarsApp (lowerVars (lowerVars (fvars P) ++ [])) (0 ‚à∑ [])
  rewrite closedfvarsnil P c = innilfalse v i

equalInType-eqTypes : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (A a b : CTerm)
                      ‚Üí equalInType u I w A a b
                      ‚Üí equalTypes u I w A A
equalInType-eqTypes u I w A a b (eqt , eqi) = eqt

inOpenBarEqualInType-inOpenBarEqTypes : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (A a b : CTerm)
                                        ‚Üí inOpenBar I w (Œª w' _ ‚Üí equalInType u I w' A a b)
                                        ‚Üí inOpenBar I w (Œª w' _ ‚Üí equalTypes u I w' A A)
inOpenBarEqualInType-inOpenBarEqTypes u I w A a b h w1 e1 =
  let (w2 , (e2 , eqt2)) = h w1 e1 in
  (w2 , (e2 , Œª w3 e3 ‚Üí fst (eqt2 w3 e3)))

inOpenBarStrongMonEqNUM : (I : Inh) (w : ùïé¬∑) (n : ‚Ñï)
                          ‚Üí inOpenBar I w (Œª w1 e1 ‚Üí strongMonEq I w1 (NUM n) (NUM n))
inOpenBarStrongMonEqNUM I w n w1 e1 =
  (w1 , ([]‚âΩ-refl I w1 , Œª w2 e2 ‚Üí (n , (compAllRefl I (NUM n) w2 , compAllRefl I (NUM n) w2))))

equalInTypeNAT : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (t‚ÇÅ t‚ÇÇ : CTerm)
                ‚Üí inOpenBar I w (Œª w1 e1 ‚Üí strongMonEq I w1 t‚ÇÅ t‚ÇÇ)
                ‚Üí equalInType u I w NAT t‚ÇÅ t‚ÇÇ
equalInTypeNAT u I w t‚ÇÅ t‚ÇÇ e = (eqTypesNAT w I (uni u) , e)

equalInTypeNAT2 : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (t‚ÇÅ t‚ÇÇ : CTerm)
                ‚Üí strongMonEq I w t‚ÇÅ t‚ÇÇ
                ‚Üí equalInType u I w NAT t‚ÇÅ t‚ÇÇ
equalInTypeNAT2 u I w t‚ÇÅ t‚ÇÇ e =
  equalInTypeNAT u I w t‚ÇÅ t‚ÇÇ
    Œª w1 e1 ‚Üí (w1 , []‚âΩ-refl I w1 , Œª w2 e2 ‚Üí strongMonEq-mon I e w2 ([]‚âΩ-trans {I} e2 e1))

numInNAT : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (n : ‚Ñï)
           ‚Üí equalInType u I w NAT (NUM n) (NUM n)
numInNAT u I w n = equalInTypeNAT u I w (NUM n) (NUM n) (inOpenBarStrongMonEqNUM I w n)


inOpenBarMP : (I : Inh) (w : ùïé¬∑) (f g : wPred I w)
              ‚Üí ‚àÄùïé I w (Œª w1 e1 ‚Üí f w1 e1 ‚Üí g w1 e1)
              ‚Üí inOpenBar I w f ‚Üí inOpenBar I w g
inOpenBarMP I w f g i j w1 e1 =
  let (w2 , (e2 , h)) = j w1 e1 in
  (w2 , (e2 , Œª w3 e3 ‚Üí let z = h w3 e3 in i w3 ([]‚âΩ-trans {I} e3 ([]‚âΩ-trans {I} e2 e1)) z))

inOpenBarIdem : (I : Inh) (w : ùïé¬∑) (f : wPred I w) (c : wPredExtIrr {I} {w} f)
                ‚Üí inOpenBar I w (Œª w1 e1 ‚Üí inOpenBar I w1 (‚ÜëwPred I f e1))
                ‚Üí inOpenBar I w f
inOpenBarIdem I w f c i w1 e1 =
  let (w2 , (e2 , i1)) = i w1 e1 in
  let (w3 , (e3 , i2)) = i1 _ ([]‚âΩ-refl I _) _ ([]‚âΩ-refl I _) in
  (w3 , ([]‚âΩ-trans {I} e3 e2 , Œª w4 e4 ‚Üí let i3 = i2 w4 e4 in c w4 _ _ i3))


substEqTeq : (u : univs) (I1 I2 : Inh) (w : ùïé¬∑) (A1 A2 B1 B2 a‚ÇÅ a‚ÇÇ : CTerm)
             (eqt : eqTypes u I1 w A1 B1) (eqi : eqInType u I1 w eqt a‚ÇÅ a‚ÇÇ)
             ‚Üí I1 ‚â° I2
             ‚Üí A1 ‚â° A2
             ‚Üí B1 ‚â° B2
             ‚Üí Œ£ (eqTypes u I2 w A2 B2) (Œª eqt ‚Üí eqInType u I2 w eqt a‚ÇÅ a‚ÇÇ)
substEqTeq u I1 I2 w A1 A2 B1 B2 a‚ÇÅ a‚ÇÇ eqt eqi e1 e2 e3 rewrite e1 | e2 | e3 = (eqt , eqi)

strongMonEqsym : (I : Inh) {w : ùïé¬∑} {a b : CTerm} ‚Üí strongMonEq I w a b ‚Üí strongMonEq I w b a
strongMonEqsym I {w} {a} {b} (n , c1 , c2) = (n , c2 , c1)

inOpenBarstrongMonEqsym : (I : Inh) {w : ùïé¬∑} {a b : CTerm}
                          ‚Üí inOpenBar I w (Œª w' _ ‚Üí strongMonEq I w' a b)
                          ‚Üí inOpenBar I w (Œª w' _ ‚Üí strongMonEq I w' b a)
inOpenBarstrongMonEqsym I {w} {a} {b} h w1 e1 =
  let (w2 , e2 , z) = h w1 e1 in
  (w2 , e2 , Œª w3 e3 ‚Üí strongMonEqsym I (z w3 e3))

weakMonEqsym : (I : Inh) {w : ùïé¬∑} {a b : CTerm} ‚Üí weakMonEq I w a b ‚Üí weakMonEq I w b a
weakMonEqsym I {w} {a} {b} m w1 e1 = let (n , c1 , c2) = m _ e1 in (n , c2 , c1)

inOpenBarweakMonEqsym : (I : Inh) {w : ùïé¬∑} {a b : CTerm}
                          ‚Üí inOpenBar I w (Œª w' _ ‚Üí weakMonEq I w' a b)
                          ‚Üí inOpenBar I w (Œª w' _ ‚Üí weakMonEq I w' b a)
inOpenBarweakMonEqsym I {w} {a} {b} h w1 e1 =
  let (w2 , e2 , z) = h _ e1 in
   (_ , e2 , Œª w3 e3 ‚Üí weakMonEqsym I (z _ e3))

eqSQUASH : {a b : CTerm} ‚Üí a ‚â° b ‚Üí SQUASH a ‚â° SQUASH b
eqSQUASH {a} {b} e rewrite e = refl

eqAPPLY : {a b c d : CTerm} ‚Üí a ‚â° b ‚Üí c ‚â° d ‚Üí APPLY a c ‚â° APPLY b d
eqAPPLY {a} {b} {c} {d} e‚ÇÅ e‚ÇÇ rewrite e‚ÇÅ | e‚ÇÇ = refl

eqLAPPLY : {a b c d : CTerm} ‚Üí a ‚â° b ‚Üí c ‚â° d ‚Üí LAPPLY a c ‚â° LAPPLY b d
eqLAPPLY {a} {b} {c} {d} e‚ÇÅ e‚ÇÇ rewrite e‚ÇÅ | e‚ÇÇ = refl

sub-NUM-SQUASH-SUM : (n : ‚Ñï) (p : CTerm) ‚Üí # p ‚Üí
                     sub (NUM n) (SQUASH (SUM LNAT (LAPPLY2 p (VAR 2) (VAR 0))))
                     ‚â° SQUASH (SUM LNAT (LAPPLY2 p (NUM n) (VAR 0)))
sub-NUM-SQUASH-SUM n p cp rewrite subvNotIn 2 (NUM n) p (cp _)
                                | shiftDownTrivial 2 p (Œª w c ‚Üí cp _) = eqSQUASH refl


sub-LAPPLY2-NUM-VAR : (t p : CTerm) (n : ‚Ñï) ‚Üí # p ‚Üí sub t (LAPPLY2 p (NUM n) (VAR 0)) ‚â° LAPPLY2 p (NUM n) t
sub-LAPPLY2-NUM-VAR t p n cp rewrite subvNotIn 0 (shiftUp 0 t) p (cp _)
                                   | shiftDownTrivial 0 p (Œª w c ‚Üí cp _)
                                   | shiftDownUp t 0 = eqLAPPLY refl refl

equalInTypesubLAPPLY2 : {u : ‚Ñï} {I : Inh} {w : ùïé¬∑} {p t a b : CTerm} {n : ‚Ñï}
                       ‚Üí # p
                       ‚Üí equalInType u I w (sub0 t (LAPPLY2 p (NUM n) (VAR 0))) a b
                       ‚Üí equalInType u I w (LAPPLY2 p (NUM n) t) a b
equalInTypesubLAPPLY2 {u} {I} {w} {p} {t} {a} {b} {n} cp e rewrite sub-LAPPLY2-NUM-VAR t p n cp = e

#APPLY2-NUM : (p m : CTerm) (n : ‚Ñï) ‚Üí # p ‚Üí # m ‚Üí # APPLY2 p (NUM n) m
#APPLY2-NUM p m n cp cm v i rewrite ++[] (fvars p) with ‚àà-++‚Åª (fvars p) i
... | inj‚ÇÅ x = cp _ x
... | inj‚ÇÇ x = cm _ x


wPredExtIrrFun-allI-equalInType : (u : ‚Ñï) (I1 I2 : Inh) (w : ùïé¬∑) (T a b : CTerm)
                                  ‚Üí wPredExtIrr {I1} {w} (Œª w1 e1 ‚Üí allI I2 (Œª i ‚Üí equalInType u i w1 T a b))
wPredExtIrrFun-allI-equalInType u I1 I2 w T a b w' e1 e2 h = h



-- LOWER properties
eqTypesLOWER : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (T a‚ÇÅ a‚ÇÇ : CTerm) (wf : wfInh< I)
               ‚Üí inOpenBar I w (Œª w' _ ‚Üí allI (lower I) (Œª i ‚Üí equalInType u i w' T a‚ÇÅ a‚ÇÇ))
               ‚Üí eqTypes (uni u) I w (LOWER T) (LOWER T)
eqTypesLOWER u I w T a‚ÇÅ a‚ÇÇ wf h = EQTBAR e
  where
    e : inOpenBar I w (Œª w' _ ‚Üí eqTypes (uni u) I w' (LOWER T) (LOWER T))
    e = Œª w1 e1 ‚Üí let (w2 , e2 , a2) = h w1 e1 in
          (w2 , e2 , Œª w3 e3 ‚Üí
          EQTLOWER T T (compAllRefl I (LOWER T) w3) (compAllRefl I (LOWER T) w3)
            Œª w4 e4 ‚Üí let a3 = a2 w4 ([]‚âΩ-trans {I} e4 e3) in
            Œª j c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ ‚Üí let (eqt , eqi) = a3 j c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ in eqt)


impliesEqualInTypeLower : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (T a‚ÇÅ a‚ÇÇ : CTerm)
                          ‚Üí ‚àÄùïé I w (Œª w' _ ‚Üí allI (lower I) (Œª i ‚Üí equalInType u i w' T a‚ÇÅ a‚ÇÇ))
                          ‚Üí equalInType u I w (LOWER T) a‚ÇÅ a‚ÇÇ
impliesEqualInTypeLower u I w T a‚ÇÅ a‚ÇÇ e =
  let e' : ‚àÄùïé I w (Œª w' _ ‚Üí allI (lower I) (Œª i ‚Üí eqTypes (uni u) i w' T T))
      e' = (Œª w1 e1 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ ‚Üí let (eqt , eqi) = e w1 e1 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ in eqt) in
   (EQTLOWER T T (compAllRefl I (LOWER T) w) (compAllRefl I (LOWER T) w) e' ,
    ‚àÄùïéimpliesinOpenBar {I} {w} Œª w1 e1 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ ‚Üí proj‚ÇÇ (e w1 e1 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ))


equalInTypeLower : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (T a‚ÇÅ a‚ÇÇ : CTerm)
                   ‚Üí equalInType u I w (LOWER T) a‚ÇÅ a‚ÇÇ
                   ‚Üí inOpenBar I w (Œª w1 e1 ‚Üí allI (lower I) (Œª i ‚Üí equalInType u i w1 T a‚ÇÅ a‚ÇÇ))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTNAT x x‚ÇÅ , eqi) = ‚ä•-elim (LOWERneqNAT (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTQNAT x x‚ÇÅ , eqi) = ‚ä•-elim (LOWERneqQNAT (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ , eqi) = ‚ä•-elim (LOWERneqLT (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ , eqi) = ‚ä•-elim (LOWERneqQLT (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTFREE x x‚ÇÅ , eqi) = ‚ä•-elim (LOWERneqFREE (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb , eqi) = ‚ä•-elim (LOWERneqPI (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb , eqi) = ‚ä•-elim (LOWERneqSUM (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb , eqi) = ‚ä•-elim (LOWERneqSET (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTEQ a1 b1 a2 b2 A B x x‚ÇÅ eqtA eqt1 eqt2 , eqi) = ‚ä•-elim (LOWERneqEQ (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB , eqi) = ‚ä•-elim (LOWERneqUNION (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTSQUASH A1 A2 x x‚ÇÅ eqtA , eqi) = ‚ä•-elim (LOWERneqTSQUASH (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA eqx , eqi) = ‚ä•-elim (LOWERneqFFDEFS (compAllVal I x‚ÇÅ tt))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTUNIV x , eqi) =
  let (w1 , e1 , e) = x w ([]‚âΩ-refl I w) in
  let (c1 , c2) = e w1 ([]‚âΩ-refl I w1) in
  let c = compAllVal I c1 tt in
  ‚ä•-elim (LOWERneqUNIV c)
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTBAR x , eqi) =
  inOpenBarIdem
    I w _ (wPredExtIrrFun-allI-equalInType u I (lower I) w T a‚ÇÅ a‚ÇÇ)
    Œª w1 e1 ‚Üí
     let (w2' , e2' , eqi1) = eqi w1 e1 in
     let (w2 , e2 , x1) = x w1 e1 in
      (w2' , ([]‚âΩ-trans {I} e2' e2 , Œª w3 e3 ‚Üí
        let x2 = x1 w3 ([]‚âΩ-trans {I} e3 e2') in
        let eqi2 = eqi1 w3 e3 in
        equalInTypeLower u I w3 T a‚ÇÅ a‚ÇÇ (x2 , eqi2) ))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTLOWER A1 A2 x x‚ÇÅ eqt , eqi) =
  Œª w1 e1 ‚Üí
    let (w2' , e2' , eqi1) = eqi w1 e1 in
    (w2' , e2' , Œª w3 e3 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ ‚Üí
      let eqi2 = eqi1 w3 e3 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ in
      let eqt2 = eqt w3 ([]‚âΩ-trans {I} e3 ([]‚âΩ-trans {I} e2' e1)) i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ in
      let eq1 = compAllLOWER {I} x in
      let eq2 = compAllLOWER {I} x‚ÇÅ in
      substEqTeq (uni u) _ _ w3 A1 T A2 T a‚ÇÅ a‚ÇÇ eqt2 eqi2 refl (sym eq1) (sym eq2))
equalInTypeLower u I w T a‚ÇÅ a‚ÇÇ (EQTSHRINK A1 A2 x x‚ÇÅ eqt , eqi) = ‚ä•-elim (LOWERneqSHRINK (compAllVal I x‚ÇÅ tt))


-- SHRINK properties
eqTypesSHRINK : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (T a‚ÇÅ a‚ÇÇ : CTerm) (wf : wfInh< I)
               ‚Üí inOpenBar I w (Œª w' _ ‚Üí allI (shrink I) (Œª i ‚Üí equalInType u i w' T a‚ÇÅ a‚ÇÇ))
               ‚Üí eqTypes (uni u) I w (SHRINK T) (SHRINK T)
eqTypesSHRINK u I w T a‚ÇÅ a‚ÇÇ wf h = EQTBAR e
  where
    e : inOpenBar I w (Œª w' _ ‚Üí eqTypes (uni u) I w' (SHRINK T) (SHRINK T))
    e = Œª w1 e1 ‚Üí let (w2 , e2 , a2) = h w1 e1 in
          (w2 , e2 , Œª w3 e3 ‚Üí
          EQTSHRINK T T (compAllRefl I (SHRINK T) w3) (compAllRefl I (SHRINK T) w3)
            Œª w4 e4 ‚Üí let a3 = a2 w4 ([]‚âΩ-trans {I} e4 e3) in
            Œª j c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ ‚Üí let (eqt , eqi) = a3 j c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ in eqt)

impliesEqualInTypeShrink : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (T a‚ÇÅ a‚ÇÇ : CTerm)
                          ‚Üí ‚àÄùïé I w (Œª w' _ ‚Üí allI (shrink I) (Œª i ‚Üí equalInType u i w' T a‚ÇÅ a‚ÇÇ))
                          ‚Üí equalInType u I w (SHRINK T) a‚ÇÅ a‚ÇÇ
impliesEqualInTypeShrink u I w T a‚ÇÅ a‚ÇÇ e =
  let e' : ‚àÄùïé I w (Œª w' _ ‚Üí allI (shrink I) (Œª i ‚Üí eqTypes (uni u) i w' T T))
      e' = (Œª w1 e1 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ ‚Üí let (eqt , eqi) = e w1 e1 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ in eqt) in
   (EQTSHRINK T T (compAllRefl I (SHRINK T) w) (compAllRefl I (SHRINK T) w) e' ,
    ‚àÄùïéimpliesinOpenBar {I} {w} Œª w1 e1 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ ‚Üí proj‚ÇÇ (e w1 e1 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ))

equalInTypeShrink : (u : ‚Ñï) (I : Inh) (w : ùïé¬∑) (T a‚ÇÅ a‚ÇÇ : CTerm)
                   ‚Üí equalInType u I w (SHRINK T) a‚ÇÅ a‚ÇÇ
                   ‚Üí inOpenBar I w (Œª w1 e1 ‚Üí allI (shrink I) (Œª i ‚Üí equalInType u i w1 T a‚ÇÅ a‚ÇÇ))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTNAT x x‚ÇÅ , eqi) = ‚ä•-elim (SHRINKneqNAT (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTQNAT x x‚ÇÅ , eqi) = ‚ä•-elim (SHRINKneqQNAT (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ , eqi) = ‚ä•-elim (SHRINKneqLT (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTQLT a1 a2 b1 b2 x x‚ÇÅ x‚ÇÇ x‚ÇÉ , eqi) = ‚ä•-elim (SHRINKneqQLT (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTFREE x x‚ÇÅ , eqi) = ‚ä•-elim (SHRINKneqFREE (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTPI A1 B1 A2 B2 x x‚ÇÅ eqta eqtb exta extb , eqi) = ‚ä•-elim (SHRINKneqPI (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTSUM A1 B1 A2 B2 x x‚ÇÅ eqta eqtb , eqi) = ‚ä•-elim (SHRINKneqSUM (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTSET A1 B1 A2 B2 x x‚ÇÅ eqta eqtb , eqi) = ‚ä•-elim (SHRINKneqSET (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTEQ a1 b1 a2 b2 A B x x‚ÇÅ eqtA eqt1 eqt2 , eqi) = ‚ä•-elim (SHRINKneqEQ (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTUNION A1 B1 A2 B2 x x‚ÇÅ eqtA eqtB , eqi) = ‚ä•-elim (SHRINKneqUNION (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTSQUASH A1 A2 x x‚ÇÅ eqtA , eqi) = ‚ä•-elim (SHRINKneqTSQUASH (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQFFDEFS A1 A2 x1 x2 x x‚ÇÅ eqtA eqx , eqi) = ‚ä•-elim (SHRINKneqFFDEFS (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTUNIV x , eqi) =
  let (w1 , e1 , e) = x w ([]‚âΩ-refl I w) in
  let (c1 , c2) = e w1 ([]‚âΩ-refl I w1) in
  let c = compAllVal I c1 tt in
  ‚ä•-elim (SHRINKneqUNIV c)
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTBAR x , eqi) =
  inOpenBarIdem
    I w _ (wPredExtIrrFun-allI-equalInType u I (shrink I) w T a‚ÇÅ a‚ÇÇ)
    Œª w1 e1 ‚Üí
     let (w2' , e2' , eqi1) = eqi w1 e1 in
     let (w2 , e2 , x1) = x w1 e1 in
      (w2' , ([]‚âΩ-trans {I} e2' e2 , Œª w3 e3 ‚Üí
        let x2 = x1 w3 ([]‚âΩ-trans {I} e3 e2') in
        let eqi2 = eqi1 w3 e3 in
        equalInTypeShrink u I w3 T a‚ÇÅ a‚ÇÇ (x2 , eqi2) ))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTLOWER A1 A2 x x‚ÇÅ eqt , eqi) = ‚ä•-elim (SHRINKneqLOWER (compAllVal I x‚ÇÅ tt))
equalInTypeShrink u I w T a‚ÇÅ a‚ÇÇ (EQTSHRINK A1 A2 x x‚ÇÅ eqt , eqi) =
  Œª w1 e1 ‚Üí
    let (w2' , e2' , eqi1) = eqi w1 e1 in
    (w2' , e2' , Œª w3 e3 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ ‚Üí
      let eqi2 = eqi1 w3 e3 i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ in
      let eqt2 = eqt w3 ([]‚âΩ-trans {I} e3 ([]‚âΩ-trans {I} e2' e1)) i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ in
      let eq1 = compAllSHRINK {I} x in
      let eq2 = compAllSHRINK {I} x‚ÇÅ in
      substEqTeq (uni u) _ _ w3 A1 T A2 T a‚ÇÅ a‚ÇÇ eqt2 eqi2 refl (sym eq1) (sym eq2))


-- Inhabitation properties
Inh-eta : (I : Inh) ‚Üí mkinh (Inh.m I) (Inh.n I) (Œª m i c ‚Üí Inh.f I m i (‚â§-trans c ‚â§-refl)) ‚â° I
Inh-eta (mkinh m n f) = eq-mkinh (fext (Œª m ‚Üí fext (Œª i ‚Üí fext (Œª c ‚Üí eqf m i c))))
  where
    eqf : (m : ‚Ñï) (i : ‚Ñï) (c : i ‚â§ n) ‚Üí f m i (‚â§-trans c ‚â§-refl) ‚â° f m i c
    eqf m i c rewrite ‚â§-trans-‚â§-refl c = refl


allI-equalInType : (u : ‚Ñï) (I : Inh) (wf : wfInh‚â§ I) (w : ùïé¬∑) (T a b : CTerm)
                   ‚Üí allI I (Œª i ‚Üí equalInType u i w T a b)
                   ‚Üí equalInType u I w T a b
allI-equalInType u I wf w T a b h =
  subst
    (Œª x ‚Üí equalInType u x w T a b)
    (Inh-eta I)
    (h (Inh.n I) wf ‚â§-refl (Inh.m I) ‚â§-refl wf)


s‚â§-‚â§pred : {i j : ‚Ñï} ‚Üí suc j ‚â§ i ‚Üí j ‚â§ pred i
s‚â§-‚â§pred {suc i} {j} (_‚â§_.s‚â§s h) = h


‚â§0-‚â°0 : {j : ‚Ñï} ‚Üí j ‚â§ 0 ‚Üí j ‚â° 0
‚â§0-‚â°0 {.0} _‚â§_.z‚â§n = refl


pred‚â§pred : {i j : ‚Ñï} ‚Üí j ‚â§ i ‚Üí pred j ‚â§ pred i
pred‚â§pred {i} {0} h = _‚â§_.z‚â§n
pred‚â§pred {suc i} {suc j} (_‚â§_.s‚â§s h) = h


between2 : {i j : ‚Ñï} (c‚ÇÅ : j ‚â§ i) (c‚ÇÇ : i ‚â§ suc j) ‚Üí i ‚â° j ‚äé i ‚â° (suc j)
between2 {.0} {j} c‚ÇÅ _‚â§_.z‚â§n = inj‚ÇÅ (sym (‚â§0-‚â°0 c‚ÇÅ))
between2 {suc k} {0} c‚ÇÅ (_‚â§_.s‚â§s c‚ÇÇ) rewrite (‚â§0-‚â°0 c‚ÇÇ) = inj‚ÇÇ refl
between2 {suc k} {suc j} c‚ÇÅ (_‚â§_.s‚â§s c‚ÇÇ) with between2 (sucLeInj c‚ÇÅ) c‚ÇÇ
... | inj‚ÇÅ p rewrite p = inj‚ÇÅ refl
... | inj‚ÇÇ p rewrite p = inj‚ÇÇ refl


between1 : {i j : ‚Ñï} (c‚ÇÅ : j ‚â§ i) (c‚ÇÇ : i ‚â§ j) ‚Üí i ‚â° j
between1 {0} {j} c‚ÇÅ _‚â§_.z‚â§n rewrite (‚â§0-‚â°0 c‚ÇÅ) = refl
between1 {suc k} {suc w} c‚ÇÅ (_‚â§_.s‚â§s c‚ÇÇ) rewrite between1 (sucLeInj c‚ÇÅ) c‚ÇÇ = refl


inhL-pred : (u i j m i0 : ‚Ñï) (c : i0 ‚â§ pred i) (c‚ÇÅ : suc j ‚â§ i) (c‚ÇÇ : i ‚â§ suc (suc j)) (w : ùïé¬∑) (T : CTerm)
            ‚Üí inhL u m (pred i) i0 c w T ‚â° Inh.f (inhN2L u j) m i0 (‚â§-trans c (pred‚â§pred c‚ÇÇ)) w T
inhL-pred u i j m i0 c c‚ÇÅ c‚ÇÇ w T with between2 c‚ÇÅ c‚ÇÇ | m‚â§n‚áím<n‚à®m‚â°n (‚â§-trans c (pred‚â§pred c‚ÇÇ))
... | inj‚ÇÅ p | inj‚ÇÅ q rewrite p | ‚â§-irrelevant (sucLeInj q) c = refl
... | inj‚ÇÅ p | inj‚ÇÇ q rewrite p | q = ‚ä•-elim (¬¨s‚â§ _ c)
... | inj‚ÇÇ p | inj‚ÇÅ q rewrite p with m‚â§n‚áím<n‚à®m‚â°n c
...                                | inj‚ÇÅ r rewrite ‚â§-irrelevant (sucLeInj r) (sucLeInj q) = refl
...                                | inj‚ÇÇ r rewrite r = ‚ä•-elim (¬¨s‚â§ _ q)
inhL-pred u i j m i0 c c‚ÇÅ c‚ÇÇ w T | inj‚ÇÇ p | inj‚ÇÇ q rewrite p | q with m‚â§n‚áím<n‚à®m‚â°n c
... | inj‚ÇÅ r = ‚ä•-elim (¬¨s‚â§ _ r)
... | inj‚ÇÇ r = refl


inhm-inhN2Ls : (u j : ‚Ñï) ‚Üí Inh.m (inhN2Ls u j) ‚â° suc j
inhm-inhN2Ls u j = refl


inh-f-inhN2Ls : (u j i : ‚Ñï) (c‚ÇÅ : suc j ‚â§ i) (c‚ÇÇ : i ‚â§ suc (suc j)) (w : ùïé¬∑) (T : CTerm)
                ‚Üí Œ£ Term (Œª t ‚Üí equalInType u (inhN u (suc j) (pred i)) w T t t)
                ‚Üí Inh.f (inhN2Ls u j) (Inh.m (inhN2Ls u j)) i c‚ÇÇ w T
inh-f-inhN2Ls u j i c‚ÇÅ c‚ÇÇ w T h with m‚â§n‚áím<n‚à®m‚â°n c‚ÇÇ
... | inj‚ÇÅ p with m‚â§n‚áím<n‚à®m‚â°n (sucLeInj p)
...          | inj‚ÇÅ q = ‚ä•-elim (¬¨s‚â§ _ (‚â§-trans q c‚ÇÅ))
...          | inj‚ÇÇ q rewrite q = h
inh-f-inhN2Ls u j i c‚ÇÅ c‚ÇÇ w T h | inj‚ÇÇ p rewrite p = h


inh-f-inhN2Ls-pred : (u j i : ‚Ñï) (c‚ÇÅ : suc j ‚â§ i) (c‚ÇÇ : i ‚â§ suc (suc j))
                     (k : ‚Ñï) (c‚ÇÉ : j ‚â§ k) (c‚ÇÑ : k ‚â§ pred i)
                     (w : ùïé¬∑) (T : CTerm)
                     ‚Üí Œ£ Term (Œª t ‚Üí equalInType u (inhN u k (pred i)) w T t t)
                     ‚Üí Inh.f (inhN2Ls u j) k i c‚ÇÇ w T
inh-f-inhN2Ls-pred u j i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ w T h with m‚â§n‚áím<n‚à®m‚â°n c‚ÇÇ
... | inj‚ÇÅ p with m‚â§n‚áím<n‚à®m‚â°n (sucLeInj p)
...          | inj‚ÇÅ q = ‚ä•-elim (¬¨s‚â§ _ (‚â§-trans q c‚ÇÅ))
...          | inj‚ÇÇ q rewrite q = h
inh-f-inhN2Ls-pred u j i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ w T h | inj‚ÇÇ p rewrite p = h


if-inh-f-inhN2Ls-pred : (u j i : ‚Ñï) (c‚ÇÅ : suc j ‚â§ i) (c‚ÇÇ : i ‚â§ suc (suc j)) (w : ùïé¬∑) (T : CTerm)
                        ‚Üí Inh.f (inhN2Ls u j) (pred (Inh.m (inhN2Ls u j))) i c‚ÇÇ w T
                        ‚Üí Œ£ Term (Œª t ‚Üí equalInType u (inhN u j (pred i)) w T t t)
if-inh-f-inhN2Ls-pred u j i c‚ÇÅ c‚ÇÇ w T h with m‚â§n‚áím<n‚à®m‚â°n c‚ÇÇ
... | inj‚ÇÅ p with m‚â§n‚áím<n‚à®m‚â°n (sucLeInj p)
...          | inj‚ÇÅ q = ‚ä•-elim (¬¨s‚â§ _ (‚â§-trans q c‚ÇÅ))
...          | inj‚ÇÇ q rewrite q = h
if-inh-f-inhN2Ls-pred u j i c‚ÇÅ c‚ÇÇ w T h | inj‚ÇÇ p rewrite p = h


allI-inhN2Ls-Œ£equalInType : (u j i : ‚Ñï) (w : ùïé¬∑) (t : CTerm) (c‚ÇÅ : j ‚â§ i) (c‚ÇÇ : i ‚â§ suc j)
                            ‚Üí allIW (inhN2Ls u j) (Œª i ‚Üí i w t)
                            ‚Üí Œ£ Term (Œª z ‚Üí equalInType u (inhN u j i) w t z z)
allI-inhN2Ls-Œ£equalInType u j i w t c‚ÇÅ c‚ÇÇ h =
  if-inh-f-inhN2Ls-pred
    u j (suc i) (_‚â§_.s‚â§s c‚ÇÅ) (_‚â§_.s‚â§s c‚ÇÇ) w t
    (h (suc i) (_‚â§_.s‚â§s c‚ÇÅ) (_‚â§_.s‚â§s c‚ÇÇ) j ‚â§-refl c‚ÇÅ)


if-inh-f-inhN2Ls-pred2 : (u j i : ‚Ñï) (c‚ÇÅ : suc j ‚â§ i) (c‚ÇÇ : i ‚â§ suc (suc j))
                         (k : ‚Ñï) (c‚ÇÉ : suc j ‚â§ k) (c‚ÇÑ : k ‚â§ i)
                         (w : ùïé¬∑) (T : CTerm)
                         ‚Üí Inh.f (inhN2Ls u j) k i c‚ÇÇ w T
                         ‚Üí Œ£ Term (Œª t ‚Üí equalInType u (inhN u k (pred i)) w T t t)
if-inh-f-inhN2Ls-pred2 u j i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ w T h with m‚â§n‚áím<n‚à®m‚â°n c‚ÇÇ
... | inj‚ÇÅ p with m‚â§n‚áím<n‚à®m‚â°n (sucLeInj p)
...          | inj‚ÇÅ q = ‚ä•-elim (¬¨s‚â§ _ (‚â§-trans q c‚ÇÅ))
...          | inj‚ÇÇ q rewrite q = h
if-inh-f-inhN2Ls-pred2 u j i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ w T h | inj‚ÇÇ p rewrite p = h


allI-inhN2Ls-Œ£equalInType2 : (u j i : ‚Ñï) (w : ùïé¬∑) (t : CTerm) (c‚ÇÅ : j ‚â§ i) (c‚ÇÇ : i ‚â§ suc j)
                             (k : ‚Ñï) (c‚ÇÉ : suc j ‚â§ k) (c‚ÇÑ : k ‚â§ i)
                            ‚Üí allIW (inhN2Ls u j) (Œª i ‚Üí i w t)
                            ‚Üí Œ£ Term (Œª z ‚Üí equalInType u (inhN u k i) w t z z)
allI-inhN2Ls-Œ£equalInType2 u j i w t c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ h =
  if-inh-f-inhN2Ls-pred2
    u j (suc i) (_‚â§_.s‚â§s c‚ÇÅ) (_‚â§_.s‚â§s c‚ÇÇ) k c‚ÇÉ (‚â§-trans c‚ÇÑ (n‚â§1+n _)) w t
    (h (suc i) (_‚â§_.s‚â§s c‚ÇÅ) (_‚â§_.s‚â§s c‚ÇÇ) k (‚â§-trans (n‚â§1+n _) c‚ÇÉ) c‚ÇÑ)


mkinh2L‚â°inhNaux : (u j i : ‚Ñï) (c‚ÇÅ : j ‚â§ i) (c‚ÇÇ : i ‚â§ suc j) (m z : ‚Ñï) (c : z ‚â§ i) (w : ùïé¬∑) (t : CTerm)
                ‚Üí Inh.f (inhN2L u j) m z (‚â§-trans c c‚ÇÇ) w t ‚â° inhL u m i z c w t
mkinh2L‚â°inhNaux u j i c‚ÇÅ c‚ÇÇ m z c w t with between2 c‚ÇÅ c‚ÇÇ | m‚â§n‚áím<n‚à®m‚â°n (‚â§-trans c c‚ÇÇ)
... | inj‚ÇÅ p | inj‚ÇÅ q rewrite p | ‚â§-irrelevant (sucLeInj q) c = refl
... | inj‚ÇÅ p | inj‚ÇÇ q rewrite p | q = ‚ä•-elim (¬¨s‚â§ _ c)
... | inj‚ÇÇ p | inj‚ÇÅ q rewrite p with m‚â§n‚áím<n‚à®m‚â°n c
...                                | inj‚ÇÅ r rewrite ‚â§-irrelevant (sucLeInj r) (sucLeInj q) = refl
...                                | inj‚ÇÇ r rewrite r = ‚ä•-elim (¬¨s‚â§ _ q)
mkinh2L‚â°inhNaux u j i c‚ÇÅ c‚ÇÇ m z c w t | inj‚ÇÇ p | inj‚ÇÇ q rewrite p | q with m‚â§n‚áím<n‚à®m‚â°n c
... | inj‚ÇÅ r = ‚ä•-elim (¬¨s‚â§ _ r)
... | inj‚ÇÇ r = refl


mkinh2L‚â°inhN : (u j i : ‚Ñï) (c‚ÇÅ : j ‚â§ i) (c‚ÇÇ : i ‚â§ suc j)
               ‚Üí mkinh (Inh.m (inhN2L u j)) i (Œª m i c ‚Üí Inh.f (inhN2L u j) m i (‚â§-trans c c‚ÇÇ)) ‚â° inhN u j i
mkinh2L‚â°inhN u j i c‚ÇÅ c‚ÇÇ = eq-mkinh (fext (Œª m ‚Üí fext (Œª z ‚Üí fext (Œª c ‚Üí fext (Œª w ‚Üí fext (Œª t ‚Üí h m z c w t))))))
  where
    h : (m z : ‚Ñï) (c : z ‚â§ i) (w : ùïé¬∑) (t : CTerm)
        ‚Üí Inh.f (inhN2L u j) m z (‚â§-trans c c‚ÇÇ) w t ‚â° inhL u m i z c w t
    h m z c w t = mkinh2L‚â°inhNaux u j i c‚ÇÅ c‚ÇÇ m z c w t


mkinh1Ls‚â°inhNaux : (u j i : ‚Ñï) (c‚ÇÅ : suc j ‚â§ i) (c‚ÇÇ : i ‚â§ suc j) (m z : ‚Ñï) (c : z ‚â§ i) (w : ùïé¬∑) (t : CTerm)
                 ‚Üí Inh.f (inhN1Ls u j) m z (‚â§-trans c c‚ÇÇ) w t ‚â° inhL u m i z c w t
mkinh1Ls‚â°inhNaux u j i c‚ÇÅ c‚ÇÇ m z c w t with between1 c‚ÇÅ c‚ÇÇ
... | p rewrite p with m‚â§n‚áím<n‚à®m‚â°n (‚â§-trans c c‚ÇÇ) | m‚â§n‚áím<n‚à®m‚â°n c
...               | inj‚ÇÅ x | inj‚ÇÅ y rewrite ‚â§-irrelevant (sucLeInj x) (sucLeInj y) = refl
...               | inj‚ÇÅ x | inj‚ÇÇ y rewrite y = ‚ä•-elim (¬¨s‚â§ _ x)
...               | inj‚ÇÇ x | inj‚ÇÅ y rewrite x = ‚ä•-elim (¬¨s‚â§ _ y)
...               | inj‚ÇÇ x | inj‚ÇÇ y rewrite x | y = refl


mkinh1Ls‚â°inhN : (u j i : ‚Ñï) (c‚ÇÅ : suc j ‚â§ i) (c‚ÇÇ : i ‚â§ suc j) (k : ‚Ñï) (c‚ÇÉ : suc j ‚â§ k) (c‚ÇÑ : k ‚â§ i)
              ‚Üí mkinh k i (Œª m i c ‚Üí Inh.f (inhN1Ls u j) m i (‚â§-trans c c‚ÇÇ)) ‚â° inhN u k i
mkinh1Ls‚â°inhN u j i c‚ÇÅ c‚ÇÇ k c‚ÇÉ c‚ÇÑ = eq-mkinh (fext (Œª m ‚Üí fext (Œª z ‚Üí fext (Œª c ‚Üí fext (Œª w ‚Üí fext (Œª t ‚Üí h m z c w t))))))
  where
    h : (m z : ‚Ñï) (c : z ‚â§ i) (w : ùïé¬∑) (t : CTerm)
        ‚Üí Inh.f (inhN1Ls u j) m z (‚â§-trans c c‚ÇÇ) w t ‚â° inhL u m i z c w t
    h m z c w t = mkinh1Ls‚â°inhNaux u j i c‚ÇÅ c‚ÇÇ m z c w t


{--
if-inh-f-inhN2Ls : (u j : ‚Ñï) (w : ùïé¬∑) (T : CTerm)
                   ‚Üí Inh.f (inhN2Ls u j) (pred (Inh.m (inhN2Ls u j))) (suc (suc j)) ‚â§-refl w T
                   ‚Üí Œ£ Term (Œª t ‚Üí equalInType u (inhN u (suc j) (suc j)) w T t t)
if-inh-f-inhN2Ls u j w T h with m‚â§n‚áím<n‚à®m‚â°n (‚â§-refl {suc (suc j)})
... | inj‚ÇÅ p = ‚ä•-elim (¬¨s‚â§ _ p)
... | inj‚ÇÇ p = {!h!}

{-- with m‚â§n‚áím<n‚à®m‚â°n (sucLeInj p)
...          | inj‚ÇÅ q = ‚ä•-elim (¬¨s‚â§ _ q)
...          | inj‚ÇÇ q = {!h!}
if-inh-f-inhN2Ls u j w T h | inj‚ÇÇ p = {!!} --}

{-- with m‚â§n‚áím<n‚à®m‚â°n c‚ÇÇ
... | inj‚ÇÅ p with m‚â§n‚áím<n‚à®m‚â°n (sucLeInj p)
...          | inj‚ÇÅ q = ‚ä•-elim (¬¨s‚â§ _ (‚â§-trans q c‚ÇÅ))
...          | inj‚ÇÇ q rewrite q = h
if-inh-f-inhN2Ls u j i c‚ÇÅ c‚ÇÇ w T h | inj‚ÇÇ p rewrite p = h --}


allI-inhN2Ls-Œ£equalInType1Ls : (u j i : ‚Ñï) (w : ùïé¬∑) (t : CTerm) (c‚ÇÅ : suc j ‚â§ i) (c‚ÇÇ : i ‚â§ suc j)
                               ‚Üí allIW (inhN2Ls u j) (Œª i ‚Üí i w t)
                               ‚Üí Œ£ Term (Œª z ‚Üí equalInType u (inhN u (suc j) i) w t z z)
allI-inhN2Ls-Œ£equalInType1Ls u j i w t c‚ÇÅ c‚ÇÇ h = se2
  where
    se0 : Inh.f (inhN2Ls u j) (pred (Inh.m (inhN2Ls u j))) (suc (suc j)) ‚â§-refl w t
    se0 = h (suc (suc j)) (n‚â§1+n _) ‚â§-refl

    se1 : Œ£ Term (Œª z ‚Üí equalInType u (inhN u (suc j) (suc j)) w t z z)
    se1 = {!!}

    se2 : Œ£ Term (Œª z ‚Üí equalInType u (inhN u (suc j) i) w t z z)
    se2 rewrite between1 c‚ÇÅ c‚ÇÇ = se1
--}


--with between1 c‚ÇÅ c‚ÇÇ
--... | p rewrite p = {!!}
{--  if-inh-f-inhN2Ls-pred
    u j (suc i) (_‚â§_.s‚â§s c‚ÇÅ) (_‚â§_.s‚â§s c‚ÇÇ) w t
    (h (suc i) (_‚â§_.s‚â§s c‚ÇÅ) (_‚â§_.s‚â§s c‚ÇÇ)) --}


inhN‚â°inhN1Ls : {u j i k : ‚Ñï} ‚Üí suc j ‚â§ i ‚Üí i ‚â§ suc j ‚Üí suc j ‚â§ k ‚Üí k ‚â§ i
               ‚Üí inhN u k i ‚â° inhN1Ls u j
inhN‚â°inhN1Ls {u} {j} {i} {k} a b c d rewrite between1 a b | between1 c d = refl


allI-inhN2Ls-allI-inh1Ls : {u j : ‚Ñï} {f : InhW ‚Üí Set}
                           ‚Üí allIW (inhN2Ls u j) f
                           ‚Üí allIW (inhN1Ls u j) f
allI-inhN2Ls-allI-inh1Ls {u} {j} {f} h i ci‚ÇÅ ci‚ÇÇ k ck‚ÇÅ ck‚ÇÇ =
  let z = h i ci‚ÇÅ (‚â§-trans ci‚ÇÇ (n‚â§1+n _)) k ck‚ÇÅ ck‚ÇÇ in
  subst f (sym e1) z
  where
    e2 : (w : ùïé¬∑) (T : CTerm) ‚Üí Inh.f (inhN1Ls u j) k i ci‚ÇÇ w T ‚â° Inh.f (inhN2Ls u j) k i (‚â§-trans ci‚ÇÇ (n‚â§1+n (Inh.n (inhN1Ls u j)))) w T
    e2 w T with between1 ci‚ÇÅ ci‚ÇÇ
    ... | p rewrite p with m‚â§n‚áím<n‚à®m‚â°n ci‚ÇÇ
    ...               | inj‚ÇÅ q = ‚ä•-elim (¬¨s‚â§ _ q)
    ...               | inj‚ÇÇ q with m‚â§n‚áím<n‚à®m‚â°n (‚â§-trans ci‚ÇÇ (_‚â§_.s‚â§s (‚â§-step (‚â§-reflexive refl))))
    ...                        | inj‚ÇÇ r = ‚ä•-elim (¬¨‚â°s _ r)
    ...                        | inj‚ÇÅ r with m‚â§n‚áím<n‚à®m‚â°n (sucLeInj r)
    ...                                 | inj‚ÇÅ s = ‚ä•-elim (¬¨s‚â§ _ s)
    ...                                 | inj‚ÇÇ s = refl

    e1 : Inh.f (inhN1Ls u j) k i ci‚ÇÇ ‚â° Inh.f (inhN2Ls u j) k i (‚â§-trans ci‚ÇÇ (n‚â§1+n (Inh.n (inhN1Ls u j))))
    e1 = fext (Œª w ‚Üí fext (Œª T ‚Üí e2 w T))


[]‚âΩ-inhN2Ls-[]‚âΩ-inhN1Ls : {w2 w1 : ùïé¬∑} {u j : ‚Ñï}
                     ‚Üí [ inhN2Ls u j ] w2 ‚™∞ w1
                     ‚Üí [ inhN1Ls u j ] w2 ‚™∞ w1
[]‚âΩ-inhN2Ls-[]‚âΩ-inhN1Ls {w2} {.w2} {u} {j} (‚äë-refl¬∑ .w2) = ‚äë-refl¬∑ w2
[]‚âΩ-inhN2Ls-[]‚âΩ-inhN1Ls {w2} {w1} {u} {j} (extTrans h h‚ÇÅ) = extTrans ([]‚âΩ-inhN2Ls-[]‚âΩ-inhN1Ls h) ([]‚âΩ-inhN2Ls-[]‚âΩ-inhN1Ls h‚ÇÅ)
[]‚âΩ-inhN2Ls-[]‚âΩ-inhN1Ls {.(w1 ++ choice name t ‚à∑ [])} {w1} {u} {j} (extChoice .w1 name l t res x x‚ÇÅ) =
  extChoice w1 name l t res x (allI-inhN2Ls-allI-inh1Ls {u} {j} {Œª i ‚Üí i w1 (res (length l) t)} x‚ÇÅ)
[]‚âΩ-inhN2Ls-[]‚âΩ-inhN1Ls {.(w1 ++ start name res ‚à∑ [])} {w1} {u} {j} (extEntry .w1 name res x) =
  extEntry w1 name res x


[]‚âΩ-inhN2Ls-to-N1s : {w2 w1 : ùïé¬∑} {u j i k : ‚Ñï} ‚Üí suc j ‚â§ i ‚Üí i ‚â§ suc j ‚Üí suc j ‚â§ k ‚Üí k ‚â§ i
                     ‚Üí [ inhN2Ls u j ] w2 ‚™∞ w1
                     ‚Üí [ inhN u k i ] w2 ‚™∞ w1
[]‚âΩ-inhN2Ls-to-N1s {w2} {w1} {u} {j} {i} {k} a b c d h rewrite inhN‚â°inhN1Ls {u} {j} {i} {k} a b c d =
  []‚âΩ-inhN2Ls-[]‚âΩ-inhN1Ls h


{--then-lower : (w : ùïé¬∑) (a b : CTerm) ‚Üí eqintype w NAT a b ‚Üí eqintype w (LOWER NAT) a b
then-lower w a b (u , n , k , e) =
  (u , suc n , k , Œª j c ‚Üí
   impliesEqualInTypeLower u (inhN u j (k + j)) w NAT a b Œª w1 e1 ‚Üí {!!})

if-lower : (w : ùïé¬∑) (a b : CTerm) ‚Üí eqintype w (LOWER NAT) a b ‚Üí eqintype w NAT a b
if-lower w a b (u , n , k , e) = (u , n , k , Œª j c ‚Üí {!!})--}
--}
\end{code}
